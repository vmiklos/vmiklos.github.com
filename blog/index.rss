<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0">
    <channel>
        <title>What is Miklos hacking</title>
        <description></description>
        <link>http://vmiklos.hu/blog/</link>
        <item>
            <title>Fixing Calc header image backgrounds</title>
            <description>&lt;div class="imageblock" style="text-align:center;"&gt;
&lt;div class="content"&gt;
&lt;a class="image" href="https://lh3.googleusercontent.com/-u9SiImjl99k/VecKvEnT6lI/AAAAAAAAGDs/sNUH3OIlk4Y/s0-Ic42/"&gt;
&lt;img src="https://lh3.googleusercontent.com/-u9SiImjl99k/VecKvEnT6lI/AAAAAAAAGDs/sNUH3OIlk4Y/s640-Ic42/" alt="https://lh3.googleusercontent.com/-u9SiImjl99k/VecKvEnT6lI/AAAAAAAAGDs/sNUH3OIlk4Y/s640-Ic42/" /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;I think this is my first Calc bugfix. :-) The problem I wanted to fix is that
while LibreOffice 4.4 learned advanced
&lt;a href="https://gerrit.libreoffice.org/gitweb?p=core.git&amp;amp;a=search&amp;amp;h=HEAD&amp;amp;st=commit&amp;amp;s=fillattributes"&gt;fill
attributes&lt;/a&gt; (gradients, hatches, etc) for page headers / footers in Writer,
this broke the saving of simple graphic header backgrounds in Calc. Seeing
that no-one stepped up to fix this, I tried to do this myself&amp;#8201;&amp;#8212;&amp;#8201;and luckily
the problem was in the ODF export filter, which is much more familiar to me,
compared to Calc core.&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;Part of that larger feature was changes to the ODF filter, and
&lt;a href="https://bugs.documentfoundation.org/show_bug.cgi?id=89245"&gt;the bug&lt;/a&gt; was exactly
about touching shared ODF filter code to please Writer without testing other
LibreOffice applications.&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;The actual problem was
&lt;a href="http://cgit.freedesktop.org/libreoffice/core/commit/?id=3b40329f9a64b93b1e1230b1bff74ed8cda8cd70"&gt;overlapping
constants&lt;/a&gt;: as in multiple constants had the same numeric value. Such issues
are sometimes hard to track down, in this case it wasn&amp;#8217;t &lt;em&gt;that&lt;/em&gt; hard: the
context filter that tried to make sure we don&amp;#8217;t write duplicated XML
attributes removed the background property when it tried to guard header
repeat offsets.&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;Given that this affected the LibreOffice 4.4 and 5.0 series, both branches got
a backport of the commit, and so the next release from those lines will have
the fix.&lt;/p&gt;&lt;/div&gt;
</description>
            <link>http://vmiklos.hu/blog/calc-header.html</link>
            <pubDate>Wed, 02 Sep 2015 18:08:21 +0200</pubDate>
            <guid isPermaLink="false">http://vmiklos.hu/blog/calc-header.html</guid>
        </item>
        <item>
            <title>8884 VirtualDevices</title>
            <description>&lt;div style="text-align: center; font-size: 0.6em;"&gt;
&lt;img src="https://lh3.googleusercontent.com/-RAsPMFc8JVk/VdH9h_W4r_I/AAAAAAAAF6U/PDpQIbBtPKg/s475-Ic42/"/&gt;
&lt;p&gt;(via &lt;a href="http://www.teq.com/smart-pointers"&gt;teq&lt;/a&gt;)&lt;/p&gt;
&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;If you are into C++ programming, you probably know that smart pointers are
not just literally strange things like the above ones. ;-) LibreOffice 5.0 got
&lt;a href="https://gerrit.libreoffice.org/gitweb?p=core.git;a=blob;f=vcl/README.lifecycle;h=6b5cbd6e8df4bcc77b28b0e296e50a96ca8899a0;hb=HEAD"&gt;VclPtr&lt;/a&gt;,
which is smart pointer specialized to VCL&amp;#8217;s needs.&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;Such refactorings are good things, except that there is no huge rework without
regressions. In &lt;a href="https://bugs.documentfoundation.org/show_bug.cgi?id=93284"&gt;this
case&lt;/a&gt; the WMF filter had 3 places where we were leaking VirtualDevices due to
a misconversion to the new VclPtr API. The problem was that the document had
135 images, WMF files to be exact. Now given that the leaks were during
parsing of WMF records (a WMF file consists of multiple WMF records), at the
end we leaked 8884 VirtualDevices. At first the problem was seen as
Windows-specific, as at least X on Linux has no problem with creating that
many VirtualDevices, but Windows' default resource limits are hit in this
case.&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;A note about testing this bugfix effectively, so it never happens again. The
problem was that I wanted to create a minimal reproducer, but I also needed a
document with lots of WMF images, each complex enough to trigger the resource
limit. At the end I manually created a DOCX file that had the same image
copy&amp;amp;pasted multiple times: that way we really imported them multiple times
(normally we notice that they&amp;#8217;re the same, and only save the image to the file
once, and put multiple references to it), and because DOCX is also a ZIP
container, the test file can be still only 99KB instead of the original 17MB
RTF.&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;Thanks to the
&lt;a href="https://wiki.documentfoundation.org/QA/Bibisect/Windows#Versions"&gt;4.4 &amp;#8594; 5.0
Windows bibisect repo&lt;/a&gt;, it was immediately obvious that this is a VclPtr
problem, and then it was possible to identify the root cause, and finally see
that the bug title mentioning RTF was just container of the WMF images in this
case, the problem had nothing to with with RTF and the leak wasn&amp;#8217;t
Windows-specific, either.&lt;/p&gt;&lt;/div&gt;
</description>
            <link>http://vmiklos.hu/blog/virtualdevice-leak.html</link>
            <pubDate>Tue, 18 Aug 2015 09:09:44 +0200</pubDate>
            <guid isPermaLink="false">http://vmiklos.hu/blog/virtualdevice-leak.html</guid>
        </item>
        <item>
            <title>Mail merge embedding</title>
            <description>&lt;div class="paragraph"&gt;&lt;p&gt;If you ever used the
&lt;a href="https://help.libreoffice.org/Writer/Mail_Merge_Wizard"&gt;mail merge wizard&lt;/a&gt; with
a Calc data source, then you know how it worked in the past: you&amp;#8217;ve got 3
files: the .odt mail template, the .ods data source and a .odb data source
definition that defines how to access the .ods.&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;The target of this &lt;a href="http://www.muenchen.de/"&gt;LHM-funded project&lt;/a&gt; was to get rid
of the .odb file and just embed it into the .odt mail template. Why?&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;Here is the problem description from a user&amp;#8217;s point of view: "When a mail
merge document is being saved a separate database file is being automatically
created. It links the Writer file to the spreadsheet (ODS, XLS, XLSX etc.) as
data source. This additional 2kB ODB file confuses users, they might delete it
without knowing to break the connection to the data source." An additional
problem is that because the non-embedded data source definition is part of the
user profile, you can&amp;#8217;t just move the three files to an other machine, as .odb
registration will be missing there.&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;If you are interested how this looks like, here is a demo (click on the image
to see the video):&lt;/p&gt;&lt;/div&gt;
&lt;div class="imageblock" style="text-align:center;"&gt;
&lt;div class="content"&gt;
&lt;a class="image" href="https://youtu.be/5iQFZBOz8rM"&gt;
&lt;img src="https://lh3.googleusercontent.com/-XDcWgOWKr2k/Vbc4blHURTI/AAAAAAAAF4E/VXFBglt-YmU/s800-Ic42/" alt="https://lh3.googleusercontent.com/-XDcWgOWKr2k/Vbc4blHURTI/AAAAAAAAF4E/VXFBglt-YmU/s800-Ic42/" /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;That&amp;#8217;s it for now&amp;#8201;&amp;#8212;&amp;#8201;as usual the commits are in master, so you can try this
right now with a 5.1 &lt;a href="http://dev-builds.libreoffice.org/daily/master/"&gt;daily
build&lt;/a&gt;. :-)&lt;/p&gt;&lt;/div&gt;
</description>
            <link>http://vmiklos.hu/blog/mail-merge-embedding.html</link>
            <pubDate>Tue, 28 Jul 2015 09:34:09 +0200</pubDate>
            <guid isPermaLink="false">http://vmiklos.hu/blog/mail-merge-embedding.html</guid>
        </item>
        <item>
            <title>ctags vs override/SAL_OVERRIDE</title>
            <description>&lt;div class="imageblock" style="text-align:center;"&gt;
&lt;div class="content"&gt;
&lt;img src="https://lh3.googleusercontent.com/-9Hd40EVT8aw/VZBhBTZQdTI/AAAAAAAAFyM/AfymfTqKDFw/s0/" alt="https://lh3.googleusercontent.com/-9Hd40EVT8aw/VZBhBTZQdTI/AAAAAAAAFyM/AfymfTqKDFw/s0/" /&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;If you use &lt;a href="http://ctags.sourceforge.net/"&gt;ctags&lt;/a&gt; to help your LibreOffice
development, there are already good descriptions for that&amp;#8201;&amp;#8212;&amp;#8201;e.g. for vim
there is one &lt;a href="https://wiki.documentfoundation.org/Development/Vim#ctags"&gt;on the
TDF wiki&lt;/a&gt;.&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;What was problematic is that since C++11, &lt;code&gt;override&lt;/code&gt; is a valid keyword
after a member function declaration, and we have our &lt;code&gt;SAL_OVERRIDE&lt;/code&gt; macro that
I
&lt;a href="http://cgit.freedesktop.org/libreoffice/core/commit/?id=3891d323cdc3c03154f5682baaeaa4b2ef015a63"&gt;added&lt;/a&gt;
to be able to use it before all our supported compilers recognize it.
Unsupported parsers include ctags, so if a member function have SAL_OVERRIDE,
ctags only indexed the definition, not the declaration.&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;I created patches to fix these problems in ctags, the
&lt;a href="https://sourceforge.net/p/ctags/bugs/367/"&gt;override one&lt;/a&gt; is probably
interesting for all C++ projects, the
&lt;a href="https://github.com/vmiklos/ctags-svn/commit/ef53a231db5b428585324f266072b884e17bae52"&gt;SAL_OVERRIDE
one&lt;/a&gt; is LibreOffice-specific.&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;The hope is that the later will go away in the long run, so it won&amp;#8217;t really be
a problem that ctags do not recognize that macro out of the box. :-)&lt;/p&gt;&lt;/div&gt;
</description>
            <link>http://vmiklos.hu/blog/ctags-sal-override.html</link>
            <pubDate>Mon, 29 Jun 2015 09:29:56 +0200</pubDate>
            <guid isPermaLink="false">http://vmiklos.hu/blog/ctags-sal-override.html</guid>
        </item>
        <item>
            <title>Cleanup of resourcemodel in LibreOffice</title>
            <description>&lt;div style="text-align: center; font-size: 0.6em;"&gt;
&lt;img src="https://lh3.googleusercontent.com/-YxMHx754A4A/VXQbB0-TMBI/AAAAAAAAFos/Nx6SlKp1JF4/s400/"/&gt;
&lt;p&gt;(via &lt;a href="https://www.flickr.com/photos/jbparrott/9381120992/"&gt;jbparrott&lt;/a&gt;)&lt;/p&gt;
&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;The &lt;code&gt;libreoffice-5-0&lt;/code&gt; branch is created, and in each release cycle there is at
least one topic that was a long overdue cleanup. In this post, I&amp;#8217;m describing
how and why the &lt;code&gt;writerfilter/inc/resourcemodel/&lt;/code&gt; and
&lt;code&gt;writerfilter/source/resourcemodel/&lt;/code&gt; directories disappeared&amp;#8201;&amp;#8212;&amp;#8201;though
probably nobody will miss them. :-)&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;The resourcemodel building block of writerfilter (that handles Writer&amp;#8217;s DOCX
and RTF import in LibreOffice) was basically a bucket of old and unused
&lt;a href="https://www.youtube.com/watch?v=MvgN5gCuLac"&gt;stuff&lt;/a&gt;.  After the removal of the
unused &lt;a href="http://vmiklos.hu/blog/doctok.html"&gt;.DOC tokenizer&lt;/a&gt;, it turned out that
most of that code was just referring to itself or template code that was used
with a single type only (hello
&lt;a href="http://cgit.freedesktop.org/libreoffice/core/commit/?id=45234fd21ad76b7732be4e5783cc7dd5dcf2daa2"&gt;TableManager&lt;/a&gt;).
resourcemodel was about 6000 lines of code at the time LibreOffice was
started, and after some manual cleanup and moving the still needed small part
to dmapper (the shared part of the RTF / DOCX import), tools like
&lt;a href="http://cgit.freedesktop.org/libreoffice/core/tree/compilerplugins/clang/unreffun.cxx"&gt;loplugin:unreffun&lt;/a&gt;
and &lt;a href="https://github.com/caolanm/callcatcher"&gt;callcatcher&lt;/a&gt; helped to detect what
became truly unused&amp;#8201;&amp;#8212;&amp;#8201;at the end resulting in the complete removal of these
directories.&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;That means that after folding the
&lt;a href="http://cgit.freedesktop.org/libreoffice/core/commit/?id=fcec34ffcc93f98be005b06c223e25c9c4e77cde"&gt;last
remaining header into dmapper&lt;/a&gt;, the relevant
&lt;a href="http://cgit.freedesktop.org/libreoffice/core/tree/writerfilter/README"&gt;documentation&lt;/a&gt;
can hopefully now describe source contents easier, having just 4 directories:
the RTF and the DOCX tokenizer, the shared part and the UNO service
implementations. One less cryptic leftover nobody really knows what it is! ;-)&lt;/p&gt;&lt;/div&gt;
</description>
            <link>http://vmiklos.hu/blog/resourcemodel.html</link>
            <pubDate>Mon, 08 Jun 2015 07:47:09 +0200</pubDate>
            <guid isPermaLink="false">http://vmiklos.hu/blog/resourcemodel.html</guid>
        </item>
        <item>
            <title>LibreOffice Cambridge Hackfest</title>
            <description>&lt;div class="imageblock" style="text-align:center;"&gt;
&lt;div class="content"&gt;
&lt;img src="https://lh3.googleusercontent.com/-dGY38VD7z0M/VWNqvkXDLwI/AAAAAAAAFlE/8yurKsu0NcA/s400/" alt="https://lh3.googleusercontent.com/-dGY38VD7z0M/VWNqvkXDLwI/AAAAAAAAFlE/8yurKsu0NcA/s400/" /&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;The first ever UK LibreOffice Hackfest took place in the city of Cambridge on
May 21st to 23rd (Thursday &amp;#8594; Saturday), kindly hosted by
&lt;a href="https://libreoffice-from-collabora.com/"&gt;Collabora&lt;/a&gt;.&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;My starter idea was to fix
&lt;a href="https://bugs.documentfoundation.org/show_bug.cgi?id=90315"&gt;tdf#90315&lt;/a&gt;, i.e. to
support both nested tables and multiple columns with the proper spacing in
between them in the RTF import. For comparison, here is how this looked in
LibreOffice 3.4:&lt;/p&gt;&lt;/div&gt;
&lt;div class="imageblock" style="text-align:center;"&gt;
&lt;div class="content"&gt;
&lt;img src="https://lh3.googleusercontent.com/-KX9Z8y1ojYc/VWNzgg1gQeI/AAAAAAAAFlk/TRwfvnklEOI/s400/" alt="https://lh3.googleusercontent.com/-KX9Z8y1ojYc/VWNzgg1gQeI/AAAAAAAAFlk/TRwfvnklEOI/s400/" /&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;The table borders looked OK due to correct column spacing, but the nested
table is missing. Then here is the LibreOffice 4.4 state:&lt;/p&gt;&lt;/div&gt;
&lt;div class="imageblock" style="text-align:center;"&gt;
&lt;div class="content"&gt;
&lt;img src="https://lh3.googleusercontent.com/-wz4OZdsYf5I/VWNzgu5OhUI/AAAAAAAAFlg/CG37pRlGggY/s400/" alt="https://lh3.googleusercontent.com/-wz4OZdsYf5I/VWNzgu5OhUI/AAAAAAAAFlg/CG37pRlGggY/s400/" /&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;Nested table is OK, but the table borders are strange due to incorrect column
spacing. Finally here is how it looks like now, when the import result is
correct:&lt;/p&gt;&lt;/div&gt;
&lt;div class="imageblock" style="text-align:center;"&gt;
&lt;div class="content"&gt;
&lt;img src="https://lh3.googleusercontent.com/-Zul_8xTSOkA/VWNzguGZf-I/AAAAAAAAFlY/L88WkfCpL1E/s400/" alt="https://lh3.googleusercontent.com/-Zul_8xTSOkA/VWNzguGZf-I/AAAAAAAAFlY/L88WkfCpL1E/s400/" /&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;Other than this, here is a list of other topics I hacked on:&lt;/p&gt;&lt;/div&gt;
&lt;div class="ulist"&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;
&lt;a href="https://gerrit.libreoffice.org/gitweb?p=dev-tools.git;a=commit;h=9107601036fc9af9e67b37f0fc26296dddfd6eb1"&gt;clang
  libtooling-based compiler tools&lt;/a&gt; (so far an example analizer and a rewriter)
&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;
some
  &lt;a href="https://gerrit.libreoffice.org/gitweb?p=core.git;a=tree;f=libreofficekit;hb=HEAD"&gt;gtktiledviewer&lt;/a&gt;
  tweaks like handling of the "Search key not found" or the "Page count changed"
  callback event
&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;
&lt;a href="https://gerrit.libreoffice.org/gitweb?p=core.git;a=commitdiff;h=821b72886f1e407a492f881a2efb27ead2c22b5c"&gt;o3tl::make_unique&lt;/a&gt;,
  till we can&amp;#8217;t use C++ 14 std::make_unique
&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;After fixing two more less interesting regressions, now it seems we&amp;#8217;re down to
0 for the
&lt;a href="https://bugs.documentfoundation.org/buglist.cgi?keywords=regression&amp;amp;keywords_type=allwords&amp;amp;product=LibreOffice&amp;amp;query_format=advanced&amp;amp;resolution=---&amp;amp;short_desc=RTF&amp;amp;short_desc_type=allwordssubstr"&gt;regressions
having RTF in their summary&lt;/a&gt;, which is promising. :-)&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;I few
&lt;a href="https://picasaweb.google.com/104737754628780823336/20150523_Cambridge"&gt;pictures&lt;/a&gt;
I took while punting and a
&lt;a href="http://vmiklos.hu/panoramas/cambridge.html"&gt;panorama&lt;/a&gt; is available, too.&lt;/p&gt;&lt;/div&gt;
</description>
            <link>http://vmiklos.hu/blog/cambridge.html</link>
            <pubDate>Tue, 26 May 2015 09:07:03 +0200</pubDate>
            <guid isPermaLink="false">http://vmiklos.hu/blog/cambridge.html</guid>
        </item>
        <item>
            <title>Protocols Plugfest Europe 2015</title>
            <description>&lt;div style="text-align: center; font-size: 0.6em;"&gt;
&lt;img src="https://lh3.googleusercontent.com/-Z9Pml365x6s/VVdBsMKPYVI/AAAAAAAAFfk/9PXnepbXuak/s400/"/&gt;
&lt;p&gt;(via &lt;a href="https://twitter.com/plugfestcon/status/598062244711309312"&gt;plugfestcon&lt;/a&gt;)&lt;/p&gt;
&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;Last week I went to Zaragoza to give a talk on
&lt;a href="https://speakerdeck.com/vmiklos/libreoffice-how-we-handle-interoperability"&gt;how
LibreOffice handles interoperability&lt;/a&gt; at Protocols Plugfest Europe 2015 on
&lt;a href="http://www.protocolsplugfest.com/europe/program/"&gt;Tuesday&lt;/a&gt;. Although I was told
this conference is a successor of the previous Zentyal Summit (and I were not
there) the conference seemed well-attended&amp;#8201;&amp;#8212;&amp;#8201;proof above. :-)&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;Jacobo also
&lt;a href="http://blogs.igalia.com/jaragunde/2015/05/11/speaking-at-protocols-plugfest-2015/"&gt;gave
a LibreOffice-related talk&lt;/a&gt; on Wednesday.&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;On the same day, there were some explicit spare time, so I took the
opportunity to walk in the historical parts of the city, see
&lt;a href="https://picasaweb.google.com/104737754628780823336/20150514_Zaragoza"&gt;my
photos&lt;/a&gt; and a &lt;a href="http://vmiklos.hu/panoramas/zaragoza.html"&gt;panorama&lt;/a&gt; if that kind
of pictures are of your interest. FWIW, &lt;a href="http://www.hotelsauce.com/en/"&gt;Hotel
Sauce&lt;/a&gt; has free wifi in the rooms, that&amp;#8217;s kind of impressing for a two-star
category. ;-)&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;As usual, thanks &lt;a href="https://libreoffice-from-collabora.com/"&gt;Collabora&lt;/a&gt; for sponsoring this travel!&lt;/p&gt;&lt;/div&gt;
</description>
            <link>http://vmiklos.hu/blog/plugfest2015.html</link>
            <pubDate>Mon, 18 May 2015 07:54:24 +0200</pubDate>
            <guid isPermaLink="false">http://vmiklos.hu/blog/plugfest2015.html</guid>
        </item>
        <item>
            <title>MathType import in the RTF and DOCX filter</title>
            <description>&lt;div class="paragraph"&gt;&lt;p&gt;TL;DR: Import of old-style (pre-2010 for RTF, pre-2007 for DOCX) math
equations embedded into text documents should be now imported as editable
embedded math objects.&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;Longer version: if you want to embed math equations into RTF or DOCX files,
you have two choices. The older approach is to embed a MathType OLE object
into the file, the newer one is a native OOXML markup, which has an RTF markup
equivalent as well. Handling of the later has been implemented by
&lt;a href="http://llunak.blogspot.com/"&gt;Luboš Luňák&lt;/a&gt; for DOCX a long time ago, and I
contributed the RTF equivalent almost
&lt;a href="http://vmiklos.hu/blog/lo-rtf-math-native.html"&gt;3 years ago&lt;/a&gt;.&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;What remains is the handling of the older version, the embedded OLE object.
Previously only the replacement graphic was imported, so regardless of the
Tools &amp;#8594; Options &amp;#8594; Load / Save &amp;#8594; Microsoft Office &amp;#8594; MathType to Math
checkbox, the result was never editable.&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;Here is how it looks like now:&lt;/p&gt;&lt;/div&gt;
&lt;div class="imageblock" style="text-align:center;"&gt;
&lt;div class="content"&gt;
&lt;img src="https://lh3.googleusercontent.com/-V3SqO3Rz88s/VUZvFcBNMPI/AAAAAAAAFb4/QARDYqQVQGY/s0/" alt="https://lh3.googleusercontent.com/-V3SqO3Rz88s/VUZvFcBNMPI/AAAAAAAAFb4/QARDYqQVQGY/s0/" /&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;Given that the RTF and the DOCX importers share lots of code in the
&lt;code&gt;writerfilter/&lt;/code&gt; module, I implemented the same for the DOCX import at the same
time, too. The interesting challenge was that writerfilter wants an
&lt;a href="http://api.libreoffice.org/docs/idl/ref/interfacecom_1_1sun_1_1star_1_1document_1_1XFilter.html"&gt;XFilter&lt;/a&gt;
implementation for the embedded object if it is to be handled internally by
LibreOffice, but the MathType filter (originally created to handle math
objects inside binary DOC files) didn&amp;#8217;t have one. Once I implemented such a
&lt;a href="http://cgit.freedesktop.org/libreoffice/core/commit/?id=add60d233f70ff56472448bd50b3771f38974c52"&gt;filter
wrapper&lt;/a&gt;, the
&lt;a href="http://cgit.freedesktop.org/libreoffice/core/commit/?id=2a3e8b470edf2fe76188f9ccf6b0f32dfc817ea4"&gt;rest&lt;/a&gt;
wasn&amp;#8217;t too hard.&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;Here are
&lt;a href="http://cgit.freedesktop.org/libreoffice/core/tree/sw/qa/extras/rtfimport/data/mathtype.rtf"&gt;test&lt;/a&gt;
&lt;a href="http://cgit.freedesktop.org/libreoffice/core/tree/sw/qa/extras/ooxmlimport/data/mathtype.docx"&gt;documents&lt;/a&gt;
if you want to try it yourself. You&amp;#8217;ll need a 5.0
&lt;a href="http://dev-builds.libreoffice.org/daily/master/"&gt;daily build&lt;/a&gt; for that, though.
;-)&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;If I&amp;#8217;m at describing features new in LibreOffice Writer 5.0 file filters, here are a few more:&lt;/p&gt;&lt;/div&gt;
&lt;div class="ulist"&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;
&lt;a href="http://cgit.freedesktop.org/libreoffice/core/commit/?id=830abf307aab9f9611db60b5c734fbafd3b3d8a3"&gt;Automatic hyphenation at a document
  level&lt;/a&gt; and &lt;a href="http://cgit.freedesktop.org/libreoffice/core/commit/?id=a3ec386c2283a196f8d9f1edd0ff97c38ddb281a"&gt;exceptions to it&lt;/a&gt; is now
  imported in RTF. I also adjusted the
  &lt;a href="http://cgit.freedesktop.org/libreoffice/core/commit/?id=a2fea109e6454b10e8e85148b93bdca89066fe8d"&gt;exporter&lt;/a&gt;, so now Word sort of
  understands our hyphenation rules, replacing the OOo-specific custom
  hyphenation RTF extension that Word just ignored.
&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;
&lt;a href="http://cgit.freedesktop.org/libreoffice/core/commit/?id=7546a904265cc0d0a0e3795cdb411cbb945a39fe"&gt;picture wrap distance properties&lt;/a&gt;
  are now handled in the RTF importer&amp;#8201;&amp;#8212;&amp;#8201;previously that was only handled for
  shapes.
&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;And a number of bugfixes for the RTF filter:&lt;/p&gt;&lt;/div&gt;
&lt;div class="ulist"&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;
&lt;a href="https://bugs.documentfoundation.org/show_bug.cgi?id=86182"&gt;tdf#86182&lt;/a&gt; better RTL paragraph handling
&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;
&lt;a href="https://bugs.documentfoundation.org/show_bug.cgi?id=80708"&gt;tdf#80708&lt;/a&gt; related to the improved old-style Writer table export handling work
&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;
&lt;a href="https://bugs.documentfoundation.org/show_bug.cgi?id=90421"&gt;tdf#90421&lt;/a&gt; hyperlink export tweak
&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;Do these sound interesting? Look at what others did for LibreOffice 5.0 on
&lt;a href="https://wiki.documentfoundation.org/ReleaseNotes/5.0"&gt;the TDF wiki&lt;/a&gt;, even if
it&amp;#8217;s far from complete, as the 5.0 branch is not yet created. :-)&lt;/p&gt;&lt;/div&gt;
</description>
            <link>http://vmiklos.hu/blog/mathtype-import.html</link>
            <pubDate>Sun, 03 May 2015 21:15:59 +0200</pubDate>
            <guid isPermaLink="false">http://vmiklos.hu/blog/mathtype-import.html</guid>
        </item>
        <item>
            <title>Open IT 2015</title>
            <description>&lt;div class="imageblock" style="text-align:center;"&gt;
&lt;div class="content"&gt;
&lt;img src="https://lh3.googleusercontent.com/-bcwPYUJF04A/VTY_cdBo8bI/AAAAAAAAFac/B5ICyiGoKaY/s0/" alt="https://lh3.googleusercontent.com/-bcwPYUJF04A/VTY_cdBo8bI/AAAAAAAAFac/B5ICyiGoKaY/s0/" /&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;On Saturday I gave a talk at the &lt;a href="http://openit.eventbrite.com/"&gt;Open IT 2015&lt;/a&gt;
conference about the new features of LibreOffice 4.3 and 4.4.  My uploaded
slides are available
&lt;a href="https://speakerdeck.com/vmiklos/4-dot-4-es-kiadasban"&gt;here&lt;/a&gt;.&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;Thanks &lt;a href="https://www.uni-obuda.hu/en"&gt;Óbuda University&lt;/a&gt; for hosting us, it was a
great event! Other than talking to the usual suspects like
&lt;a href="http://zolnaitamas.blogspot.com/"&gt;Tamás Zolnai&lt;/a&gt; or
&lt;a href="https://plus.google.com/117194932353487735021/posts"&gt;Gábor Kelemen&lt;/a&gt;, I enjoyed
two OpenStreetMap talks: it was extermely cool to hear that finally the
&lt;a href="http://turistautak.hu/"&gt;turistautak.hu&lt;/a&gt; community
&lt;a href="http://wiki.openstreetmap.org/wiki/WikiProject_Hungary/Import%C3%A1l%C3%A1s/turistautak.hu"&gt;changed
their license&lt;/a&gt; in February so that all their free maps can be imported to
OpenStreetMap&amp;#8201;&amp;#8212;&amp;#8201;finally one pointless fight ends.&lt;/p&gt;&lt;/div&gt;
</description>
            <link>http://vmiklos.hu/blog/openit-2015.html</link>
            <pubDate>Tue, 21 Apr 2015 14:29:55 +0200</pubDate>
            <guid isPermaLink="false">http://vmiklos.hu/blog/openit-2015.html</guid>
        </item>
        <item>
            <title>Open Source Budapest 5. meetup</title>
            <description>&lt;div style="text-align: center; font-size: 0.6em;"&gt;
&lt;img src="https://lh3.googleusercontent.com/-ZPI3opPIqYE/VTIW5Igo5SI/AAAAAAAAFZc/rTmjqi14fZY/s800/"/&gt;
&lt;p&gt;(via &lt;a href="https://www.youtube.com/watch?v=cKTpJtRQaCM"&gt;Open Source Budapest Meetup&lt;/a&gt;)&lt;/p&gt;
&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;On Tuesday the 5th Open Source Budapest meetup was held, I was one of the
invited speakers, and gave a lightning talk about
&lt;a href="https://github.com/vmiklos/ged2dot"&gt;ged2dot&lt;/a&gt;, both as a standalone Python
script and as a
&lt;a href="http://extensions.libreoffice.org/extension-center/gedcom"&gt;LibreOffice
extension&lt;/a&gt;.&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;My uploaded slides are available
&lt;a href="https://speakerdeck.com/vmiklos/csaladfak-abrazolasa-szabad-szoftverekkel"&gt;here&lt;/a&gt;.&lt;/p&gt;&lt;/div&gt;
</description>
            <link>http://vmiklos.hu/blog/open-source-budapest-5.html</link>
            <pubDate>Fri, 17 Apr 2015 10:39:22 +0200</pubDate>
            <guid isPermaLink="false">http://vmiklos.hu/blog/open-source-budapest-5.html</guid>
        </item>
    </channel>
</rss>
