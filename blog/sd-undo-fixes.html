<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 8.5.3" />
<meta name="description" content="Recent undo/redo fixes in LibreOffice Impress - Miklos' blog" />
<meta name="keywords" content="vmiklos, libereoffice, swig, git, python, hacking, bitlbee" />
<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="http://vmiklos.hu/blog/index.rss" />
<link rel="stylesheet" href="/blog/xhtml11.css" type="text/css" />
<link rel="stylesheet" href="/blog/xhtml11-quirks.css" type="text/css" />
<link rel="stylesheet" href="/blog/layout.css" type="text/css" />
<title>Recent undo/redo fixes in LibreOffice Impress</title>
<!-- google analytics start -->
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-24726997-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<!-- google analytics end -->
</head>
<body>
<div id="layout-banner-box">
<div id="layout-banner">
  <div id="layout-title">vmiklos.hu</div>
  <div id="layout-description">shameless self-promoting website</div>
</div>
</div>
<div id="layout-menu-box">
<div id="layout-menu">
  <div>&#187;<a href="/">Root</a></div>
  <div>&#187;<a href="/blog/">Rejourn root</a></div>
  <div>&#187;<a href="http://planet.documentfoundation.org/">LibreOffice Community Blogs</a></div>
  <div>
    Search:<br/>
    <form action="http://www.google.com/cse" id="cse-search-box" target="_blank">
    <input type="hidden" name="cx" value="007336731492173318056:bik8fqvatno"/><input type="hidden" name="ie" value="UTF-8"/><input type="text" name="q" size="15"/><br/>
    <input type="submit" name="sa" value="&#187;"/></form>
  </div>
</div>

</div>
<div id="layout-content-box">
<div id="layout-content">
<div id="header">
	<h1>Recent undo/redo fixes in LibreOffice Impress</h1>
</div>
<div id="preamble">
<div class="sectionbody">

<!-- Single entry -->
<div class="verseblock">
<div class="verseblock-content">Posted <span class="timeago" title="2016-05-18T09:34:42Z">Wednesday, 18 May 2016</span> by Miklos<br />
    Tags:
    <a href="tags/en.html">en</a>
    <a href="tags/libreoffice.html">libreoffice</a>
<div class="nav-previous"><a href="/blog/classification-toolbar.html" rel="prev"><span class="meta-nav">&larr;</span> Classification toolbar in LibreOffice</a></div>
<div class="nav-next"><a href="/blog/classification-toolbar-multicat.html" rel="next">Classification toolbar in LibreOffice: Multiple Categories <span class="meta-nav">&rarr;</span></a></div>
</div>
</div>

<!-- Body -->
<div class="paragraph"><p>I&#8217;ve recently spent some time fixing a few bugs around undo/redo in Impress,
in the area of table shapes. I&#8217;m mentioning these here as they&#8217;re all bugfixes, so
they are backported to LibreOffice 5.1, and no major release notes will point
them out. So if you are using Impress table shapes and you consider their
usability suboptimal, then read on, I have some great news. :-)</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<a class="image" href="https://lh3.googleusercontent.com/-4K07Iu7su4M/Vzs8dQCfx7I/AAAAAAAAGts/7GCj5T3Zs9UMyTaR277tHvlOHSk-9HGmACCo/s0/">
<img src="https://lh3.googleusercontent.com/-4K07Iu7su4M/Vzs8dQCfx7I/AAAAAAAAGts/7GCj5T3Zs9UMyTaR277tHvlOHSk-9HGmACCo/s800/" alt="https://lh3.googleusercontent.com/-4K07Iu7su4M/Vzs8dQCfx7I/AAAAAAAAGts/7GCj5T3Zs9UMyTaR277tHvlOHSk-9HGmACCo/s800/" />
</a>
</div>
</div>
<div class="paragraph"><p>The first problem is
<a href="https://bugs.documentfoundation.org/show_bug.cgi?id=99396">tdf#99396</a>, where
there were actually two problems:</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Vertical alignment is a cell property, but when setting that property, the undo code was simply <a href="https://cgit.freedesktop.org/libreoffice/core/commit/?id=6819992113947e7a6272bf750fee712c2df41905">missing</a>.
</p>
</li>
<li>
<p>
When editing cell text (the user is inside "text edit") the undo stack is in
a special mode&#8201;&#8212;&#8201;and ending text edit made the cell property undo items go
away. This wasn&#8217;t a problem for vertical alignment only, it was a problem for
example when the background color of the cell was changed, too. These cell
property changes are now
<a href="https://cgit.freedesktop.org/libreoffice/core/commit/?id=100eb15b4d8529d7a11d98a28742f31f0f792fa1">added</a>
to the undo stack after finishing text edit, so you can still undo them later.
</p>
</li>
</ol></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<a class="image" href="https://lh3.googleusercontent.com/-aCZDFOS8xR4/Vzs8bzEjtvI/AAAAAAAAGtw/ZESadiryhEAwAsLoxwztIRNvSjdwOEmDgCCo/s0/">
<img src="https://lh3.googleusercontent.com/-aCZDFOS8xR4/Vzs8bzEjtvI/AAAAAAAAGtw/ZESadiryhEAwAsLoxwztIRNvSjdwOEmDgCCo/s600/" alt="https://lh3.googleusercontent.com/-aCZDFOS8xR4/Vzs8bzEjtvI/AAAAAAAAGtw/ZESadiryhEAwAsLoxwztIRNvSjdwOEmDgCCo/s600/" />
</a>
</div>
</div>
<div class="paragraph"><p>The second bugreport is
<a href="https://bugs.documentfoundation.org/show_bug.cgi?id=99452">tdf#99452</a> where
resizing a table shape row separator and then undoing the resize didn&#8217;t
restore the original state. See the
<a href="https://cgit.freedesktop.org/libreoffice/core/commit/?id=cafc53f8b4c08443524b1da6f4918d49afd45bb5">commit</a>
for all the details, but the bottom line is: it isn&#8217;t a good idea to
automatically re-layout the table when we&#8217;ve already resized the shape as part
of undo, but the table rows were not yet resized to reflect their original
sizes.</p></div>
<div class="paragraph"><p>As usual, you can try this right now with a 5.2
<a href="http://dev-builds.libreoffice.org/daily/master/">daily build</a>. :-) (Or even
with an 5.1 one, actually.)</p></div>


<script src="https://apis.google.com/js/plusone.js"></script>
<g:plus action="share"></g:plus>

<!-- Disqus comments -->
<h1 id="comment-header">Comments</h1>
<div id="disqus_thread"></div>
<script type="text/javascript" src="http://vmiklos.disqus.com/embed.js">
	var disqus_developer = 1;
</script>
<noscript>
  <p><a href="http://disqus.com/?ref_noscript=vmiklos">View the discussion thread.</a></p>
</noscript>

</div>
</div>
</div>
</div>
</body>
</html>
