<!DOCTYPE html>
<html lang="en">

<head>
  <!-- ## for client-side less
  <link rel="stylesheet/less" type="text/css" href="https://vmiklos.hu/blog/theme/css/style.less">
  <script src="http://cdnjs.cloudflare.com/ajax/libs/less.js/1.7.3/less.min.js" type="text/javascript"></script>
  -->
  <link rel="stylesheet" type="text/css" href="https://vmiklos.hu/blog/theme/css/style.css">
  <link rel="stylesheet" type="text/css" href="https://vmiklos.hu/blog/theme/css/pygments.css">

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="author" content="Miklos Vajna">
  <meta name="description" content="Posts and writings by Miklos Vajna">

  <link href="https://vmiklos.hu/blog/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="What is Miklos hacking RSS" />

<meta name="keywords" content="en">

  <title>
    What is Miklos hacking
&ndash; Markdown import in Writer: the new template option  </title>

<script type="text/javascript">
  var _paq = window._paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="//analytics.vmiklos.hu/";
    _paq.push(['setTrackerUrl', u+'matomo.php']);
    _paq.push(['setSiteId', '1']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
</head>

<body>
  <aside>
    <div id="user_meta">
      <h2><a href="https://vmiklos.hu/blog">What is Miklos hacking</a></h2>
      <p></p>
      <ul>
        <li><a href="/" target="_blank">Root</a></li>
        <li><a href="https://planet.documentfoundation.org/" target="_blank">LibreOffice Blogs</a></li>
      </ul>
    </div>
  </aside>

  <main>
    <header>
      <p>
      <a href="https://vmiklos.hu/blog">Index</a> &brvbar; <a href="https://vmiklos.hu/blog/archives.html">Archives</a>
      &brvbar; <a href="https://vmiklos.hu/blog/feeds/all.rss.xml">RSS</a>
      </p>
    </header>

<article>
  <div class="article_title">
    <h1><a href="https://vmiklos.hu/blog/sw-markdown-templating.html">Markdown import in Writer: the new template option</a></h1>
  </div>
  <div class="article_meta">
    <p>Posted on: Wed 03 December 2025</p>
  </div>
  <div class="article_readtime">
    <p>Estimated read time: 3 minutes</p>
  </div>
  <div class="article_text">
    <p>Writer recently got a new markdown import option to take styles from a template, leading to much
prettier output when converting markdown to PDF, DOCX or ODT.</p>
<p>This work is primarily for <a href="https://www.collaboraonline.com/">Collabora Online</a>, but the templating
feature is available in desktop Writer as well.</p>
<h2 id="motivation">Motivation<a class="headerlink" href="#motivation" title="Permanent link">&para;</a></h2>
<p>A <a href="https://vmiklos.hu/blog/sw-markdown-filter.html">previous post</a> mentioned recent improvements to the
markdown import/export in Writer.</p>
<p>But if you convert some markdown to e.g. PDF, all the headings just have the default look, wouldn't
it be nice to take your organization template and add colors and other formatting there,
automatically?</p>
<p>Also, wouldn't it be nice if you could paste as markdown in COOL or copy the current selection as
markdown? Which would enable all sorts of interesting use-cases, like using an external API to turn
the selection into a summary or translating it to a different language.</p>
<h2 id="results-so-far">Results so far<a class="headerlink" href="#results-so-far" title="Permanent link">&para;</a></h2>
<p>Here is a sample input markdown:</p>
<div class="highlight"><pre><span></span><code><span class="gh"># heading 1</span>

body text
</code></pre></div>

<p>Here is how it looks like if you template it using the core.git <code>sw/qa/filter/md/data/template.docx</code>
sample:</p>
<p><a href="https://share.vmiklos.hu/blog/sw-markdown-templating/templated.png"><figure><img src="https://share.vmiklos.hu/blog/sw-markdown-templating/templated.png"><figcaption>PDF result: templated</figcaption></figure></a></p>
<p>curl invocation for this:</p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-k<span class="w"> </span>-F<span class="w"> </span><span class="s2">&quot;data=@/path/to/test.md&quot;</span><span class="w"> </span>-F<span class="w"> </span><span class="s2">&quot;template=@/path/to/template.docx&quot;</span><span class="w"> </span>-F<span class="w"> </span><span class="s2">&quot;format=pdf&quot;</span><span class="w"> </span>-o<span class="w"> </span>out.pdf<span class="w"> </span>https://localhost:9980/cool/convert-to
</code></pre></div>

<p>Or example desktop command-line:</p>
<div class="highlight"><pre><span></span><code>soffice<span class="w"> </span>--infilter<span class="o">=</span><span class="s1">&#39;Markdown:{&quot;TemplateURL&quot;:{&quot;type&quot;:&quot;string&quot;,&quot;value&quot;:&quot;./template.ott&quot;}}&#39;</span><span class="w"> </span>test.md
</code></pre></div>

<p>While it would look like this by default:</p>
<p><a href="https://share.vmiklos.hu/blog/sw-markdown-templating/default.png"><figure><img src="https://share.vmiklos.hu/blog/sw-markdown-templating/default.png"><figcaption>PDF result: default</figcaption></figure></a></p>
<p>The other part is the PostMessage API of COOL, if you want to copy and paste as markdown. What's
newly possible:</p>
<ul>
<li>Copy the current selection: set MessageId to <code>Action_Copy</code> and the value to <code>{"Mimetype": "text/markdown;charset=utf-8"}</code></li>
<li>Paste at the current cursor position: set MessageId to <code>Action_Paste</code> and the value to
  something like <code>{"Mimetype": "text/markdown;charset=utf-8", "Data": "foo _bar_ baz"}</code></li>
</ul>
<p>You can read more about the PostMessage API in the <a href="https://sdk.collaboraonline.com/docs/postmessage_api.html">COOL
SDK</a>.</p>
<h2 id="how-is-this-implemented">How is this implemented?<a class="headerlink" href="#how-is-this-implemented" title="Permanent link">&para;</a></h2>
<p>If you would like to know a bit more about how this works, continue reading... :-)</p>
<p>As usual, the high-level problem was addressed by a series of small changes. Core side:</p>
<ul>
<li><a href="https://git.libreoffice.org/core/commit/7462639341c043bf72560e0ddfff06e1e8879859">tdf#169316 sw markdown import: add a TemplateURL parameter</a></li>
<li><a href="https://git.libreoffice.org/core/commit/6d1312e160ee8c2c0f65b6e0a86333bf3c9c60ce">tdf#169316 sw markdown import, template: handle non-ODF formats as well</a></li>
<li><a href="https://git.libreoffice.org/core/commit/64cf69926b7cb6fc94efd792b173ac12aa93cb8f">cool#13468 sw markdown paste: add UNO command parameter to skip the detection</a></li>
<li><a href="https://git.libreoffice.org/core/commit/5ae32bee8dfe5b3264debc02276a3eeac7f51021">Related: tdf#169251 sw markdown export: fix crash on OLE with no graphic</a></li>
</ul>
<p>Online side:</p>
<ul>
<li><a href="https://github.com/collaboraonline/online/commit/5741a8fe91f9fe2969926cf70c8c51f1dd144ad5">cool#13419 convert-to template option: handle multiple streams in ConvertToPartHandler</a></li>
<li><a href="https://github.com/collaboraonline/online/commit/31109066f2ea2b935cd9d2bc06b5debc6206b41a">cool#13419 convert-to template option: pass it to doc broker</a></li>
<li><a href="https://github.com/collaboraonline/online/commit/3916a7f82fd6454409b86b9915d33f9f2491a348">cool#13419 convert-to template option: pass it to the kit process</a></li>
<li><a href="https://github.com/collaboraonline/online/commit/b993c314e1b50aea382a1dac7391a3949e65045b">cool#13419 convert-to template option: more strict param name, generalize filenames</a></li>
<li><a href="https://github.com/collaboraonline/online/commit/852479accd67880934393f14c4101ad72e9ba806">cool#13419 convert-to template option: add testcase</a></li>
<li><a href="https://github.com/collaboraonline/online/commit/81881d58fd537924091a5e2e41d033e91c98c8be">cool#13468 PostMessage API: allow copying the current text selection</a></li>
</ul>
<h2 id="want-to-start-using-this">Want to start using this?<a class="headerlink" href="#want-to-start-using-this" title="Permanent link">&para;</a></h2>
<p>You can get a development edition of Collabora Online 25.04 and try it out yourself right now: <a href="https://www.collaboraonline.com/code/">try
the development edition</a>.  Collabora intends to continue
supporting and contributing to LibreOffice, the code is merged so we expect the core of this work
will be available in TDF's next release too (26.2).</p>
  </div>
  <div class="article_meta">
    <p>Category: <a href="https://vmiklos.hu/blog/category/libreoffice.html">libreoffice</a>
 &ndash; Tags:
      <a href="https://vmiklos.hu/blog/tag/en.html">en</a>    </p>
  </div>


</article>


    <div id="ending_message">
      <p>&copy; Miklos Vajna. Built using <a href="http://getpelican.com" target="_blank">Pelican</a>. Theme by Giulio Fidente on <a href="https://github.com/gfidente/pelican-svbhack" target="_blank">github</a>. </p>
    </div>
  </main>
</body>
</html>