<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 8.5.3" />
<meta name="description" content="What is Miklos hacking - Miklos' blog" />
<meta name="keywords" content="vmiklos, libereoffice, swig, git, python, hacking, bitlbee" />
<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="http://vmiklos.hu/blog/index.rss" />
<link rel="stylesheet" href="/blog/xhtml11.css" type="text/css" />
<link rel="stylesheet" href="/blog/xhtml11-quirks.css" type="text/css" />
<link rel="stylesheet" href="/blog/layout.css" type="text/css" />
<title>What is Miklos hacking</title>
<!-- google analytics start -->
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-24726997-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<!-- google analytics end -->
</head>
<body>
<div id="layout-banner-box">
<div id="layout-banner">
  <div id="layout-title">vmiklos.hu</div>
  <div id="layout-description">shameless self-promoting website</div>
</div>
</div>
<div id="layout-menu-box">
<div id="layout-menu">
  <div>&#187;<a href="/">Root</a></div>
  <div>&#187;<a href="/blog/">Rejourn root</a></div>
  <div>&#187;<a href="http://planet.documentfoundation.org/">LibreOffice Community Blogs</a></div>
  <div>
    Search:<br/>
    <form action="http://www.google.com/cse" id="cse-search-box" target="_blank">
    <input type="hidden" name="cx" value="007336731492173318056:bik8fqvatno"/><input type="hidden" name="ie" value="UTF-8"/><input type="text" name="q" size="15"/><br/>
    <input type="submit" name="sa" value="&#187;"/></form>
  </div>
</div>

<div id="alltags-menu">
	Tags:
	<div>&#187;<a href="/blog/tags/hu.html">hu</a> (1195)</div>
	<div>&#187;<a href="/blog/tags/en.html">en</a> (499)</div>
	<div>&#187;<a href="/blog/tags/hacking.html">hacking</a> (416)</div>
	<div>&#187;<a href="/blog/tags/film.html">film</a> (284)</div>
	<div>&#187;<a href="/blog/tags/geek.html">geek</a> (82)</div>
	<div>&#187;<a href="/blog/tags/bringa.html">bringa</a> (57)</div>
	<div>&#187;<a href="/blog/tags/libreoffice.html">libreoffice</a> (52)</div>
	<div>&#187;<a href="/blog/tags/konyv.html">konyv</a> (43)</div>
	<div>&#187;<a href="/blog/tags/misc.html">misc</a> (37)</div>
	<div>&#187;<a href="/blog/tags/zene.html">zene</a> (32)</div>
	<div>&#187;<a href="/blog/tags/munka.html">munka</a> (28)</div>
	<div>&#187;<a href="/blog/tags/fun.html">fun</a> (27)</div>
	<div>&#187;<a href="/blog/tags/frugalware.html">frugalware</a> (23)</div>
	<div>&#187;<a href="/blog/tags/sieles.html">sieles</a> (7)</div>
	<div>&#187;<a href="/blog/tags/bitlbee.html">bitlbee</a> (5)</div>
	<div>&#187;<a href="/blog/tags/gsoc2009.html">gsoc2009</a> (4)</div>
	<div>&#187;<a href="/blog/tags/git.html">git</a> (3)</div>
	<div>&#187;<a href="/blog/tags/szinhaz.html">szinhaz</a> (3)</div>
	<div>&#187;<a href="/blog/tags/gsoc2008.html">gsoc2008</a> (3)</div>
	<div>&#187;<a href="/blog/tags/opensuse.html">opensuse</a> (3)</div>
	<div>&#187;<a href="/blog/tags/gsoc2011.html">gsoc2011</a> (2)</div>
	<div>&#187;<a href="/blog/tags/go-oo.html">go-oo</a> (2)</div>
	<div>&#187;<a href="/blog/tags/kde.html">kde</a> (1)</div>
	<div>&#187;<a href="/blog/tags/libwpd.html">libwpd</a> (1)</div>
	<div>&#187;<a href="/blog/tags/karacsony.html">karacsony</a> (1)</div>
	<div>&#187;<a href="/blog/tags/google.html">google</a> (1)</div>
	<div>&#187;<a href="/blog/tags/fail.html">fail</a> (1)</div>
	<div>&#187;<a href="/blog/tags/openstack.html">openstack</a> (1)</div>
	<div>&#187;<a href="/blog/tags/mdadm.html">mdadm</a> (1)</div>
	<div>&#187;<a href="/blog/tags/w3c.html">w3c</a> (1)</div>
	<div>&#187;<a href="/blog/tags/java.html">java</a> (1)</div>
	<div>&#187;<a href="/blog/tags/greasemonkey.html">greasemonkey</a> (1)</div>
	<div>&#187;<a href="/blog/tags/auto.html">auto</a> (1)</div>
	<div>&#187;<a href="/blog/tags/gsoc2010.html">gsoc2010</a> (1)</div>
	<div>&#187;<a href="/blog/tags/bme.html">bme</a> (1)</div>
	<div>&#187;<a href="/blog/tags/howto.html">howto</a> (1)</div>
	<div>&#187;<a href="/blog/tags/openoffice.html">openoffice</a> (1)</div>
	<div>&#187;<a href="/blog/tags/gpsbabel.html">gpsbabel</a> (1)</div>
	<div>&#187;<a href="/blog/tags/lcov.html">lcov</a> (1)</div>
	<div>&#187;<a href="/blog/tags/nyaralas.html">nyaralas</a> (1)</div>
</div>

</div>
<div id="layout-content-box">
<div id="layout-content">
<div id="header">
	<h1>What is Miklos hacking</h1>
</div>
<div id="preamble">
<div class="sectionbody">




<!-- Listing -->
<div class="ulist"><ul>
<li><p>Friday, 21 March 2014<br /><a href="/blog/gravitacio.html">Gravitáció</a>
(<a href="/blog/gravitacio.html#disqus_thread">Comments</a>)
</p><p><div class="imageblock" style="text-align:center;">
<div class="content">
<a class="image" href="https://lh5.googleusercontent.com/-GMzf_-nlXxc/UyywX8g4lKI/AAAAAAAAEHQ/Zb4mbF2Gqh8/w1309-h818-no/">
<img src="https://lh5.googleusercontent.com/-GMzf_-nlXxc/UyywX8g4lKI/AAAAAAAAEHQ/Zb4mbF2Gqh8/s400/" alt="https://lh5.googleusercontent.com/-GMzf_-nlXxc/UyywX8g4lKI/AAAAAAAAEHQ/Zb4mbF2Gqh8/s400/" />
</a>
</div>
</div>
<div class="paragraph"><p>Ma láttam ezt a filmet, csak ajánlani tudom. Tipikus példája annak, hogy annak
ellenére, hogy ez 8.1 pontot kapott IMDB-n, míg pl. A Wall Street farkasa a
8.4-et, mégis nekem az egyértelműen jobban tetszett.</p></div>
<div class="paragraph"><p>Pedig nem volt benne se orrvérzésig kokózabálás, se szaporodás, és még
szakkifejezésből is alig. :-)</p></div>
<div class="paragraph"><p>(<a href="http://www.imdb.com/title/tt1454468/">imdb</a>, <a href="http://www.youtube.com/watch?v=ufsrgE0BYf0">trailer</a>)</p></div>
</p><hr/></li>
<li><p>Sunday, 09 March 2014<br /><a href="/blog/doctok.html">Death of doctok in LibreOffice</a>
(<a href="/blog/doctok.html#disqus_thread">Comments</a>)
</p><p><div class="imageblock" style="text-align:center;">
<div class="content">
<a class="image" href="https://lh5.googleusercontent.com/-IumGq3jzNdI/UxxG3Deg6QI/AAAAAAAAEFY/Ij7oMS7YyoY/s809/">
<img src="https://lh5.googleusercontent.com/-IumGq3jzNdI/UxxG3Deg6QI/AAAAAAAAEFY/Ij7oMS7YyoY/s300/" alt="https://lh5.googleusercontent.com/-IumGq3jzNdI/UxxG3Deg6QI/AAAAAAAAEFY/Ij7oMS7YyoY/s300/" />
</a>
</div>
</div>
<div class="paragraph"><p>Last year in September we
<a href="http://lists.freedesktop.org/archives/libreoffice/2013-September/055976.html">decided</a>
to get rid of the writerfilter-based DOC tokenizer, and I volunteered to
actually do this. As cleanups in general have a low priority, I only
progressed with this slowly, though yesterday I completed it, that&#8217;s why I&#8217;m
writing this post. :-)</p></div>
<div class="paragraph"><p>Some background: the writerfilter module is responsible for RTF and DOCX
import in Writer. As the above picture shows, the currently used DOC import is
independent from it, and there was also an <em>other</em> DOC import filter, that was
in writerfilter which was disabled at runtime. As I don&#8217;t like duplication, I
examined the state of the two filters, and the linked minutes mail details
how we decided that the old filter will stay, and we&#8217;ll get rid of the
writerfilter one. It&#8217;s just a matter of deleting that code, right? :-) That&#8217;s
what I thought first. But then I had to realize that the architecture of
writerfilter is a bit more complex:</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<a class="image" href="https://lh3.googleusercontent.com/-vBMsCsYLRZE/UxxG3PsuI2I/AAAAAAAAEFc/Ly8sQ0ydY1A/s831/">
<img src="https://lh3.googleusercontent.com/-vBMsCsYLRZE/UxxG3PsuI2I/AAAAAAAAEFc/Ly8sQ0ydY1A/s400/" alt="https://lh3.googleusercontent.com/-vBMsCsYLRZE/UxxG3PsuI2I/AAAAAAAAEFc/Ly8sQ0ydY1A/s400/" />
</a>
</div>
</div>
<div class="paragraph"><p>It has the following components:</p></div>
<div class="ulist"><ul>
<li>
<p>
the dmapper (domain mapper), that handles all the nasty complexities of
  mapping Word concepts to Writer concepts (think of e.g. sections ↔ page
  styles)
</p>
</li>
<li>
<p>
one tokenizer for each (RTF, DOCX, DOC) format
</p>
</li>
</ul></div>
<div class="paragraph"><p>The traffic between the tokenizers and dmapper is called tokens. Naturally
it&#8217;s not enough that tokenizers send and dmapper receives these tokens, they
should be <em>defined</em> somewhere as well. And that&#8217;s where I realized this work
will take a bit more time: instead of having a single token definition,
actually the ooxml tokenizer defined its own grammar, and doctok also defined
two <em>additional</em> grammars. And of course dmapper had to handle all of that.
;-) Given that OOXML is a superset of the DOC/RTF format, it makes sense to
just use the ooxml grammar, and get rid of the other two.</p></div>
<div class="paragraph"><p>Especially that&#8201;&#8212;&#8201;by now you probably found this out&#8201;&#8212;&#8201;if I wanted to kill
doctok, I had to kill the sprm and rtf grammars as well. Otherwise just
removing doctok would break the RTF and DOCX import as well, as those also
used the rtf/sprm grammars.</p></div>
<div class="paragraph"><p>So at the end, the cleaned up architecture now looks like this:</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<a class="image" href="https://lh5.googleusercontent.com/-Iki8jKN61vE/UxxG3FaQc2I/AAAAAAAAEFQ/hWFsR20qB5o/s813/">
<img src="https://lh5.googleusercontent.com/-Iki8jKN61vE/UxxG3FaQc2I/AAAAAAAAEFQ/hWFsR20qB5o/s400/" alt="https://lh5.googleusercontent.com/-Iki8jKN61vE/UxxG3FaQc2I/AAAAAAAAEFQ/hWFsR20qB5o/s400/" />
</a>
</div>
</div>
<div class="paragraph"><p>And that has multiple advantages:</p></div>
<div class="ulist"><ul>
<li>
<p>
It removes quite some code: In <code>libreoffice-4-1</code>, the doctok was 78849 (!)
  lines of code (well, part of that was XML data, and some scripts generated
  C++ code from that).
</p>
</li>
<li>
<p>
dmapper now doesn&#8217;t have to handle the rtf and sprm grammars anymore, so now
  there is a <em>single</em> place in dmapper that handles e.g. the italic character
  property.
</p>
</li>
<li>
<p>
Smaller writerfilter binary for the end user: even if doctok wasn&#8217;t enabled
  at runtime, it was shipped in the installation set.
</p>
</li>
<li>
<p>
Hopefully it&#8217;s now a bit more easy to understand writerfilter: at least e.g.
  if you want to look up the place where dmapper handles the character bold
  ("b") XML tag of OOXML, you don&#8217;t have to know that the binary DOC
  equivalent of that is sprmCFBold, just because we have an unused DOC tokenizer
  there as well. :-)
</p>
</li>
<li>
<p>
Given that DOC and RTF formats are a dead end, I think it&#8217;s a good thing
  that in writerfilter now <em>the</em> grammar is OOXML (that keeps introducing new
  features), rather than some dead format. ;-)
</p>
</li>
</ul></div>
</p><hr/></li>
<li><p>Saturday, 08 March 2014<br /><a href="/blog/steve-jobs.html">Walter Isaacson — Steve Jobs</a>
(<a href="/blog/steve-jobs.html#disqus_thread">Comments</a>)
</p><p><div class="imageblock" style="text-align:center;">
<div class="content">
<a class="image" href="http://www.libri.hu/konyv/steve-jobs-2.html">
<img src="https://lh3.googleusercontent.com/-RPyYJVr3DHY/UxsCe-96V6I/AAAAAAAAEEw/07ae-seYztw/s400/" alt="https://lh3.googleusercontent.com/-RPyYJVr3DHY/UxsCe-96V6I/AAAAAAAAEEw/07ae-seYztw/s400/" />
</a>
</div>
</div>
<div class="paragraph"><p>Leginkább a <a href="http://www.imdb.com/title/tt1285016/">The Social Networkhöz</a> tudnám
hasonlítani ezt a könyvet, itt se törekedett a szerző arra, hogy csak pozitív
vélemények jelenjenek meg a könyvben, sőt. Talán ami a legjobban tetszett
benne az pont ez: azzal, hogy Jobsot rendszeresen bírálja a fekete-fehér
látásmódja miatt, maga a könyv sokkal árnyaltabb képet fest az emberről, és
így nekem hitelesebb is.</p></div>
</p><hr/></li>
<li><p>Friday, 28 February 2014<br /><a href="/blog/comments-nested.html">LibreOffice Writer now supports nested comments in its DOC/RTF filters</a>
(<a href="/blog/comments-nested.html#disqus_thread">Comments</a>)
</p><p><div class="imageblock" style="text-align:center;">
<div class="content">
<a class="image" href="https://lh3.googleusercontent.com/-FdnXBOBQWjc/UxA1LD0-fyI/AAAAAAAAEDk/2hYmN8ASkxA/s1024/comments-nested.png">
<img src="https://lh3.googleusercontent.com/-FdnXBOBQWjc/UxA1LD0-fyI/AAAAAAAAEDk/2hYmN8ASkxA/s400/comments-nested.png" alt="https://lh3.googleusercontent.com/-FdnXBOBQWjc/UxA1LD0-fyI/AAAAAAAAEDk/2hYmN8ASkxA/s400/comments-nested.png" />
</a>
</div>
</div>
<div class="paragraph"><p>If you ever tried to use nested comments in Writer (make a selection, Insert
&#8594; Comment, then make an overlapping selection, and do it again), you may have
noticed that only the ODF filter can load and save such a document properly.
Recently I have improved this situation a lot. Motivated by seeing this is now
supported in the DOCX import filter, I now added support for this also to the
DOCX export, RTF import/export and binary DOC import/export filters.</p></div>
<div class="paragraph"><p>If you want to try this out, core.git has a
<a href="http://cgit.freedesktop.org/libreoffice/core/tree/sw/qa/extras/ooxmlexport/data/comments-nested.odt">ODT</a>
and
<a href="http://cgit.freedesktop.org/libreoffice/core/tree/sw/qa/extras/ww8export/data/comments-nested.doc">DOC</a>
samples to play with.</p></div>
</p><hr/></li>
<li><p>Saturday, 22 February 2014<br /><a href="/blog/tavaszebredes.html">Tavaszébredés</a>
(<a href="/blog/tavaszebredes.html#disqus_thread">Comments</a>)
</p><p><div class="imageblock" style="text-align:center;">
<div class="content">
<img src="https://lh6.googleusercontent.com/-Vvh91N1rHGw/UwkUg1ENQbI/AAAAAAAAEDM/npexiTpK5GA/s300/" alt="https://lh6.googleusercontent.com/-Vvh91N1rHGw/UwkUg1ENQbI/AAAAAAAAEDM/npexiTpK5GA/s300/" />
</div>
</div>
<div class="paragraph"><p>Múlt hét elején láttuk ezt a darabot, egy mondatban a
<a href="http://www.kontrasztkiallitas.hu/">Kontrasztkiállítás</a> színpadi adaptációjaként
tudnám jellemezni, de mivel musical, azért ez kicsit emészthetőbb és
élvezetesebb volt. ;-)</p></div>
<div class="paragraph"><p>(<a href="http://hu.wikipedia.org/wiki/Tavasz%C3%A9bred%C3%A9s">wikipédia</a>,
<a href="http://www.musicalinfo.hu/ot-eves-a-tavaszebredes-musical-3232">musicalinfo</a>)</p></div>
</p><hr/></li>
<li><p>Thursday, 06 February 2014<br /><a href="/blog/fosdem2014.html">InteropGrabBag in LibreOffice Writer</a>
(<a href="/blog/fosdem2014.html#disqus_thread">Comments</a>)
</p><p><div class="imageblock" style="text-align:center;">
<div class="content">
<a class="image" href="https://speakerdeck.com/vmiklos/interopgrabbag-in-libreoffice-writer">
<img src="https://lh5.googleusercontent.com/-XoQPls8ulH4/UvOP_KUNG8I/AAAAAAAAEA0/BSJLDOfvLUA/s400/interopgrabbag-fosdem-brussels-2k14-0.jpg" alt="https://lh5.googleusercontent.com/-XoQPls8ulH4/UvOP_KUNG8I/AAAAAAAAEA0/BSJLDOfvLUA/s400/interopgrabbag-fosdem-brussels-2k14-0.jpg" />
</a>
</div>
</div>
<div class="paragraph"><p>I&#8217;ve arrived home yesterday from Brussels where I
<a href="https://fosdem.org/2014/schedule/event/interopgrabbag_in_libreoffice_writer/">presented</a>
at FOSDEM 2014, in the
<a href="https://fosdem.org/2014/schedule/track/open_document_editors/">Open document
editors devroom</a>.</p></div>
<div class="paragraph"><p>We also had a
<a href="https://wiki.documentfoundation.org/Hackfest/FOSDEM2014">Hackfest</a>, kindly
hosted by <a href="http://www.betacowork.com/">Betacowork</a> on Monday and Tuesday.</p></div>
<div class="paragraph"><p>Here are a few talks I enjoyed, not counting the LibreOffice ones:</p></div>
<div class="ulist"><ul>
<li>
<p>
<a href="https://fosdem.org/2014/schedule/event/simplifying_reuse_with_metadata_support_in_odf_and_plugin_apis/">Simplifying
  reuse with metadata support in ODF and plugin APIs</a>&#8201;&#8212;&#8201;finally a simple way
  to copy&amp;paste images from Firefox to LibreOffice with source attribution.
</p>
</li>
<li>
<p>
<a href="https://fosdem.org/2014/schedule/event/valgrind_gdb/">Combining the power of
  Valgrind and GDB</a>&#8201;&#8212;&#8201;useful to know about this possibility
</p>
</li>
<li>
<p>
<a href="https://fosdem.org/2014/schedule/event/usecasesclangcppparser/">Two uses
  cases for the clang C++ parser: Online Code Browser and Qt moc Replacement.</a>
 &#8201;&#8212;&#8201;maybe the first could replace our crappy Java-based opengrok? We&#8217;ll see.
</p>
</li>
</ul></div>
<div class="paragraph"><p>I was also happy to meet Jacobo, Matus, Tim and Tomaž finally personally. :-)</p></div>
<div class="paragraph"><p>Quite some other slides are now available on
<a href="http://planet.documentfoundation.org/">Planet</a>, don&#8217;t miss them. I also took
some pictures, available
<a href="https://picasaweb.google.com/104737754628780823336/200140205_Brusszel">here</a>,
including photos of all speakers in our devroom.</p></div>
</p><hr/></li>
<li><p>Sunday, 26 January 2014<br /><a href="/blog/csapd-le-csacsi.html">Csapd le csacsi!</a>
(<a href="/blog/csapd-le-csacsi.html#disqus_thread">Comments</a>)
</p><p><div class="imageblock" style="text-align:center;">
<div class="content">
<a class="image" href="https://lh5.googleusercontent.com/-ZW0AfVOyjV8/UuVequcN4sI/AAAAAAAAD_s/7sXFZRSstiE/s619/cslcs.png">
<img src="https://lh5.googleusercontent.com/-ZW0AfVOyjV8/UuVequcN4sI/AAAAAAAAD_s/7sXFZRSstiE/s400/cslcs.png" alt="https://lh5.googleusercontent.com/-ZW0AfVOyjV8/UuVequcN4sI/AAAAAAAAD_s/7sXFZRSstiE/s400/cslcs.png" />
</a>
</div>
</div>
<div class="paragraph"><p>Ha nem szerepelne a filmben Béla (Eperjes Károly) karaktere, biztosan azt
hittem volna, hogy ez a film valójában még a rendszerváltás előtt játszódik.
Leginkább a <a href="http://www.imdb.com/title/tt0092040/">Szamárköhögésre</a> emlékeztet
stílusában, talán nem is véletlen, hogy a Nagyit mindkét filmben Töröcsik Mari
játssza&#8230;</p></div>
<div class="paragraph"><p>Amúgy az hogy van, hogy IMDB-n '92-es,
<a href="http://port.hu/pls/fi/films.film_page?i_film_id=385">port.hu</a> szerint viszont
'90-es a film? ;-)</p></div>
<div class="paragraph"><p>(<a href="http://www.imdb.com/title/tt0101632/">imdb</a>, <a href="http://www.youtube.com/watch?v=WguLcAQaKYw">trailer</a>)</p></div>
</p><hr/></li>
<li><p>Saturday, 11 January 2014<br /><a href="/blog/lo-writer-drawingml-shape-improvements.html">OOXML shape improvements in LibreOffice Writer 4.3</a>
(<a href="/blog/lo-writer-drawingml-shape-improvements.html#disqus_thread">Comments</a>)
</p><p><div class="paragraph"><p>Although LibreOffice 4.2.0 is
<a href="https://wiki.documentfoundation.org/ReleasePlan/4.2">not yet released</a>, it was
already branched off from <code>master</code> in November last year, and improvements for
the next release are already cooking in <code>master</code>. One of these will be a major
improvement of shape handling in the DOCX import/export filter.</p></div>
<div class="paragraph"><p>Some background: when DOCX was initially introduced, it still used
<a href="http://en.wikipedia.org/wiki/Vector_Markup_Language">VML</a> (which is in short
an XML equivalent of the binary shape format), and only Word 2010 started to
write shapes using
<a href="http://en.wikipedia.org/wiki/Office_Open_XML_file_formats#DrawingML">drawingML</a>.
Given that Word still understands VML, it wasn&#8217;t urgent for us to write shapes
using the drawingML markup. As for import, Word still writes an approximate
version of the shape in VML as a fallback&#8201;&#8212;&#8201;that&#8217;s what we read till now.
Needless to say, newer drawingML features have no VML equivalent so with time
it became more and more important for us to finally read and write shapes in
DOCX using drawingML, which just happened in Writer.</p></div>
<div class="paragraph"><p>I&#8217;m posting here a few screenshots showing the improvements I&#8217;ve implemented.
Note that final 4.3 is still far from being released, so this is not a
complete list. :-) In each case I&#8217;m providing a screenshot showing how it
looked (at the end of an import/export/import again roundtrip) <em>before</em>, how
it looks <em>now</em> in 4.3 and the <em>reference</em> layout. Click on the images to get a
larger image:</p></div>
<div class="ulist"><ul>
<li>
<p>
document with different colors
  (<a href="http://people.freedesktop.org/~vmiklos/2014/docx-drawingml/color.docx">test doc</a>):
</p>
</li>
</ul></div>
<div align="center">
<div class="paragraph"><p><span class="image">
<a class="image" href="https://lh3.googleusercontent.com/-9mP2CfnGea4/UtFifqpPAII/AAAAAAAAD7k/5vJFQNHZOew/s500/color-lo42.png">
<img src="https://lh3.googleusercontent.com/-9mP2CfnGea4/UtFifqpPAII/AAAAAAAAD7k/5vJFQNHZOew/s400/color-lo42.png" alt="https://lh3.googleusercontent.com/-9mP2CfnGea4/UtFifqpPAII/AAAAAAAAD7k/5vJFQNHZOew/s400/color-lo42.png" />
</a>
</span>
<span class="image">
<a class="image" href="https://lh4.googleusercontent.com/-zVLbX6nvZLY/UtFifqBENbI/AAAAAAAAD7c/r9PQuAd5g18/s500/color-lo43.png">
<img src="https://lh4.googleusercontent.com/-zVLbX6nvZLY/UtFifqBENbI/AAAAAAAAD7c/r9PQuAd5g18/s400/color-lo43.png" alt="https://lh4.googleusercontent.com/-zVLbX6nvZLY/UtFifqBENbI/AAAAAAAAD7c/r9PQuAd5g18/s400/color-lo43.png" />
</a>
</span>
<span class="image">
<a class="image" href="https://lh6.googleusercontent.com/-OQdaaTTH0Aw/UtFifrL-jTI/AAAAAAAAD7U/inr0Zx0lHmo/s500/color-word2007.png">
<img src="https://lh6.googleusercontent.com/-OQdaaTTH0Aw/UtFifrL-jTI/AAAAAAAAD7U/inr0Zx0lHmo/s400/color-word2007.png" alt="https://lh6.googleusercontent.com/-OQdaaTTH0Aw/UtFifrL-jTI/AAAAAAAAD7U/inr0Zx0lHmo/s400/color-word2007.png" />
</a>
</span>
<span class="image">
<a class="image" href="https://lh4.googleusercontent.com/-Yb2am1Vc65g/UtFigUF9fkI/AAAAAAAAD7w/nRZhF0iUYMA/s500/color-word2010.png">
<img src="https://lh4.googleusercontent.com/-Yb2am1Vc65g/UtFigUF9fkI/AAAAAAAAD7w/nRZhF0iUYMA/s400/color-word2010.png" alt="https://lh4.googleusercontent.com/-Yb2am1Vc65g/UtFigUF9fkI/AAAAAAAAD7w/nRZhF0iUYMA/s400/color-word2010.png" />
</a>
</span></p></div>
</div>
<div class="paragraph"><p>OK, this has four pictures: before, now, Word 2007 and Word2010. As you can see now we&#8217;re now on par with Word 2010. ;-)</p></div>
<div class="ulist"><ul>
<li>
<p>
document with textboxes inside a group shape
  (<a href="http://people.freedesktop.org/~vmiklos/2014/docx-drawingml/groupshape-textbox.docx">test doc</a>):
</p>
</li>
</ul></div>
<div align="center">
<div class="paragraph"><p><span class="image">
<a class="image" href="https://lh6.googleusercontent.com/-G4vltiHehvQ/UtFigLmY6fI/AAAAAAAAD8Q/I1iPtoh4hHE/s500/groupshape-textbox-lo42.png">
<img src="https://lh6.googleusercontent.com/-G4vltiHehvQ/UtFigLmY6fI/AAAAAAAAD8Q/I1iPtoh4hHE/s400/groupshape-textbox-lo42.png" alt="https://lh6.googleusercontent.com/-G4vltiHehvQ/UtFigLmY6fI/AAAAAAAAD8Q/I1iPtoh4hHE/s400/groupshape-textbox-lo42.png" />
</a>
</span>
<span class="image">
<a class="image" href="https://lh6.googleusercontent.com/-wncA0mX92hA/UtFighZK4HI/AAAAAAAAD70/pwB6tGwyPbk/s500/groupshape-textbox-lo43.png">
<img src="https://lh6.googleusercontent.com/-wncA0mX92hA/UtFighZK4HI/AAAAAAAAD70/pwB6tGwyPbk/s400/groupshape-textbox-lo43.png" alt="https://lh6.googleusercontent.com/-wncA0mX92hA/UtFighZK4HI/AAAAAAAAD70/pwB6tGwyPbk/s400/groupshape-textbox-lo43.png" />
</a>
</span>
<span class="image">
<a class="image" href="https://lh6.googleusercontent.com/-X3X_AXClLyw/UtFig15lsrI/AAAAAAAAD74/_YntDxB1pUk/s500/groupshape-textbox-word2010.png">
<img src="https://lh6.googleusercontent.com/-X3X_AXClLyw/UtFig15lsrI/AAAAAAAAD74/_YntDxB1pUk/s400/groupshape-textbox-word2010.png" alt="https://lh6.googleusercontent.com/-X3X_AXClLyw/UtFig15lsrI/AAAAAAAAD74/_YntDxB1pUk/s400/groupshape-textbox-word2010.png" />
</a>
</span></p></div>
</div>
<div class="ulist"><ul>
<li>
<p>
document with textbox, having a special
  <a href="http://api.libreoffice.org/docs/idl/ref/namespacecom_1_1sun_1_1star_1_1text_1_1RelOrientation.html">RelOrientation</a>
  (<a href="http://people.freedesktop.org/~vmiklos/2014/docx-drawingml/relorentation-textbox.docx">test doc</a>):
</p>
</li>
</ul></div>
<div align="center">
<div class="paragraph"><p><span class="image">
<a class="image" href="https://lh3.googleusercontent.com/-hpAhQ8Jd2R4/UtFihLad6RI/AAAAAAAAD8M/sgFpaLTRnAE/s800/relorientaton-textbox-lo42.png">
<img src="https://lh3.googleusercontent.com/-hpAhQ8Jd2R4/UtFihLad6RI/AAAAAAAAD8M/sgFpaLTRnAE/s400/relorientaton-textbox-lo42.png" alt="https://lh3.googleusercontent.com/-hpAhQ8Jd2R4/UtFihLad6RI/AAAAAAAAD8M/sgFpaLTRnAE/s400/relorientaton-textbox-lo42.png" />
</a>
</span>
<span class="image">
<a class="image" href="https://lh6.googleusercontent.com/-1Ca-ZW3ugKg/UtFihSSXf0I/AAAAAAAAD8I/lQt2qu7XDQA/s800/relorientaton-textbox-lo43.png">
<img src="https://lh6.googleusercontent.com/-1Ca-ZW3ugKg/UtFihSSXf0I/AAAAAAAAD8I/lQt2qu7XDQA/s400/relorientaton-textbox-lo43.png" alt="https://lh6.googleusercontent.com/-1Ca-ZW3ugKg/UtFihSSXf0I/AAAAAAAAD8I/lQt2qu7XDQA/s400/relorientaton-textbox-lo43.png" />
</a>
</span>
<span class="image">
<a class="image" href="https://lh6.googleusercontent.com/-LgNJNRlraq8/UtFikZ2L43I/AAAAAAAAD9I/VgOKGQt0o9M/s800/relorientaton-textbox-word2010.png">
<img src="https://lh6.googleusercontent.com/-LgNJNRlraq8/UtFikZ2L43I/AAAAAAAAD9I/VgOKGQt0o9M/s400/relorientaton-textbox-word2010.png" alt="https://lh6.googleusercontent.com/-LgNJNRlraq8/UtFikZ2L43I/AAAAAAAAD9I/VgOKGQt0o9M/s400/relorientaton-textbox-word2010.png" />
</a>
</span></p></div>
</div>
<div class="ulist"><ul>
<li>
<p>
document with a shape having a custom adjustment
  (<a href="http://people.freedesktop.org/~vmiklos/2014/docx-drawingml/shape-adj.docx">test doc</a>):
</p>
</li>
</ul></div>
<div align="center">
<div class="paragraph"><p><span class="image">
<a class="image" href="https://lh3.googleusercontent.com/-VeqomDNiRDg/UtFiiM9h93I/AAAAAAAAD8k/5iGiGUEan4s/s500/shape-adj-lo42.png">
<img src="https://lh3.googleusercontent.com/-VeqomDNiRDg/UtFiiM9h93I/AAAAAAAAD8k/5iGiGUEan4s/s400/shape-adj-lo42.png" alt="https://lh3.googleusercontent.com/-VeqomDNiRDg/UtFiiM9h93I/AAAAAAAAD8k/5iGiGUEan4s/s400/shape-adj-lo42.png" />
</a>
</span>
<span class="image">
<a class="image" href="https://lh6.googleusercontent.com/-Jd3N1X6jvcA/UtFiiTc_GWI/AAAAAAAAD8g/-ExLQkNqMfQ/s500/shape-adj-lo43.png">
<img src="https://lh6.googleusercontent.com/-Jd3N1X6jvcA/UtFiiTc_GWI/AAAAAAAAD8g/-ExLQkNqMfQ/s400/shape-adj-lo43.png" alt="https://lh6.googleusercontent.com/-Jd3N1X6jvcA/UtFiiTc_GWI/AAAAAAAAD8g/-ExLQkNqMfQ/s400/shape-adj-lo43.png" />
</a>
</span>
<span class="image">
<a class="image" href="https://lh4.googleusercontent.com/-aLbCIiyql48/UtFii62b47I/AAAAAAAAD8o/W0EDNoQtCl0/s500/shape-adj-word2010.png">
<img src="https://lh4.googleusercontent.com/-aLbCIiyql48/UtFii62b47I/AAAAAAAAD8o/W0EDNoQtCl0/s400/shape-adj-word2010.png" alt="https://lh4.googleusercontent.com/-aLbCIiyql48/UtFii62b47I/AAAAAAAAD8o/W0EDNoQtCl0/s400/shape-adj-word2010.png" />
</a>
</span></p></div>
</div>
<div class="ulist"><ul>
<li>
<p>
document with different colors
  (<a href="http://people.freedesktop.org/~vmiklos/2014/docx-drawingml/smiley.docx">test doc</a>):
</p>
</li>
</ul></div>
<div align="center">
<div class="paragraph"><p><span class="image">
<a class="image" href="https://lh6.googleusercontent.com/-HRRivr0f-a0/UtFijDe8cfI/AAAAAAAAD88/rnVTutXIE84/s500/smiley-lo42.png">
<img src="https://lh6.googleusercontent.com/-HRRivr0f-a0/UtFijDe8cfI/AAAAAAAAD88/rnVTutXIE84/s400/smiley-lo42.png" alt="https://lh6.googleusercontent.com/-HRRivr0f-a0/UtFijDe8cfI/AAAAAAAAD88/rnVTutXIE84/s400/smiley-lo42.png" />
</a>
</span>
<span class="image">
<a class="image" href="https://lh5.googleusercontent.com/-mITRnHUfrqA/UtFijZriQeI/AAAAAAAAD84/92BbOA8DRfk/s500/smiley-lo43.png">
<img src="https://lh5.googleusercontent.com/-mITRnHUfrqA/UtFijZriQeI/AAAAAAAAD84/92BbOA8DRfk/s400/smiley-lo43.png" alt="https://lh5.googleusercontent.com/-mITRnHUfrqA/UtFijZriQeI/AAAAAAAAD84/92BbOA8DRfk/s400/smiley-lo43.png" />
</a>
</span>
<span class="image">
<a class="image" href="https://lh6.googleusercontent.com/--_LhqgTxNM0/UtFij6NNYaI/AAAAAAAAD9A/5UFA4kEvBp0/s500/smiley-word2010.png">
<img src="https://lh6.googleusercontent.com/--_LhqgTxNM0/UtFij6NNYaI/AAAAAAAAD9A/5UFA4kEvBp0/s400/smiley-word2010.png" alt="https://lh6.googleusercontent.com/--_LhqgTxNM0/UtFij6NNYaI/AAAAAAAAD9A/5UFA4kEvBp0/s400/smiley-word2010.png" />
</a>
</span></p></div>
</div>
<div class="paragraph"><p>If you want to try these out yourself, get a
<a href="http://dev-builds.libreoffice.org/daily/">daily build</a> and play with it! If
something goes wrong, report it to us in the
<a href="https://www.libreoffice.org/get-help/bug/">Bugzilla</a>, so we can try fix it
before 4.3 gets branched off. Last, but not at least, thanks for
<a href="http://www.cloudon.com/">CloudOn</a> for funding these improvements! :-)</p></div>
</p><hr/></li>
<li><p>Sunday, 05 January 2014<br /><a href="/blog/lazacfogas-jemenben.html">Lazacfogás Jemenben</a>
(<a href="/blog/lazacfogas-jemenben.html#disqus_thread">Comments</a>)
</p><p><div class="imageblock" style="text-align:center;">
<div class="content">
<a class="image" href="https://lh6.googleusercontent.com/-dWoskrJMBM4/Uslkz7b9nRI/AAAAAAAAD6U/19qNEJQ6hn4/s624/">
<img src="https://lh6.googleusercontent.com/-dWoskrJMBM4/Uslkz7b9nRI/AAAAAAAAD6U/19qNEJQ6hn4/s400/" alt="https://lh6.googleusercontent.com/-dWoskrJMBM4/Uslkz7b9nRI/AAAAAAAAD6U/19qNEJQ6hn4/s400/" />
</a>
</div>
</div>
<div class="paragraph"><p>A szituáció abszurdságát tekintve akár "adathalászat Jemenben" is lehetett
volna a film címe, de a film végére a nézőt valóban érdekli, hogy a lazacok
úsznak-e felfelé. ;-)</p></div>
<div class="paragraph"><p>(<a href="http://www.imdb.com/title/tt1441952/">imdb</a>, <a href="http://www.youtube.com/watch?v=-wOF_7JMy5U">trailer</a>)</p></div>
</p><hr/></li>
<li><p>Saturday, 28 December 2013<br /><a href="/blog/libreoffice-draw-gedcom-import-filter.html">A LibreOffice Draw GEDCOM import filter</a>
(<a href="/blog/libreoffice-draw-gedcom-import-filter.html#disqus_thread">Comments</a>)
</p><p><div class="imageblock" style="text-align:center;">
<div class="content">
<a class="image" href="https://lh4.googleusercontent.com/-4110I0vkRE4/Ur8-uJ6YcII/AAAAAAAAD44/u1pNo4z1y-M/s1440/screenshot.png">
<img src="https://lh4.googleusercontent.com/-4110I0vkRE4/Ur8-uJ6YcII/AAAAAAAAD44/u1pNo4z1y-M/s400/screenshot.png" alt="https://lh4.googleusercontent.com/-4110I0vkRE4/Ur8-uJ6YcII/AAAAAAAAD44/u1pNo4z1y-M/s400/screenshot.png" />
</a>
</div>
</div>
<div class="paragraph"><p>You may remember that I wrote about my little
<a href="http://vmiklos.hu/blog/ged2dot.html">ged2dot project</a> about two months ago.
It&#8217;s a Python script that can be used from commandline with quite some
options. I&#8217;m happy to announce that there is a GUI for it now, in the form of
a LibreOffice Draw import filter. If you open
<a href="https://github.com/vmiklos/ged2dot/blob/master/test/screenshot.ged">this GEDCOM
file</a>, you&#8217;ll see something similar to the above image.  You can simply build
the <code>.oxt</code> from the <a href="https://github.com/vmiklos/ged2dot">Git repo</a>, or just get
it from the
<a href="http://extensions.libreoffice.org/extension-center/gedcom">LibreOffice
Extensions site</a>.</p></div>
<div class="paragraph"><p>Technical details for the interested readers: the import filter just glues
together existing pieces. First it runs <code>ged2dot</code>, then <code>dot</code> to generate an
SVG. To keep things simple, then the filter "inlineizes" all the included
images, finally the already existing SVG import filter does the real work. I
find it elegant that each step works from and to the memory, and not ugly
temporary files. :-) It works on Linux and Windows, feedback on if it works on
Mac is appreciated.</p></div>
<div class="paragraph"><p>Also, if you ask why this is an extension, not part of LibreOffice core: I
guess most users are not interested in building family trees; also being
someone who works on the core most of the time, I wanted to try out how
implementing an import filter as an extension (filter detection, import
options dialog, etc.) works. ;-)</p></div>
</p><hr/></li>
</ul></div>
<a href="/blog/archive.html">more &raquo;</a>
<script type="text/javascript">
var disqus_shortname = 'vmiklos';
(function () {
 var s = document.createElement('script'); s.async = true;
 s.src = 'http://disqus.com/forums/vmiklos/count.js';
 (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());
</script>

</div>
</div>
</div>
</div>
</body>
</html>
