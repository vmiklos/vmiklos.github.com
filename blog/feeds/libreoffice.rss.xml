<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"><channel><title>What is Miklos hacking - libreoffice</title><link>https://vmiklos.hu/blog/</link><description></description><lastBuildDate>Mon, 15 Apr 2019 09:13:19 +0200</lastBuildDate><item><title>btLr text direction in Writer, part 2</title><link>https://vmiklos.hu/blog/btlr-text-direction-in-writer-2.html</link><description>&lt;div id="preamble"&gt;
&lt;div class="sectionbody"&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;I already wrote about the &lt;a href="https://vmiklos.hu/blog/hackweek-2019.html"&gt;btLr text direction&lt;/a&gt; in the
context of Writer table cells as a result of a &lt;a href="https://www.collaboraoffice.com/"&gt;Collabora&lt;/a&gt; hack
week. This is meant to be an update to present what happened in the past 2 months. Here is a video
showing the results:&lt;/p&gt;&lt;/div&gt;
&lt;div class="imageblock" style="text-align:center;"&gt;
&lt;div class="content"&gt;
&lt;a class="image" href="https://youtu.be/79z9XDdH4x8"&gt;
&lt;img src="https://lh3.googleusercontent.com/RnesyNWGxQM4R255yFIVx_6_ft0Qu38rE10k22dblhzB8J5IG-W5RfNdncu_xtwYfXe-D7GtX7CJVKtspcQVflW2YiWm1EWf9ed3IqH4_bw-ElSKqE2OR4mRsCUcaJrSf61xy4Me_g=w640" alt="https://lh3.googleusercontent.com/RnesyNWGxQM4R255yFIVx_6_ft0Qu38rE10k22dblhzB8J5IG-W5RfNdncu_xtwYfXe-D7GtX7CJVKtspcQVflW2YiWm1EWf9ed3IqH4_bw-ElSKqE2OR4mRsCUcaJrSf61xy4Me_g=w640" /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;div class="title"&gt;Figure 1. Before / after screen recording for the below mentioned changes&lt;/div&gt;
&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;I fixed the following problems since the last blog post on this topic:&lt;/p&gt;&lt;/div&gt;
&lt;div class="olist arabic"&gt;&lt;ol class="arabic"&gt;
&lt;li&gt;
&lt;p&gt;
&lt;a href="http://cgit.freedesktop.org/libreoffice/core/commit/?id=31f896bb6ef922cf4250c6b971fb9d24a60592b5"&gt;sw
  btlr writing mode shell: fix up/down cursor travelling&lt;/a&gt;
&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;
&lt;a href="http://cgit.freedesktop.org/libreoffice/core/commit/?id=8ae5a98852c2f3d87d6efff598f0c7d54df835d3"&gt;sw
  btlr writing mode shell: left/right cursor travelling, fix dest para&lt;/a&gt;
&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;
&lt;a href="http://cgit.freedesktop.org/libreoffice/core/commit/?id=404bfc6f78549d16de193794960a9c9ab7604511"&gt;sw
  btlr writing mode shell: left/right cursor travelling, fix vert pos&lt;/a&gt;
&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;
&lt;a href="http://cgit.freedesktop.org/libreoffice/core/commit/?id=2f83055cdbd915d5036a7b4374b4ad10e6efc65f"&gt;sw
  btlr writing mode shell: fix cursor selection&lt;/a&gt;
&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;
&lt;a href="http://cgit.freedesktop.org/libreoffice/core/commit/?id=4c5d0e4822dcd0c6c9397a45e3afb66d53ebaafc"&gt;tdf#123943
  sw btlr writing mode render: fix text portion background&lt;/a&gt;
&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;
&lt;a href="http://cgit.freedesktop.org/libreoffice/core/commit/?id=89e5b431d468745da3a1eff14d48296107b9101b"&gt;sw
  btlr writing mode: implement DOC filter&lt;/a&gt;
&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;
&lt;a href="http://cgit.freedesktop.org/libreoffice/core/commit/?id=e651a4f45b310f9890ffbf712b9970d4c452ecec"&gt;tdf#124261
  sw btlr writing mode render: fix invalidation rectangle&lt;/a&gt;
&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;
&lt;a href="http://cgit.freedesktop.org/libreoffice/core/commit/?id=b62bfda66c1499806bfa35c26fdc05f76f8a4db2"&gt;sw
  btlr writing mode: implement RTF export&lt;/a&gt;
&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;All this is available in LibreOffice master (towards 6.3), so you can try it out right now, if
interested.&lt;/p&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Miklos Vajna</dc:creator><pubDate>Mon, 15 Apr 2019 09:13:19 +0200</pubDate><guid isPermaLink="false">tag:vmiklos.hu,2019-04-15:/blog/btlr-text-direction-in-writer-2.html</guid><category>en</category></item><item><title>SmartArt improvements in LibreOffice, part 4</title><link>https://vmiklos.hu/blog/smartart-improvements-4.html</link><description>&lt;div id="preamble"&gt;
&lt;div class="sectionbody"&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;I recently &lt;a href="https://vmiklos.hu/blog/smartart-improvements-3.html"&gt;dived into&lt;/a&gt; the SmartArt
support of LibreOffice, which is the component responsible for displaying
complex diagrams from PPTX. I focus on the case when only the document model
and the layout constraints are given, not a pre-rendered result.&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;First, thanks to our partner &lt;a href="https://www.suse.com/"&gt;SUSE&lt;/a&gt; for working with
&lt;a href="https://www.collaboraoffice.com/"&gt;Collabora&lt;/a&gt; to make this possible.&lt;/p&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="sect1"&gt;
&lt;h2 id="_organization_chart_cycle_matrix_and_picture_strip"&gt;Organization Chart, Cycle Matrix and Picture Strip&lt;/h2&gt;
&lt;div class="sectionbody"&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;In this post I would like to present the progress done earlier this year
regarding the above mentioned diagram types&amp;#8201;&amp;#8212;&amp;#8201;these are used in many
documents.&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;The improvement (as always) come in small incremental steps:&lt;/p&gt;&lt;/div&gt;
&lt;div class="ulist"&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;
Organization Chart is the most complex type I dealt with so far. I fixed
  several issues (font color, vertical ordering, multiple paragraphs in a data
  node, size of layout nodes, better support for &lt;code&gt;hierBranch&lt;/code&gt; conditions, the
  type of connector shapes). This allows giving readable result for diagrams
  which are more complex than the simple 3-node one presented in the previous
  post.
&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;
Cycle Matrix: there were missing child nodes here, the composite algorithm
  needed improved handling of position / size from constraints and the ordering
  / fill / line properties of actual content also needed fixing.
&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;
Picture Strip: the biggest problem here was the lack of pictures, but also
  the existing snake algorithm needed improvements (size, positioning, spacing
  and margins of the child shapes were not great).
&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;With all these fixed, we reach a much better state for the mentioned diagram
types.&lt;/p&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="sect1"&gt;
&lt;h2 id="_results_so_far"&gt;Results so far&lt;/h2&gt;
&lt;div class="sectionbody"&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;The SmartArt test documents from
&lt;a href="https://cgit.freedesktop.org/libreoffice/core/tree/sd/qa/unit/data/pptx/"&gt;sd/qa/unit/data/pptx/&lt;/a&gt;
is what I used for testing this work.&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;Here is how the baseline, the current and the reference rendering of Organization Chart looks like:&lt;/p&gt;&lt;/div&gt;
&lt;div style="text-align: center"&gt;
&lt;img src="https://lh3.googleusercontent.com/IFMh0QgOGTrqjFa9Hn0clhOg5tnLZDt-TZ4kTOT8lF3vPfqTiOu1GmnL0rKLS2MD0XKQ6dJAMm-T4h3BYY6Q4K7C6yVpQo5AQPZCAL4LI4q6Poo-J0bkZ3xM2Iq8WthdmTWxlinlRw=w640" style="max-width: 100%;"/&gt;
&lt;p&gt;smartart-org-chart.pptx, baseline&lt;/p&gt;
&lt;/div&gt;
&lt;div style="text-align: center"&gt;
&lt;img src="https://lh3.googleusercontent.com/m_01y4wA6IclexE7OD92JJnKf_jzC5j2VDXHlVr5BJ7qxzCk4QMdJkhcgiJbzVYp4i1KBsXdHdYS-EAj8-TlUpsSq4m1TZv6SWkTyVl_A4mMRjwOcX_IYFF3QXG7es_fK2RYWbbMYA=w640" style="max-width: 100%;"/&gt;
&lt;p&gt;smartart-org-chart.pptx, current&lt;/p&gt;
&lt;/div&gt;
&lt;div style="text-align: center"&gt;
&lt;img src="https://lh3.googleusercontent.com/PtXv5C_8nxo1uQb9CQe4tCgZbCga2CfFHMV-Xf6l_VQpRhf2psk_9mFFhC0sLjo-EjDS7-hUA7nu83OpaUQt8AOliX_1U0tuT83n0MdzbviySaLcBEiv7QvhHP4UC1P-ieGA7lTDcg=w640" style="max-width: 100%;"/&gt;
&lt;p&gt;smartart-org-chart.pptx, reference&lt;/p&gt;
&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;And here is how the baseline, the current and the reference rendering of Cycle Matrix looks like:&lt;/p&gt;&lt;/div&gt;
&lt;div style="text-align: center"&gt;
&lt;img src="https://lh3.googleusercontent.com/OLqkm14usMrgSbfvujD_xjcclNR5doYpIrTFWipe6bh7Sqa5JiklMpM2pf2LRJq_FH_noojtO5O1jwOdCDEr3ds0PLy370j4oe2vAqyOgTjZUlhoZDqKq1n6_ebYw-wbVyV_MzhLAA=w640" style="max-width: 100%;"/&gt;
&lt;p&gt;smartart-cycle-matrix.pptx, baseline&lt;/p&gt;
&lt;/div&gt;
&lt;div style="text-align: center"&gt;
&lt;img src="https://lh3.googleusercontent.com/dP3etlvuwYC7Gsz02eI2czJ7_2A7bwPjtCtvBnoVAGOZE1X-P8ePru1qntUFEGs8RicDx9vPgaS0M3n1-J1JsyxfdQhR1THqzLr4J6MEa2Dnvigb4jflVL9auckmgf1PobtjGnGInA=w640" style="max-width: 100%;"/&gt;
&lt;p&gt;smartart-cycle-matrix.pptx, current&lt;/p&gt;
&lt;/div&gt;
&lt;div style="text-align: center"&gt;
&lt;img src="https://lh3.googleusercontent.com/vT-wucpcp2sjK6DgYdcYGPx0LlucGb58N06pKczbjBepyS1dokrbs9LUMy6uLrN-AfW4xeXRTONB8asX7u2N7NN3ePag3qrqNtMKW6DOfQeTnRtA3E2n1U1B_-GyGJNP49_HOxBInQ=w640" style="max-width: 100%;"/&gt;
&lt;p&gt;smartart-cycle-matrix.pptx, reference&lt;/p&gt;
&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;And finally here is how the baseline, the current and the reference rendering of Picture Strip looks like:&lt;/p&gt;&lt;/div&gt;
&lt;div style="text-align: center"&gt;
&lt;img src="https://lh3.googleusercontent.com/pqGHTyFD78IDwCdHN6qOVH0MXYAouGmuUQ8GGBYEDeDN_bVV_74zJFcwXr1899NsOuqsEERiddYRdyTZurRh6JQXgvMyJSzlsyWI55cURmN6eod-sYxDbfZU9JxOBYH15kukUDB2cw=w640" style="max-width: 100%;"/&gt;
&lt;p&gt;smartart-picture-strip.pptx, baseline&lt;/p&gt;
&lt;/div&gt;
&lt;div style="text-align: center"&gt;
&lt;img src="https://lh3.googleusercontent.com/DeDJLYZkV3_GwcIATCNkurGNUyIVufbM8Q2OWw3uTQzK1BmIB8y_lWa1Zk_SG5RTYtts8SVjvJOD201p7Hf0MbzhMRrdleHAvUewXzQ7mxmtLfp_AP7hCKfSYAsXDExn-pW81268ng=w640" style="max-width: 100%;"/&gt;
&lt;p&gt;smartart-picture-strip.pptx, current&lt;/p&gt;
&lt;/div&gt;
&lt;div style="text-align: center"&gt;
&lt;img src="https://lh3.googleusercontent.com/BhTkpbMpIyFOwFTQUiKtA_g86yRjFKtMeP-lxMos5E4KHg7p7_YEAeJECD_6tuaBlSmU80M6I8HvOgIBMmNFkeXEyVxLp--RmEHTwtNw3ae3QK0Lju5fnD-TrUhVK39TVVwNL4BWZw=w640" style="max-width: 100%;"/&gt;
&lt;p&gt;smartart-picture-strip.pptx, reference&lt;/p&gt;
&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;This is not not perfect yet, but it&amp;#8217;s clearly a large improvement, all text is
now readable from the diagrams and pictures are no longer missing!&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;All this is available in master (towards LibreOffice 6.3), so you can grab a
&lt;a href="http://dev-builds.libreoffice.org/daily/master/"&gt;daily build&lt;/a&gt; and try it out
right now. :-)&lt;/p&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Miklos Vajna</dc:creator><pubDate>Fri, 22 Mar 2019 09:24:07 +0000</pubDate><guid isPermaLink="false">tag:vmiklos.hu,2019-03-22:/blog/smartart-improvements-4.html</guid><category>en</category></item><item><title>My hack week at Collabora: btLr text direction in Writer</title><link>https://vmiklos.hu/blog/hackweek-2019.html</link><description>&lt;div id="preamble"&gt;
&lt;div class="sectionbody"&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;As mentioned in my &lt;a href="https://vmiklos.hu/blog/hackweek-2016.html"&gt;previous&lt;/a&gt; such
report, a hack week is when we are allowed to hack on anything we want in
LibreOffice for a few days at &lt;a href="https://www.collaboraoffice.com/"&gt;Collabora&lt;/a&gt;. I
used this time to implement core support for the btLr text direction in
Writer.&lt;/p&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="sect1"&gt;
&lt;h2 id="_motivation"&gt;Motivation&lt;/h2&gt;
&lt;div class="sectionbody"&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;If you work with tables in Word, it&amp;#8217;s very easy to create this writing
direction: the context menu in a table cell has a menu item to set the
direction of the text, where you can rotate the text by 90 degrees
counter-clockwise or clockwise. The counter-clockwise btLr direction is the
problematic one. Support for tbRl was fine already, since that is needed
typically for Chinese/Japanese scripts as well.&lt;/p&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="sect1"&gt;
&lt;h2 id="_results_so_far"&gt;Results so far&lt;/h2&gt;
&lt;div class="sectionbody"&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;Here is how the baseline, the current and the reference rendering of btLr text looks like:&lt;/p&gt;&lt;/div&gt;
&lt;div class="imageblock" style="text-align:center;"&gt;
&lt;div class="content"&gt;
&lt;img src="https://lh3.googleusercontent.com/o5t6-JQeeNaZpx0YURMvS6xUJv7L4KbkbKnn6VPQ0yzULxHFI15ufkwaw_m0FVY7B2tv8gOnTw1CEY2Uxq6BFTgXHlcorXS52J8X1-mNjsyHKYDmoNG-MQ9X1LtdUWmrLl_W3b2ifQ=w640" alt="https://lh3.googleusercontent.com/o5t6-JQeeNaZpx0YURMvS6xUJv7L4KbkbKnn6VPQ0yzULxHFI15ufkwaw_m0FVY7B2tv8gOnTw1CEY2Uxq6BFTgXHlcorXS52J8X1-mNjsyHKYDmoNG-MQ9X1LtdUWmrLl_W3b2ifQ=w640" /&gt;
&lt;/div&gt;
&lt;div class="title"&gt;Figure 1. btlr-cell.docx, baseline&lt;/div&gt;
&lt;/div&gt;
&lt;div class="imageblock" style="text-align:center;"&gt;
&lt;div class="content"&gt;
&lt;img src="https://lh3.googleusercontent.com/Y8jXvq7TFyNoKVjwWd_QvJNJaOySZdKZE_HqqBaTwGoi_rExCee3eDAHx4AS49E7d7bcjG8SEgxnXOmdKFXaJx0MzmadungQ7D0SVqdSqC2trMC9InsHdKUTq1iwu5p8bDwUfIizng=w640" alt="https://lh3.googleusercontent.com/Y8jXvq7TFyNoKVjwWd_QvJNJaOySZdKZE_HqqBaTwGoi_rExCee3eDAHx4AS49E7d7bcjG8SEgxnXOmdKFXaJx0MzmadungQ7D0SVqdSqC2trMC9InsHdKUTq1iwu5p8bDwUfIizng=w640" /&gt;
&lt;/div&gt;
&lt;div class="title"&gt;Figure 2. btlr-cell.docx, current&lt;/div&gt;
&lt;/div&gt;
&lt;div class="imageblock" style="text-align:center;"&gt;
&lt;div class="content"&gt;
&lt;img src="https://lh3.googleusercontent.com/KYSBaOiAMdy_U8shsb4zoS8J5uyZzwkFPZY4qIKTrHKlo-M-pCdiHHBUxZ9OmQ-uv_QkBiktXeprTQD6gANDvzDVi8JWs4-Ng2RL-uoMcQCrQNL6Hk7tjXSJBaaqxc2skfZzmepkqA=w640" alt="https://lh3.googleusercontent.com/KYSBaOiAMdy_U8shsb4zoS8J5uyZzwkFPZY4qIKTrHKlo-M-pCdiHHBUxZ9OmQ-uv_QkBiktXeprTQD6gANDvzDVi8JWs4-Ng2RL-uoMcQCrQNL6Hk7tjXSJBaaqxc2skfZzmepkqA=w640" /&gt;
&lt;/div&gt;
&lt;div class="title"&gt;Figure 3. btlr-cell.docx, reference&lt;/div&gt;
&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;You can see how the second paragraph in the cell was missing from the rendered
result and now we basically pixel-by-pixel match the reference.&lt;/p&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="sect1"&gt;
&lt;h2 id="_how_is_this_implemented"&gt;How is this implemented?&lt;/h2&gt;
&lt;div class="sectionbody"&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;If you would like to know a bit more about how this works, continue reading&amp;#8230; :-)&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;The
&lt;a href="http://cgit.freedesktop.org/libreoffice/core/commit/?id=db346dde6179e7414289681d91b153a6ed259d05"&gt;document
model&lt;/a&gt; and
&lt;a href="http://cgit.freedesktop.org/libreoffice/core/commit/?id=052b5d375307245223e694bb835d86966c370d3b"&gt;UNO
API&lt;/a&gt; were reasonably straightforward to implement, but the layout was much
more challenging. Writer already supported 3 writing directions:&lt;/p&gt;&lt;/div&gt;
&lt;div class="ulist"&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;
typically used for Latin (left to right, top to bottom)
&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;
Chinese/Japanese (top to bottom, right to left)
&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;
Mongolian (top to bottom, left to right) text.
&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;This new one is also a vertical direction, also left to right, but bottom to
top. The
&lt;a href="http://cgit.freedesktop.org/libreoffice/core/commit/?id=e8b9572bf89f55463f2c879a401ed62efc165d95"&gt;initial
layout&lt;/a&gt; contained code to read the new enumerator from doc model, extend the
SwFrame class to handle this new bottom to top mode, some handling of
switching between horizontal/vertical mode and at the end mapping from Writer
layout&amp;#8217;s direction to VCL&amp;#8217;s "900" font orientation. There are more things to
handle in layout, but this was good enough to look at other areas as well.&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;The
&lt;a href="http://cgit.freedesktop.org/libreoffice/core/commit/?id=8af98ac8bf0ac8795999ecbf061d3c094f7c3be4"&gt;ODF
filter&lt;/a&gt; required updating, which was a bit challenging as it was necessary to
write different attribute names depending on which enumerator is used from an
emumeration, and we don&amp;#8217;t have good support for this. Once the filter code was
in place, I could write some
&lt;a href="http://cgit.freedesktop.org/libreoffice/core/commit/?id=bef3818dbedba467a257e2573e298d98062be37b"&gt;layout-level
tests&lt;/a&gt; as well.&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;Since we have .ui files for UI descriptions, adding
&lt;a href="http://cgit.freedesktop.org/libreoffice/core/commit/?id=081b753d4cb4f4a25073ca7de12a7bdaa9fc2be4"&gt;UI
support&lt;/a&gt; was really easy.&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;Time came to step away from coding for a moment and write up paperwork to
&lt;a href="https://issues.oasis-open.org/browse/OFFICE-4030"&gt;propose&lt;/a&gt; this feature to be
part of the next ODF version (thanks to Andras for the help there!).&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;Finally I went back to layout, and improved things a bit more: after
&lt;a href="http://cgit.freedesktop.org/libreoffice/core/commit/?id=a0bb480364c80192111ecab3501d63584e651ea3"&gt;fixing
baseline offsets&lt;/a&gt;, the positioning of the text was exactly matching what Word
does. How do I know? I used this little script:&lt;/p&gt;&lt;/div&gt;
&lt;div class="listingblock"&gt;
&lt;div class="content"&gt;
&lt;pre&gt;&lt;code&gt;gs -dNOPROMPT -dBATCH -sDEVICE=jpeg -r75 -dNOPAUSE -sOutputFile=btlr.jpg btlr.pdf
gs -dNOPROMPT -dBATCH -sDEVICE=jpeg -r75 -dNOPAUSE -sOutputFile=btlr-word.jpg btlr-word.pdf
composite -compose difference btlr-word.jpg btlr.jpg out.jpg&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;Which allows seeing the differences between our and Word&amp;#8217;s PDF output.
Additional work was needed to handle
&lt;a href="http://cgit.freedesktop.org/libreoffice/core/commit/?id=835d054434d0000a5741a5bfa5f577e855594c40"&gt;multiple
paragraphs&lt;/a&gt; in a table cell. At this stage I was happy enough with the
rendering result, so finally pulled the trigger and replaced the old DOCX
filter hack (using character-level rotation) with
&lt;a href="http://cgit.freedesktop.org/libreoffice/core/commit/?id=8fdbda18b593e7014e44a0fd590bbf98d83258b7"&gt;simple
DOCX filter mapping&lt;/a&gt; from OOXML&amp;#8217;s btLr direction to Writer&amp;#8217;s btLr direction&amp;#8201;&amp;#8212;&amp;#8201;i.e. what was already done for the tbRl case.&lt;/p&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="sect1"&gt;
&lt;h2 id="_future_work"&gt;Future work&lt;/h2&gt;
&lt;div class="sectionbody"&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;The feature works good enough already so that this new core feature can be
used by the DOCX filter by default, but there are still a few rough edges:&lt;/p&gt;&lt;/div&gt;
&lt;div class="ulist"&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;
the shell code (cursor travelling, selection painting, etc) only has
  &lt;a href="http://cgit.freedesktop.org/libreoffice/core/commit/?id=61bb90aac5038b5ff051668f7ae86eb61658e4f3"&gt;partial
  support&lt;/a&gt; for this new direction
&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;
RTF and DOC filters are not yet updated
&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;
the ODF proposal has a list of contexts other than table cells where the new
  writing direction could be used, which lack UI/filter support/etc at the moment.
&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;All this is available in master (towards LibreOffice 6.3), so you can grab a
&lt;a href="http://dev-builds.libreoffice.org/daily/master/"&gt;daily build&lt;/a&gt; and try it out
right now. :-)&lt;/p&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Miklos Vajna</dc:creator><pubDate>Thu, 21 Feb 2019 15:19:04 +0000</pubDate><guid isPermaLink="false">tag:vmiklos.hu,2019-02-21:/blog/hackweek-2019.html</guid><category>en</category></item><item><title>Improving SmartArt import in Impress FOSDEM talk</title><link>https://vmiklos.hu/blog/fosdem2019.html</link><description>&lt;div id="preamble"&gt;
&lt;div class="sectionbody"&gt;
&lt;div style="text-align: center; font-size: 0.6em"&gt;
&lt;img src="https://lh3.googleusercontent.com/bA1u6JMB7OZnPeRmSv2AqMFbAlrJ2vUtiRnZcS9RFT3ftsYuRbyIStd3c0-WvWwUlwuPz-oJRRpGaA09POJJk1S3rNZmsLEwslo06ZtY97R8W4Gp6sK1r0NcvYip2FBF7jsv-k_W8w=w640" style="max-width: 100%;"/&gt;
&lt;p&gt;(via &lt;a href="https://twitter.com/cor4office/status/1091720290424537088"&gt;cor4office&lt;/a&gt;)&lt;/p&gt;
&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;The next step in the recent &lt;a href="/blog/smartart-improvements-3.html"&gt;SmartArt
story&lt;/a&gt; is my
&lt;a href="https://fosdem.org/2019/schedule/event/improving_smartart_import_in_libreoffice_impress/"&gt;Improving
SmartArt import in Impress&lt;/a&gt; talk at FOSDEM 2019, in the
&lt;a href="https://fosdem.org/2019/schedule/track/open_document_editors/"&gt;Open Document
Editors devroom&lt;/a&gt;. The room was a bit far away from the popular places, but the
livestream worked out nicely.&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;There was also a
&lt;a href="https://wiki.documentfoundation.org/Events/2019/FOSDEM#Hackfest"&gt;hackfest&lt;/a&gt;
before the conference, I looked at
&lt;a href="https://bugs.documentfoundation.org/show_bug.cgi?id=116371#c20"&gt;RTF export of
rotated Writer pictures&lt;/a&gt;.&lt;/p&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Miklos Vajna</dc:creator><pubDate>Mon, 04 Feb 2019 10:00:37 +0000</pubDate><guid isPermaLink="false">tag:vmiklos.hu,2019-02-04:/blog/fosdem2019.html</guid><category>en</category></item><item><title>SmartArt improvements in LibreOffice, part 3</title><link>https://vmiklos.hu/blog/smartart-improvements-3.html</link><description>&lt;div id="preamble"&gt;
&lt;div class="sectionbody"&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;I recently &lt;a href="/blog/smartart-improvements-2.html"&gt;dived into&lt;/a&gt; the SmartArt
support of LibreOffice, which is the component responsible for displaying
complex diagrams from PPTX. I focus on the case when only the document model
and the layout constraints are given, not a pre-rendered result.&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;First, thanks to our partner &lt;a href="https://www.suse.com/"&gt;SUSE&lt;/a&gt; for working with
&lt;a href="https://www.collaboraoffice.com/"&gt;Collabora&lt;/a&gt; to make this possible.&lt;/p&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="sect1"&gt;
&lt;h2 id="_continuous_block_process_accent_process_and_organization_chart"&gt;Continuous Block Process, Accent Process and Organization Chart&lt;/h2&gt;
&lt;div class="sectionbody"&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;In this post I would like to present the progress done last month regarding
the above mentioned diagram types&amp;#8201;&amp;#8212;&amp;#8201;these are used in many documents.&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;The improvement (as always) come in small incremental steps:&lt;/p&gt;&lt;/div&gt;
&lt;div class="ulist"&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;
Continuous Block Process now reads space width from constraints.
&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;
Accent Process now has the missing bullets and fixes an incorrect large
  paragraph-level indent.
&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;
Organization Chart now has an initial implementation of the &lt;code&gt;hierRoot&lt;/code&gt; and
  &lt;code&gt;hierChild&lt;/code&gt; algorithms.
&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;
Organization Chart now handles multiple employees for a manager.
&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;With all these fixed, we reach a much better state for the mentioned diagram
types.&lt;/p&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="sect1"&gt;
&lt;h2 id="_results_so_far"&gt;Results so far&lt;/h2&gt;
&lt;div class="sectionbody"&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;The SmartArt test documents from &lt;a href="https://cgit.freedesktop.org/libreoffice/core/tree/sd/qa/unit/data/pptx/"&gt;sd/qa/unit/data/pptx/&lt;/a&gt; is what I used for testing this work.&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;Here is how the baseline, the current and the reference rendering of Accent Process looks like:&lt;/p&gt;&lt;/div&gt;
&lt;div style="text-align: center"&gt;
&lt;img src="https://lh3.googleusercontent.com/8CH3lhBMrhnNPvcptRvw0R0RUGIW5Jaeh1LxqnuTxcvWFg95OyrZqgAYl2YWMwTJbdyUeGrAB52K-WXu8mSfjPw2k-4NVb0lbXKpnTjtoBuIenqhlX70r8gP3AFuP6RDbgKEl7vPvQ=w640" style="max-width: 100%;"/&gt;
&lt;p&gt;smartart-accent-process.pptx, baseline&lt;/p&gt;
&lt;/div&gt;
&lt;div style="text-align: center"&gt;
&lt;img src="https://lh3.googleusercontent.com/i62jSfzKrCRQmv-EMEPx_ujXepB0qFzWtMOD8F_HIJzqxxHcsIH1fADQQr3eIsRjiJcyAdx95b4f3jckpzASk2Ifks7bAAWDqJQUJBGLWuDmXXrFHO5q769PEBw3UghmMoS_0ihHTA=w640" style="max-width: 100%;"/&gt;
&lt;p&gt;smartart-accent-process.pptx, current&lt;/p&gt;
&lt;/div&gt;
&lt;div style="text-align: center"&gt;
&lt;img src="https://lh3.googleusercontent.com/g9cJmO8PPcqOwgYN18uE6RdfFgq5fWi-bpGSOLOLFGYjEq_B0pLFPz_royCoHhz8_58L5GT71Xu62OtEj8IwLeNI631b_DqXHuSAWSEMbaF-ZU8XM4RykbUTE-egq1FhYE9b8p_Ejg=w640" style="max-width: 100%;"/&gt;
&lt;p&gt;smartart-accent-process.pptx, reference&lt;/p&gt;
&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;And here is how the baseline, the current and the reference rendering of Organization Chart looks like:&lt;/p&gt;&lt;/div&gt;
&lt;div style="text-align: center"&gt;
&lt;img src="https://lh3.googleusercontent.com/ze6x3LugJJBPjzEgJaWUVc_l3yiLtCQrcj_H_SN91YrYeR9f6E9Buzs6wrRp7T9mW4Mcho9jmVR3K0dItcGKiBK8ucs08YMkC9qW7kHQGCSE_m5fcEgK0z4srQnSUCJBD7NaYY-LWA=w640" style="max-width: 100%;"/&gt;
&lt;p&gt;smartart-org-chart.pptx, baseline&lt;/p&gt;
&lt;/div&gt;
&lt;div style="text-align: center"&gt;
&lt;img src="https://lh3.googleusercontent.com/fT_as5kTDmnbZQpO0MtV_VYu0LqfrRLSewvEkjl3K4nQ4VmFkWSGWJ7RjUjFJyXcOFqpl5fqEQjU7shiqHotkFIDPEJE5s70Ysdnscxf7oVJcV0R4qjpdePU4CnUN9_HxUdEfYjPlw=w640" style="max-width: 100%;"/&gt;
&lt;p&gt;smartart-org-chart.pptx, current&lt;/p&gt;
&lt;/div&gt;
&lt;div style="text-align: center"&gt;
&lt;img src="https://lh3.googleusercontent.com/Mdoqtf2-u4JISXJsKLp1tLQXnxDDvDg1vPOI5bNpOnAjhM02og80Lz6BnBzA-YkdlT__9lfU-pxFqUOzKpL9ySyJK9EmXnV6ipG5x6SmJTYY92KSzr_0e9qbp5pmZERiBSeBTPbVqg=w640" style="max-width: 100%;"/&gt;
&lt;p&gt;smartart-org-chart.pptx, reference&lt;/p&gt;
&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;This is not not perfect yet, but it&amp;#8217;s clearly a large improvement, all text is
now readable from the diagrams and bullets are no longer missing!&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;All this is available in master (towards LibreOffice 6.3), so you can grab a
&lt;a href="http://dev-builds.libreoffice.org/daily/master/"&gt;daily build&lt;/a&gt; and try it out
right now. :-)&lt;/p&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Miklos Vajna</dc:creator><pubDate>Fri, 04 Jan 2019 14:35:29 +0000</pubDate><guid isPermaLink="false">tag:vmiklos.hu,2019-01-04:/blog/smartart-improvements-3.html</guid><category>en</category></item><item><title>SmartArt improvements in LibreOffice, part 2</title><link>https://vmiklos.hu/blog/smartart-improvements-2.html</link><description>&lt;div id="preamble"&gt;
&lt;div class="sectionbody"&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;I recently &lt;a href="/blog/smartart-improvements.html"&gt;dived into&lt;/a&gt; the SmartArt
support of LibreOffice, which is the component responsible for displaying
complex diagrams from PPTX. I focused especially on the case when only
document model and the layout constraints are given, not a pre-rendered
result.&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;First, thanks to our partner &lt;a href="https://www.suse.com/"&gt;SUSE&lt;/a&gt; for working with
&lt;a href="https://www.collaboraoffice.com/"&gt;Collabora&lt;/a&gt; to make this possible.&lt;/p&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="sect1"&gt;
&lt;h2 id="_accent_process"&gt;Accent Process&lt;/h2&gt;
&lt;div class="sectionbody"&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;In this post I would like to present the progress regarding the Accent Process
preset, available in PowerPoint&amp;#8201;&amp;#8212;&amp;#8201;which is used in many documents.&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;This exposed several shortcomings of the current diagram layout we have in LibreOffice:&lt;/p&gt;&lt;/div&gt;
&lt;div class="ulist"&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;
Values are not read from constraints (there was a reason for this, they can
  be complex, given that depending on the context, the unit is points or
  millimeters and the unit is always implicit).
&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;
ZOrder offsets were ignored.
&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;
Linear algorithm did not take size from constraints when it came to
  recursing into child algorithms.
&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;
Data point assumed that all text for it is a single "run" (i.e. either all
  text is bold or nothing, not half of it).
&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;
&lt;code&gt;followSib&lt;/code&gt; axis was not implemented for &lt;code&gt;forEach&lt;/code&gt;, so when you have arrow
  shapes between objects, we created &lt;code&gt;N&lt;/code&gt; arrows, not &lt;code&gt;N - 1&lt;/code&gt; ones.
&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;
Connectors were created as invisible shapes and had the wrong width/height
  aspect.
&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;With all these fixed, we reach a much better state for handling accent
process.&lt;/p&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="sect1"&gt;
&lt;h2 id="_results_so_far"&gt;Results so far&lt;/h2&gt;
&lt;div class="sectionbody"&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;&lt;a href="https://cgit.freedesktop.org/libreoffice/core/tree/sd/qa/unit/data/pptx/smartart-accent-process.pptx"&gt;smartart-accent-process.pptx&lt;/a&gt;
is what I used for testing of this work.&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;Here is how the baseline, the current and the reference rendering of the test documents look like:&lt;/p&gt;&lt;/div&gt;
&lt;div style="text-align: center"&gt;
&lt;img src="https://lh3.googleusercontent.com/e4uMwQRLHPsvVTwvnnwkyEIMmE0L-Piv55XreEW9wmA3y29348TWxgUbaCkYGBz-yXf8D55rhEC6Y3-kAp6BbLxNadWQfcxuUB57Z8dXFYPmlw8kjTPcOXNpqeZFKyBvtPiI7eSBhQ=w2400" style="max-width: 100%;"/&gt;
&lt;p&gt;smartart-accent-process.pptx, baseline&lt;/p&gt;
&lt;/div&gt;
&lt;div style="text-align: center"&gt;
&lt;img src="https://lh3.googleusercontent.com/12c8vCrucm23guXlwYvj51MwAYOsePn7znwKBPq9qFzlgPx9XUTyX0wDcUgb0PR9tFVyTKoZPNXkhEur5Nqp7aosUCDuTVXE6yNj-58x3yLudJdqOnionMab6L-5wZ0rLvn1-bg5zA=w2400" style="max-width: 100%;"/&gt;
&lt;p&gt;smartart-accent-process.pptx, current&lt;/p&gt;
&lt;/div&gt;
&lt;div style="text-align: center"&gt;
&lt;img src="https://lh3.googleusercontent.com/FBDUqsXyyBI6-abopLSrzHEYbm4YHHZwxFWxnfUsTO0dwl17HdP6sBcKzW_BvTjMWiRuPX6HC1I7aEOcHzeiZBzE-EnJZ_3fkfaOzxDHtiIc0QoFe9T4V9K3jq9_yRkNELx2tEQYpA=w2400" style="max-width: 100%;"/&gt;
&lt;p&gt;smartart-accent-process.pptx, reference&lt;/p&gt;
&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;This is not not perfect yet, but it&amp;#8217;s clearly a large improvement, all text is
now readable from the diagram!&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;All this is available in master (towards LibreOffice 6.3), so you can grab a
&lt;a href="http://dev-builds.libreoffice.org/daily/master/"&gt;daily build&lt;/a&gt; and try it out
right now. :-)&lt;/p&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Miklos Vajna</dc:creator><pubDate>Tue, 04 Dec 2018 13:00:19 +0000</pubDate><guid isPermaLink="false">tag:vmiklos.hu,2018-12-04:/blog/smartart-improvements-2.html</guid><category>en</category></item><item><title>SmartArt improvements in LibreOffice</title><link>https://vmiklos.hu/blog/smartart-improvements.html</link><description>&lt;div id="preamble"&gt;
&lt;div class="sectionbody"&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;I recently dived into the SmartArt support of LibreOffice, which is the
component responsible for displaying complex diagrams from PPTX, especially in
case only document model and the layout constraints are given, not a
pre-rendered result.&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;First, thanks to our partner &lt;a href="https://www.suse.com/"&gt;SUSE&lt;/a&gt; for working with
&lt;a href="https://www.collaboraoffice.com/"&gt;Collabora&lt;/a&gt; to make this possible.&lt;/p&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="sect1"&gt;
&lt;h2 id="_the_problem"&gt;The problem&lt;/h2&gt;
&lt;div class="sectionbody"&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;There are several ones. :-) If you are just interested in high quality viewing
of PPTX files, then your problem started with PowerPoint 2007 not writing a
pre-rendered drawingML markup of the diagram to the files, only PowerPoint
2010 started behaving like this. Additionally, if a diagram is not edited,
then re-saving with PowerPoint 2010 doesn&amp;#8217;t seem to generate the drawingML
markup, either. This means that data + constraints cases are quite frequent
even today.&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;Also, one day Impress should be able to actually edit these SmartArts as well,
so having the knowledge how to lay out SmartArt (even if it&amp;#8217;s import-time-only
at the moment) is a good thing.&lt;/p&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="sect1"&gt;
&lt;h2 id="_results_so_far"&gt;Results so far&lt;/h2&gt;
&lt;div class="sectionbody"&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;I always write cppunit tests when I work on filter code (in this case OOXML), so
far all fixes were visible in just two test files:
&lt;a href="https://cgit.freedesktop.org/libreoffice/core/tree/sd/qa/unit/data/pptx/smartart-vertial-box-list.pptx"&gt;smartart-vertial-box-list.pptx&lt;/a&gt;
and
&lt;a href="https://cgit.freedesktop.org/libreoffice/core/tree/sd/qa/unit/data/pptx/vertical-bracket-list.pptx"&gt;vertical-bracket-list.pptx&lt;/a&gt;.&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;Here is how the baseline, the current and the reference rendering of these test documents look like:&lt;/p&gt;&lt;/div&gt;
&lt;div style="text-align: center"&gt;
&lt;img src="https://farm2.staticflickr.com/1924/45683201352_52e22af9dc_z.jpg"/&gt;
&lt;p&gt;smartart-vertial-box-list.pptx, baseline&lt;/p&gt;
&lt;/div&gt;
&lt;div style="text-align: center"&gt;
&lt;img src="https://farm5.staticflickr.com/4912/45683200942_8005cd433d_z.jpg"/&gt;
&lt;p&gt;smartart-vertial-box-list.pptx, current&lt;/p&gt;
&lt;/div&gt;
&lt;div style="text-align: center"&gt;
&lt;img src="https://farm2.staticflickr.com/1976/45683201252_edd6eddea4_z.jpg"/&gt;
&lt;p&gt;smartart-vertial-box-list.pptx, reference&lt;/p&gt;
&lt;/div&gt;
&lt;div style="text-align: center"&gt;
&lt;img src="https://farm2.staticflickr.com/1951/45683201002_4c93cc831c_z.jpg"/&gt;
&lt;p&gt;vertical-bracket-list.pptx, baseline&lt;/p&gt;
&lt;/div&gt;
&lt;div style="text-align: center"&gt;
&lt;img src="https://farm5.staticflickr.com/4876/45008491984_61f25e21ca_z.jpg"/&gt;
&lt;p&gt;vertical-bracket-list.pptx, current&lt;/p&gt;
&lt;/div&gt;
&lt;div style="text-align: center"&gt;
&lt;img src="https://farm2.staticflickr.com/1911/45683201082_3022aa8fe5_z.jpg"/&gt;
&lt;p&gt;vertical-bracket-list.pptx, reference&lt;/p&gt;
&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;In terms of code commits, the fixes are split into several ones:&lt;/p&gt;&lt;/div&gt;
&lt;div class="ulist"&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;
&lt;a href="http://cgit.freedesktop.org/libreoffice/core/commit/?id=e49c42d17f50c8b0cac9db08dedc375dd5aa8a98"&gt;oox
  smartart, vertical bracket list: fix node counter condition&lt;/a&gt;
&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;
&lt;a href="http://cgit.freedesktop.org/libreoffice/core/commit/?id=397b64afc62a5632a6648598558a4d2c3ca0d283"&gt;oox
  smartart, linear layout: take horizontal position from constraints&lt;/a&gt;
&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;
&lt;a href="http://cgit.freedesktop.org/libreoffice/core/commit/?id=b083b0808121d19f398a9f6ead195ae7e14ed047"&gt;oox
  smartart, linear layout: take width from constraints&lt;/a&gt;
&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;
&lt;a href="http://cgit.freedesktop.org/libreoffice/core/commit/?id=923061d17d4b5b8bf0d4a8111b270c99a7c649a9"&gt;oox
  smartart: work towards accessing parent constraints&lt;/a&gt;
&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;
&lt;a href="http://cgit.freedesktop.org/libreoffice/core/commit/?id=b61d2784271bf8b042642c378f50e8b446682548"&gt;oox
  smartart: fix width of shapes with agl=lin, linDir=fromT&lt;/a&gt;
&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;
&lt;a href="http://cgit.freedesktop.org/libreoffice/core/commit/?id=a7e86beb00e9635ea4556ef4f8f8e24ff9965391"&gt;oox:
  ignore SmartArt "fallback" with empty shape list&lt;/a&gt;
&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;Clearly the results are not perfect yet, but in both cases nothing was
visible, and now all text is readable, so we&amp;#8217;re moving in the right direction!&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;All this is available in master (towards LibreOffice 6.2), so you can grab a
&lt;a href="http://dev-builds.libreoffice.org/daily/master/"&gt;daily build&lt;/a&gt; and try it out
right now. :-)&lt;/p&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Miklos Vajna</dc:creator><pubDate>Mon, 05 Nov 2018 16:35:25 +0000</pubDate><guid isPermaLink="false">tag:vmiklos.hu,2018-11-05:/blog/smartart-improvements.html</guid><category>en</category></item><item><title>Text layout performance in LibreOffice conference lightning talk</title><link>https://vmiklos.hu/blog/libocon2018-lightning.html</link><description>&lt;div id="preamble"&gt;
&lt;div class="sectionbody"&gt;
&lt;div class="imageblock" style="text-align:center;"&gt;
&lt;div class="content"&gt;
&lt;a class="image" href="https://speakerd.s3.amazonaws.com/presentations/6d1f7938f02f40da9a04bd2ce24b0940/vcllayout-locon-tirana-2k19.pdf"&gt;
&lt;img src="https://farm2.staticflickr.com/1914/44115509595_ab58bf01f5_z.jpg" alt="https://farm2.staticflickr.com/1914/44115509595_ab58bf01f5_z.jpg" /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;Last Friday I gave a
&lt;a href="https://conference.libreoffice.org/2018/the-program/sept-18th-friday/"&gt;Text
layout performance&lt;/a&gt; lightning talk at LibreOffice Conference 2018. Click on
the image to get the hybrid PDF slides!&lt;/p&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Miklos Vajna</dc:creator><pubDate>Mon, 01 Oct 2018 10:26:56 +0000</pubDate><guid isPermaLink="false">tag:vmiklos.hu,2018-10-01:/blog/libocon2018-lightning.html</guid><category>en</category></item><item><title>ReqIF import/export in LibreOffice Writer conference talk</title><link>https://vmiklos.hu/blog/libocon2018.html</link><description>&lt;div id="preamble"&gt;
&lt;div class="sectionbody"&gt;
&lt;div class="imageblock" style="text-align:center;"&gt;
&lt;div class="content"&gt;
&lt;a class="image" href="https://speakerd.s3.amazonaws.com/presentations/a33d7c215e7f493ab1711c614413f6db/reqif-locon-tirana-2k19.pdf"&gt;
&lt;img src="https://farm2.staticflickr.com/1939/44246333744_a805435168_z.jpg" alt="https://farm2.staticflickr.com/1939/44246333744_a805435168_z.jpg" /&gt;
&lt;/a&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;Earlier today I gave an
&lt;a href="https://conference.libreoffice.org/2018/the-program/sept-18th-friday/"&gt;Editing
ReqIF-XHTML fragments with Writer&lt;/a&gt; talk at LibreOffice Conference 2018. The
room was well-crowded&amp;#8201;&amp;#8212;&amp;#8201;perhaps because the previous talk was about OOXML
interoperability. ;-)&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;I expect quite some other slides will be available on
&lt;a href="http://planet.documentfoundation.org/"&gt;Planet&lt;/a&gt;, don&amp;#8217;t miss them.&lt;/p&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Miklos Vajna</dc:creator><pubDate>Fri, 28 Sep 2018 12:26:01 +0000</pubDate><guid isPermaLink="false">tag:vmiklos.hu,2018-09-28:/blog/libocon2018.html</guid><category>en</category></item><item><title>API improvements in LibreOffice</title><link>https://vmiklos.hu/blog/uno-api-improvements.html</link><description>&lt;div id="preamble"&gt;
&lt;div class="sectionbody"&gt;
&lt;div class="imageblock" style="text-align:center;"&gt;
&lt;div class="content"&gt;
&lt;img src="https://farm2.staticflickr.com/1793/43859007612_ca207fed0f_o.png" alt="https://farm2.staticflickr.com/1793/43859007612_ca207fed0f_o.png" /&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;I worked on two small features to extend the public (UNO) API of LibreOffice.
First, thanks to &lt;a href="https://vector.com/"&gt;Vector&lt;/a&gt; for funding
&lt;a href="https://www.collaboraoffice.com/"&gt;Collabora&lt;/a&gt; to make this possible.&lt;/p&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="sect1"&gt;
&lt;h2 id="_aliased_paths_and_text_in_the_png_export_for_draw"&gt;Aliased paths and text in the PNG export for Draw&lt;/h2&gt;
&lt;div class="sectionbody"&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;The UNO API of Draw allows you to build quite complex and custom shapes, but
you may want to export the rendered result to a bitmap for testing purposes,
so you can assert that the actual result matches a reference one.&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;One problem in this area is anti-aliasing, which can easily differ between
machines. Given that normally aliased rendering is ugly, there is now a way to
enable AA, but disable it just during a single invocation of the PNG exporter.&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;The above picture shows how the AA result looks like. You could write a Basic
macro like this to trigger the PNG export from Draw:&lt;/p&gt;&lt;/div&gt;
&lt;div class="listingblock"&gt;
&lt;div class="content"&gt;&lt;!-- Generator: GNU source-highlight
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite --&gt;
&lt;pre&gt;&lt;tt&gt;xExporter &lt;span style="color: #990000"&gt;=&lt;/span&gt; &lt;span style="font-weight: bold"&gt;&lt;span style="color: #000000"&gt;createUnoService&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #990000"&gt;(&lt;/span&gt;&lt;span style="color: #FF0000"&gt;"com.sun.star.drawing.GraphicExportFilter"&lt;/span&gt;&lt;span style="color: #990000"&gt;)&lt;/span&gt;
xExporter&lt;span style="color: #990000"&gt;.&lt;/span&gt;&lt;span style="font-weight: bold"&gt;&lt;span style="color: #000000"&gt;SetSourceDocument&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #990000"&gt;(&lt;/span&gt;ThisComponent&lt;span style="color: #990000"&gt;.&lt;/span&gt;&lt;span style="font-weight: bold"&gt;&lt;span style="color: #000000"&gt;DrawPages&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #990000"&gt;(&lt;/span&gt;&lt;span style="color: #993399"&gt;0&lt;/span&gt;&lt;span style="color: #990000"&gt;))&lt;/span&gt;
&lt;span style="font-weight: bold"&gt;&lt;span style="color: #0000FF"&gt;Dim&lt;/span&gt;&lt;/span&gt; &lt;span style="font-weight: bold"&gt;&lt;span style="color: #000000"&gt;aArgs&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #990000"&gt;(&lt;/span&gt;&lt;span style="color: #993399"&gt;1&lt;/span&gt;&lt;span style="color: #990000"&gt;)&lt;/span&gt; As new com&lt;span style="color: #990000"&gt;.&lt;/span&gt;sun&lt;span style="color: #990000"&gt;.&lt;/span&gt;star&lt;span style="color: #990000"&gt;.&lt;/span&gt;beans&lt;span style="color: #990000"&gt;.&lt;/span&gt;PropertyValue
&lt;span style="font-weight: bold"&gt;&lt;span style="color: #000000"&gt;aArgs&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #990000"&gt;(&lt;/span&gt;&lt;span style="color: #993399"&gt;0&lt;/span&gt;&lt;span style="color: #990000"&gt;).&lt;/span&gt;Name  &lt;span style="color: #990000"&gt;=&lt;/span&gt; &lt;span style="color: #FF0000"&gt;"URL"&lt;/span&gt;
&lt;span style="font-weight: bold"&gt;&lt;span style="color: #000000"&gt;aArgs&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #990000"&gt;(&lt;/span&gt;&lt;span style="color: #993399"&gt;0&lt;/span&gt;&lt;span style="color: #990000"&gt;).&lt;/span&gt;Value &lt;span style="color: #990000"&gt;=&lt;/span&gt; &lt;span style="color: #FF0000"&gt;"file:///tmp/debug/aa.png"&lt;/span&gt;
&lt;span style="font-weight: bold"&gt;&lt;span style="color: #000000"&gt;aArgs&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #990000"&gt;(&lt;/span&gt;&lt;span style="color: #993399"&gt;1&lt;/span&gt;&lt;span style="color: #990000"&gt;).&lt;/span&gt;Name  &lt;span style="color: #990000"&gt;=&lt;/span&gt; &lt;span style="color: #FF0000"&gt;"MediaType"&lt;/span&gt;
&lt;span style="font-weight: bold"&gt;&lt;span style="color: #000000"&gt;aArgs&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #990000"&gt;(&lt;/span&gt;&lt;span style="color: #993399"&gt;1&lt;/span&gt;&lt;span style="color: #990000"&gt;).&lt;/span&gt;Value &lt;span style="color: #990000"&gt;=&lt;/span&gt; &lt;span style="color: #FF0000"&gt;"image/png"&lt;/span&gt;
xExporter&lt;span style="color: #990000"&gt;.&lt;/span&gt;&lt;span style="font-weight: bold"&gt;&lt;span style="color: #000000"&gt;filter&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #990000"&gt;(&lt;/span&gt;&lt;span style="font-weight: bold"&gt;&lt;span style="color: #000000"&gt;aArgs&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #990000"&gt;())&lt;/span&gt;&lt;/tt&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;Let&amp;#8217;s see how it looks like if you turn AA off:&lt;/p&gt;&lt;/div&gt;
&lt;div class="imageblock" style="text-align:center;"&gt;
&lt;div class="content"&gt;
&lt;img src="https://farm2.staticflickr.com/1832/43859007522_aeb4516f02_o.png" alt="https://farm2.staticflickr.com/1832/43859007522_aeb4516f02_o.png" /&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;You just need to specify a new &lt;code&gt;Antialiasing&lt;/code&gt; key under &lt;code&gt;FilterData&lt;/code&gt;:&lt;/p&gt;&lt;/div&gt;
&lt;div class="listingblock"&gt;
&lt;div class="content"&gt;&lt;!-- Generator: GNU source-highlight
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite --&gt;
&lt;pre&gt;&lt;tt&gt;&lt;span style="font-weight: bold"&gt;&lt;span style="color: #0000FF"&gt;Dim&lt;/span&gt;&lt;/span&gt; &lt;span style="font-weight: bold"&gt;&lt;span style="color: #000000"&gt;aFilterData&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #990000"&gt;(&lt;/span&gt;&lt;span style="color: #993399"&gt;0&lt;/span&gt;&lt;span style="color: #990000"&gt;)&lt;/span&gt; As new com&lt;span style="color: #990000"&gt;.&lt;/span&gt;sun&lt;span style="color: #990000"&gt;.&lt;/span&gt;star&lt;span style="color: #990000"&gt;.&lt;/span&gt;beans&lt;span style="color: #990000"&gt;.&lt;/span&gt;PropertyValue
&lt;span style="font-weight: bold"&gt;&lt;span style="color: #000000"&gt;aFilterData&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #990000"&gt;(&lt;/span&gt;&lt;span style="color: #993399"&gt;0&lt;/span&gt;&lt;span style="color: #990000"&gt;).&lt;/span&gt;Name &lt;span style="color: #990000"&gt;=&lt;/span&gt; &lt;span style="color: #FF0000"&gt;"AntiAliasing"&lt;/span&gt;
&lt;span style="font-weight: bold"&gt;&lt;span style="color: #000000"&gt;aFilterData&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #990000"&gt;(&lt;/span&gt;&lt;span style="color: #993399"&gt;0&lt;/span&gt;&lt;span style="color: #990000"&gt;).&lt;/span&gt;Value &lt;span style="color: #990000"&gt;=&lt;/span&gt; &lt;span style="font-weight: bold"&gt;&lt;span style="color: #0000FF"&gt;False&lt;/span&gt;&lt;/span&gt;
xExporter &lt;span style="color: #990000"&gt;=&lt;/span&gt; &lt;span style="font-weight: bold"&gt;&lt;span style="color: #000000"&gt;createUnoService&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #990000"&gt;(&lt;/span&gt;&lt;span style="color: #FF0000"&gt;"com.sun.star.drawing.GraphicExportFilter"&lt;/span&gt;&lt;span style="color: #990000"&gt;)&lt;/span&gt;
xExporter&lt;span style="color: #990000"&gt;.&lt;/span&gt;&lt;span style="font-weight: bold"&gt;&lt;span style="color: #000000"&gt;SetSourceDocument&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #990000"&gt;(&lt;/span&gt;ThisComponent&lt;span style="color: #990000"&gt;.&lt;/span&gt;&lt;span style="font-weight: bold"&gt;&lt;span style="color: #000000"&gt;DrawPages&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #990000"&gt;(&lt;/span&gt;&lt;span style="color: #993399"&gt;0&lt;/span&gt;&lt;span style="color: #990000"&gt;))&lt;/span&gt;
&lt;span style="font-weight: bold"&gt;&lt;span style="color: #0000FF"&gt;Dim&lt;/span&gt;&lt;/span&gt; &lt;span style="font-weight: bold"&gt;&lt;span style="color: #000000"&gt;aArgs&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #990000"&gt;(&lt;/span&gt;&lt;span style="color: #993399"&gt;2&lt;/span&gt;&lt;span style="color: #990000"&gt;)&lt;/span&gt; As new com&lt;span style="color: #990000"&gt;.&lt;/span&gt;sun&lt;span style="color: #990000"&gt;.&lt;/span&gt;star&lt;span style="color: #990000"&gt;.&lt;/span&gt;beans&lt;span style="color: #990000"&gt;.&lt;/span&gt;PropertyValue
&lt;span style="font-weight: bold"&gt;&lt;span style="color: #000000"&gt;aArgs&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #990000"&gt;(&lt;/span&gt;&lt;span style="color: #993399"&gt;0&lt;/span&gt;&lt;span style="color: #990000"&gt;).&lt;/span&gt;Name  &lt;span style="color: #990000"&gt;=&lt;/span&gt; &lt;span style="color: #FF0000"&gt;"URL"&lt;/span&gt;
&lt;span style="font-weight: bold"&gt;&lt;span style="color: #000000"&gt;aArgs&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #990000"&gt;(&lt;/span&gt;&lt;span style="color: #993399"&gt;0&lt;/span&gt;&lt;span style="color: #990000"&gt;).&lt;/span&gt;Value &lt;span style="color: #990000"&gt;=&lt;/span&gt; &lt;span style="color: #FF0000"&gt;"file:///tmp/debug/non-aa.png"&lt;/span&gt;
&lt;span style="font-weight: bold"&gt;&lt;span style="color: #000000"&gt;aArgs&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #990000"&gt;(&lt;/span&gt;&lt;span style="color: #993399"&gt;1&lt;/span&gt;&lt;span style="color: #990000"&gt;).&lt;/span&gt;Name  &lt;span style="color: #990000"&gt;=&lt;/span&gt; &lt;span style="color: #FF0000"&gt;"FilterData"&lt;/span&gt;
&lt;span style="font-weight: bold"&gt;&lt;span style="color: #000000"&gt;aArgs&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #990000"&gt;(&lt;/span&gt;&lt;span style="color: #993399"&gt;1&lt;/span&gt;&lt;span style="color: #990000"&gt;).&lt;/span&gt;Value &lt;span style="color: #990000"&gt;=&lt;/span&gt; &lt;span style="font-weight: bold"&gt;&lt;span style="color: #000000"&gt;aFilterData&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #990000"&gt;()&lt;/span&gt;
&lt;span style="font-weight: bold"&gt;&lt;span style="color: #000000"&gt;aArgs&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #990000"&gt;(&lt;/span&gt;&lt;span style="color: #993399"&gt;2&lt;/span&gt;&lt;span style="color: #990000"&gt;).&lt;/span&gt;Name  &lt;span style="color: #990000"&gt;=&lt;/span&gt; &lt;span style="color: #FF0000"&gt;"MediaType"&lt;/span&gt;
&lt;span style="font-weight: bold"&gt;&lt;span style="color: #000000"&gt;aArgs&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #990000"&gt;(&lt;/span&gt;&lt;span style="color: #993399"&gt;2&lt;/span&gt;&lt;span style="color: #990000"&gt;).&lt;/span&gt;Value &lt;span style="color: #990000"&gt;=&lt;/span&gt; &lt;span style="color: #FF0000"&gt;"image/png"&lt;/span&gt;
xExporter&lt;span style="color: #990000"&gt;.&lt;/span&gt;&lt;span style="font-weight: bold"&gt;&lt;span style="color: #000000"&gt;filter&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #990000"&gt;(&lt;/span&gt;&lt;span style="font-weight: bold"&gt;&lt;span style="color: #000000"&gt;aArgs&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #990000"&gt;())&lt;/span&gt;&lt;/tt&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;You can imagine which rendering result is easier to debug when the reference
and the actual bitmap doesn&amp;#8217;t match. ;-)&lt;/p&gt;&lt;/div&gt;
&lt;div class="admonitionblock"&gt;
&lt;table&gt;&lt;tr&gt;
&lt;td class="icon"&gt;
&lt;div class="title"&gt;Note&lt;/div&gt;
&lt;/td&gt;
&lt;td class="content"&gt;This feature is available for other bitmap formats as well, PNG is only
an example.&lt;/td&gt;
&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="sect1"&gt;
&lt;h2 id="_default_character_style_in_writer"&gt;Default character style in Writer&lt;/h2&gt;
&lt;div class="sectionbody"&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;In most cases you don&amp;#8217;t really need a default character style: if you&amp;#8217;re fine
with a default, then the default paragraph style should be enough for your
needs. In general, paragraph styles can contain character properties, so if
the default is fine for you, you just don&amp;#8217;t set a character style.&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;However, there is an exception to all rules. If you want to reset the current
character style, it makes sense to just set the &lt;code&gt;CharStyleName&lt;/code&gt; property to a
default value, especially since this works with paragraph styles already.&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;Now you can write C++ code like this (see
&lt;a href="https://cgit.freedesktop.org/libreoffice/core/tree/sw/qa/extras/unowriter/unowriter.cxx"&gt;SwUnoWriter::testDefaultCharStyle()&lt;/a&gt;
for a full example):&lt;/p&gt;&lt;/div&gt;
&lt;div class="listingblock"&gt;
&lt;div class="content"&gt;&lt;!-- Generator: GNU source-highlight
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite --&gt;
&lt;pre&gt;&lt;tt&gt;xCursorProps&lt;span style="color: #990000"&gt;-&amp;gt;&lt;/span&gt;&lt;span style="font-weight: bold"&gt;&lt;span style="color: #000000"&gt;setPropertyValue&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #990000"&gt;(&lt;/span&gt;&lt;span style="color: #FF0000"&gt;"CharStyleName"&lt;/span&gt;&lt;span style="color: #990000"&gt;,&lt;/span&gt; uno&lt;span style="color: #990000"&gt;::&lt;/span&gt;&lt;span style="font-weight: bold"&gt;&lt;span style="color: #000000"&gt;makeAny&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #990000"&gt;(&lt;/span&gt;&lt;span style="font-weight: bold"&gt;&lt;span style="color: #000000"&gt;OUString&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #990000"&gt;(&lt;/span&gt;&lt;span style="color: #FF0000"&gt;"Standard"&lt;/span&gt;&lt;span style="color: #990000"&gt;)));&lt;/span&gt;&lt;/tt&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;And it&amp;#8217;ll be handled as &lt;code&gt;Default Style&lt;/code&gt; in English builds, or their localized
versions in a non-English UI.&lt;/p&gt;&lt;/div&gt;
&lt;div class="paragraph"&gt;&lt;p&gt;All this is available in master (towards LibreOffice 6.2), or you can grab a
&lt;a href="http://dev-builds.libreoffice.org/daily/master/"&gt;daily build&lt;/a&gt; and try it out
right now. :-)&lt;/p&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Miklos Vajna</dc:creator><pubDate>Wed, 08 Aug 2018 09:10:21 +0000</pubDate><guid isPermaLink="false">tag:vmiklos.hu,2018-08-08:/blog/uno-api-improvements.html</guid><category>en</category></item></channel></rss>