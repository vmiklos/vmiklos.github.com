<!DOCTYPE html>
<html lang="en">

<head>
  <!-- ## for client-side less
  <link rel="stylesheet/less" type="text/css" href="https://vmiklos.hu/blog/theme/css/style.less">
  <script src="http://cdnjs.cloudflare.com/ajax/libs/less.js/1.7.3/less.min.js" type="text/javascript"></script>
  -->
  <link rel="stylesheet" type="text/css" href="https://vmiklos.hu/blog/theme/css/style.css">
  <link rel="stylesheet" type="text/css" href="https://vmiklos.hu/blog/theme/css/pygments.css">

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="author" content="Miklos Vajna">
  <meta name="description" content="Posts and writings by Miklos Vajna">

  <link href="https://vmiklos.hu/blog/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="What is Miklos hacking RSS" />

<link href="https://vmiklos.hu/blog/feeds/libreoffice.rss.xml" type="application/rss+xml" rel="alternate" title="What is Miklos hacking libreoffice Category RSS" />

  <title>
    What is Miklos hacking
&ndash; Category: libreoffice  </title>

<script type="text/javascript">
  var _paq = window._paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="//analytics.vmiklos.hu/";
    _paq.push(['setTrackerUrl', u+'matomo.php']);
    _paq.push(['setSiteId', '1']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
</head>

<body>
  <aside>
    <div id="user_meta">
      <h2><a href="https://vmiklos.hu/blog">What is Miklos hacking</a></h2>
      <p></p>
      <ul>
        <li><a href="/" target="_blank">Root</a></li>
        <li><a href="https://planet.documentfoundation.org/" target="_blank">LibreOffice Blogs</a></li>
      </ul>
    </div>
  </aside>

  <main>
    <header>
      <p>
      <a href="https://vmiklos.hu/blog">Index</a> &brvbar; <a href="https://vmiklos.hu/blog/archives.html">Archives</a>
      &brvbar; <a href="https://vmiklos.hu/blog/feeds/all.rss.xml">RSS</a>
&gt; Category: libreoffice
&brvbar; <a href="https://vmiklos.hu/blog/feeds/libreoffice.rss.xml">RSS</a>
      </p>
    </header>

<article>
  <div class="article_title">
    <h1><a href="https://vmiklos.hu/blog/gsoc2011-accepted.html">GSoC 2011 - Accepted</a></h1>
  </div>
  <div class="article_meta">
    <p>Posted on: Mon 25 April 2011</p>
  </div>
  <div class="article_readtime">
    <p>Estimated read time: 1 minutes</p>
  </div>
  <div class="article_text">
    <div id="preamble">
<div class="sectionbody">
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="http://code.google.com/images/GSoC2011_300x200.png" alt="http://code.google.com/images/GSoC2011_300x200.png" />
</div>
</div>
<div class="paragraph"><p>I just got the mail about
<a href="http://www.google-melange.com/gsoc/project/google/gsoc2011/vmiklos/9001">my
LibreOffice proposal</a> got accepted to Google Summer of Code 2011. I&#8217;m
looking forward to an exciting summer. :)</p></div>
</div>
</div>

  </div>
</article>
<hr />
<article>
  <div class="article_title">
    <h1><a href="https://vmiklos.hu/blog/lo-apply.html">Apply button to style edit dialog in Writer</a></h1>
  </div>
  <div class="article_meta">
    <p>Posted on: Mon 28 March 2011</p>
  </div>
  <div class="article_readtime">
    <p>Estimated read time: 1 minutes</p>
  </div>
  <div class="article_text">
    <div id="preamble">
<div class="sectionbody">
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="https://lh3.googleusercontent.com/-D-pV0cucPL0/UYduyolR-AI/AAAAAAAACso/zL9Vd2IQgY0/s400/fdo32413.png" alt="https://lh3.googleusercontent.com/-D-pV0cucPL0/UYduyolR-AI/AAAAAAAACso/zL9Vd2IQgY0/s400/fdo32413.png" />
</div>
</div>
<div class="paragraph"><p>LibreOffice 3.4 will have a new
<a href="http://cgit.freedesktop.org/libreoffice/writer/commit/?id=c62b8fc02d9357cea7fd399b173ed5280bf4c53c">feature</a>,
if you edit styles in Writer, then you can test your style changes
without manually closing and opening the style edit dialog again.</p></div>
<div class="paragraph"><p>Do you like this feature? There are still similar
<a href="https://bugs.freedesktop.org/show_bug.cgi?id=32413">remaining dialogs</a> to
improve like this, send in a patch!</p></div>
</div>
</div>

  </div>
</article>
<hr />
<article>
  <div class="article_title">
    <h1><a href="https://vmiklos.hu/blog/lo-ru.html">Russian characters in RTF export</a></h1>
  </div>
  <div class="article_meta">
    <p>Posted on: Thu 27 January 2011</p>
  </div>
  <div class="article_readtime">
    <p>Estimated read time: 1 minutes</p>
  </div>
  <div class="article_text">
    <div id="preamble">
<div class="sectionbody">
<div class="paragraph"><p>I got <a href="https://bugs.freedesktop.org/show_bug.cgi?id=33478">a report</a> about
two problems which got fixed in master now.</p></div>
<div class="paragraph"><p>The first error is triggered, if you have special (in RTF terms, so for
example <code>{</code> or <code>}</code>) characters in style names. The result was not so
friendly when you opened such a document:</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="http://vmiklos.hu/pic/loru1.png" alt="http://vmiklos.hu/pic/loru1.png" />
</div>
</div>
<div class="paragraph"><p>After applying the
<a href="http://cgit.freedesktop.org/libreoffice/writer/commit/?id=1482475880c2902d8e041bdc211fc52afd4a7efb">first
fix</a>, the document was imported but the original
&#1058;&#1077;&#1089;&#1090; text was replaced by something
non-unicode:</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="http://vmiklos.hu/pic/loru2.png" alt="http://vmiklos.hu/pic/loru2.png" />
</div>
</div>
<div class="paragraph"><p>The
<a href="http://cgit.freedesktop.org/libreoffice/writer/commit/?id=a37fae128b4badc8f9f2201e28dca3e08948ddec">second
fix</a> addresses this, and now the result is the expected one:</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="http://vmiklos.hu/pic/loru3.png" alt="http://vmiklos.hu/pic/loru3.png" />
</div>
</div>
</div>
</div>

  </div>
</article>
<hr />
<article>
  <div class="article_title">
    <h1><a href="https://vmiklos.hu/blog/lo-doxygen-for-new-headers.html">LibreOffice's git-hooks now warn about undocumented classes</a></h1>
  </div>
  <div class="article_meta">
    <p>Posted on: Fri 21 January 2011</p>
  </div>
  <div class="article_readtime">
    <p>Estimated read time: 1 minutes</p>
  </div>
  <div class="article_text">
    <div id="preamble">
<div class="sectionbody">
<div class="paragraph"><p>There was a thread about this topic already, but just refusing to commit
new files without documentation sounded too aggressive. So the
<a href="http://cgit.freedesktop.org/libreoffice/bootstrap/commit/?id=5e7d47da56c9b35331756bcb915b23e2f14a62d6">current
code</a> just prints a warning.</p></div>
<div class="paragraph"><p>It was also requested to show some good/bad examples. Lubos
<a href="http://thread.gmane.org/gmane.comp.documentfoundation.libreoffice.devel/2938/focus=5389">volunteered</a>
to add detailed instructions in the wiki, so I&#8217;m just describing in
short what did I test so far.</p></div>
<div class="paragraph"><p>A good example:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900">/// Handles export of foos using RTF markup</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">RtfFoo</span>
<span style="color: #FF0000">{</span>
<span style="color: #FF0000">}</span><span style="color: #990000">;</span></tt></pre></div></div>
<div class="paragraph"><p>A bad example:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">RtfBarBuggy</span>
<span style="color: #FF0000">{</span>
<span style="color: #FF0000">}</span><span style="color: #990000">;</span></tt></pre></div></div>
<div class="paragraph"><p>Example output when a warning is emitted:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>~/git/libreoffice/master/sw$ git commit -a -m foo
sw/source/filter/ww8/bar.hxx:30: warning: Compound RtfBarBuggy is not documented.
[master 1b11571] foo
 3 files changed, 68 insertions(+), 0 deletions(-)
 create mode 100644 sw/source/filter/ww8/bar.hxx
 create mode 100644 sw/source/filter/ww8/foo.hxx</code></pre>
</div></div>
</div>
</div>

  </div>
</article>
<hr />
<article>
  <div class="article_title">
    <h1><a href="https://vmiklos.hu/blog/wrapped-images-in-word.html">Wrapped images in Word (LibreOffice RTF export)</a></h1>
  </div>
  <div class="article_meta">
    <p>Posted on: Thu 13 January 2011</p>
  </div>
  <div class="article_readtime">
    <p>Estimated read time: 1 minutes</p>
  </div>
  <div class="article_text">
    <div id="preamble">
<div class="sectionbody">
<div class="paragraph"><p>I&#8217;ve got a <a href="https://bugs.freedesktop.org/show_bug.cgi?id=32613">report</a>
which turned out to be two separate issues. One is a regression from
Go-OO 3.2.x, this post is about this part. The other part is about the
improvement of both the import/export RTF filter, the bug has some
detail on that part as well.</p></div>
<div class="paragraph"><p>So the problem was that wrapped images (when the image is a frame and
not a character) had some extremely small height. I did not notice this
bug in LO as an LO-specific extension hides that value, but in Word you
can see it:</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="http://vmiklos.hu/pic/fdo32613-before.png" alt="http://vmiklos.hu/pic/fdo32613-before.png" />
</div>
</div>
<div class="paragraph"><p>The
<a href="http://cgit.freedesktop.org/libreoffice/writer/commit/?id=c27e4668b18248322be699fc9fc6bf01e4d6a7ea">fix</a>
is to use the height of the containing frame instead of the height of
the picture itself, then it&#8217;ll look fine:</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="http://vmiklos.hu/pic/fdo32613-after.png" alt="http://vmiklos.hu/pic/fdo32613-after.png" />
</div>
</div>
</div>
</div>

  </div>
</article>
<hr />
<article>
  <div class="article_title">
    <h1><a href="https://vmiklos.hu/blog/lo-f13.html">LibreOffice vs. F13</a></h1>
  </div>
  <div class="article_meta">
    <p>Posted on: Sat 08 January 2011</p>
  </div>
  <div class="article_readtime">
    <p>Estimated read time: 1 minutes</p>
  </div>
  <div class="article_text">
    <div id="preamble">
<div class="sectionbody">
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="http://vmiklos.hu/pic/lof13.png" alt="http://vmiklos.hu/pic/lof13.png" />
</div>
</div>
<div class="paragraph"><p>About four days ago it has been asked on <code>#libreoffice</code> if it&#8217;s possible
to bind functions to F13..F16 in Calc. The short answer is no, but it
turned out it&#8217;s pretty trivial to allow that (and of course not only in
Calc).</p></div>
<div class="paragraph"><p><a href="http://cedric.bosdonnat.free.fr/wordpress/?p=657">Cedric&#8217;s great post</a> is
helpful here to find the relevant code. It also truned out that VCL
already supports those keys, so only the user interface has to be
improvied to export that feature.</p></div>
<div class="paragraph"><p>The patch is
<a href="http://article.gmane.org/gmane.comp.documentfoundation.libreoffice.devel/4793">here</a>.</p></div>
</div>
</div>

  </div>
</article>
<hr />
<article>
  <div class="article_title">
    <h1><a href="https://vmiklos.hu/blog/osl-trace.html">OSL_TRACE()</a></h1>
  </div>
  <div class="article_meta">
    <p>Posted on: Wed 24 November 2010</p>
  </div>
  <div class="article_readtime">
    <p>Estimated read time: 1 minutes</p>
  </div>
  <div class="article_text">
    <div id="preamble">
<div class="sectionbody">
<div class="paragraph"><p>Background: <code>OSL_TRACE()</code> is an internal LibreOffice macro that is like
<code>printf()</code>, but it&#8217;s only enabled in debug mode. Without it, you would
add a debug printf during development:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #000000">printf</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"debug, foo</span><span style="color: #CC33CC">\n</span><span style="color: #FF0000">"</span><span style="color: #990000">);</span></tt></pre></div></div>
<div class="paragraph"><p>then you would comment it out when the code started working,:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900">//printf("debug, foo\n");</span></span></tt></pre></div></div>
<div class="paragraph"><p>then remove the comment when it breaks again, etc.</p></div>
<div class="paragraph"><p>In the past, if you built a LibreOffice module, then you executed:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>build</code></pre>
</div></div>
<div class="paragraph"><p>inside a module, and in case you wanted debug symbols and such messages you built using:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>build debug=t</code></pre>
</div></div>
<div class="paragraph"><p>which increased the debug level to 2 (from 0), where 1 is required for
debug symbols, 2 for debug messages. (See the OOo
<a href="http://wiki.services.openoffice.org/wiki/Debug_Levels">wiki page</a>.)</p></div>
<div class="paragraph"><p>The recent update, why I&#8217;m writing this post: Now this has been
<a href="http://cgit.freedesktop.org/libreoffice/bootstrap/commit/?id=47d09469e96485f93623a6fbeb42f709c2ce49bb">changed</a>,
and <code>debug=t</code> gives you debug symbols only, but no extra debug output.
While this is
<a href="http://lists.freedesktop.org/archives/libreoffice/2010-November/002894.html">great
in most cases</a>, sometimes you still want the old behaviour to get the
debug messages. In that case the solution (as pointed out in the mailing
list post) is to use:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>build debug=t dbglevel=2</code></pre>
</div></div>
<div class="paragraph"><p>(Hopefully this post will be handy for who missed that post, like I did
the first time.)</p></div>
</div>
</div>

  </div>
</article>
<hr />
<article>
  <div class="article_title">
    <h1><a href="https://vmiklos.hu/blog/slides-of-my-gsoc-2010-presentation.html">Slides of my GSoC 2010 Presentation</a></h1>
  </div>
  <div class="article_meta">
    <p>Posted on: Mon 25 October 2010</p>
  </div>
  <div class="article_readtime">
    <p>Estimated read time: 1 minutes</p>
  </div>
  <div class="article_text">
    <div id="preamble">
<div class="sectionbody">
As requested, the slides of my presentation, titled "GSoC project: Improving RTF Export - Presentation of a Go-OO student" are available <a href="http://people.freedesktop.org/~vmiklos/lo-opensuse-nurnberg-2010.pdf">here</a>.
</div>
</div>

  </div>
</article>
<hr />
<article>
  <div class="article_title">
    <h1><a href="https://vmiklos.hu/blog/opensuse-conference-2010.html">openSUSE Conference 2010</a></h1>
  </div>
  <div class="article_meta">
    <p>Posted on: Sun 24 October 2010</p>
  </div>
  <div class="article_readtime">
    <p>Estimated read time: 1 minutes</p>
  </div>
  <div class="article_text">
    <div id="preamble">
<div class="sectionbody">
<p>So I have been invited to this year's openSUSE conference in Nurnberg to give a short presentation about my GSoC work (the RTF export rewrite in LibreOffice).</p><p>As I expected, the really interesting part was to meet people I never had the ability to meet in person previously - and of course to learn other new stuff. :)</p><p>So some of the items I really liked:</p><p><ul>
  <li>We actually did some hacking, see <a href="http://cgit.freedesktop.org/libreoffice/writer/commit/?id=a8e76355d980ee015162023150ae48d68fbb4124">here</a> (thanks Cedric for pointing out the issue for me).</li>
  <li>I learned about <a href="http://en.wikipedia.org/wiki/Digraphs_and_trigraphs#C">trigraphs</a> - thanks Fridrich!</li>
  <li>I now heard about flat ODF from Muthusuba.</li>
  <li>Nice jokes by Tor about old UNIX systems where the default installation added a login for Kernighan and Ritchie by default. :)</li>
  <li>Met great people from the LibreOffice team (Kohei, Noel, Muthu, Cedric, Tor, Fridrich, Petr, Lubos), and outside: Stephan Kulow (coolo, the ex-kde-master) and others.</li>
</ul></p><p>To sum up: thank you for the invitation, I enjoyed it! :)</p>
</div>
</div>

  </div>
</article>

<footer>
<div id="paginator">

<a href="https://vmiklos.hu/blog/category/libreoffice17.html" class="button_accent">Newer Posts &rarr;</a>
</div>
</footer>

    <div id="ending_message">
      <p>&copy; Miklos Vajna. Built using <a href="http://getpelican.com" target="_blank">Pelican</a>. Theme by Giulio Fidente on <a href="https://github.com/gfidente/pelican-svbhack" target="_blank">github</a>. </p>
    </div>
  </main>
</body>
</html>