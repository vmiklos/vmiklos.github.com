<!DOCTYPE html>
<html lang="en">

<head>
  <!-- ## for client-side less
  <link rel="stylesheet/less" type="text/css" href="https://vmiklos.hu/blog/theme/css/style.less">
  <script src="http://cdnjs.cloudflare.com/ajax/libs/less.js/1.7.3/less.min.js" type="text/javascript"></script>
  -->
  <link rel="stylesheet" type="text/css" href="https://vmiklos.hu/blog/theme/css/style.css">
  <link rel="stylesheet" type="text/css" href="https://vmiklos.hu/blog/theme/css/pygments.css">
  <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=PT+Sans|PT+Serif|PT+Mono">

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="author" content="Miklos Vajna">
  <meta name="description" content="Posts and writings by Miklos Vajna">

  <link href="https://vmiklos.hu/blog/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="What is Miklos hacking RSS" />


  <title>
    What is Miklos hacking
&ndash; Tag: hacking  </title>

</head>

<body>
  <aside>
    <div id="user_meta">
      <!--<a href="https://vmiklos.hu/blog">
        <img src="https://vmiklos.hu/blog/theme/images/logo.png" alt="logo">
      </a>-->
      <h2><a href="https://vmiklos.hu/blog">What is Miklos hacking</a></h2>
      <p></p>
      <ul>
        <li><a href="/" target="_blank">Root</a></li>
        <li><a href="https://planet.documentfoundation.org/" target="_blank">LibreOffice Blogs</a></li>
      </ul>
    </div>
  </aside>

  <main>
    <header>
      <p>
      <a href="https://vmiklos.hu/blog">Index</a> &brvbar; <a href="https://vmiklos.hu/blog/archives.html">Archives</a>
      &brvbar; <a href="https://vmiklos.hu/blog/feeds/all.rss.xml">RSS</a>
&gt; Tag: hacking
      </p>
    </header>

<article>
  <div class="article_title">
    <h1><a href="https://vmiklos.hu/blog/bitlbee-skype-0.8.4.html">BitlBee-Skype 0.8.4</a></h1>
  </div>
  <div class="article_text">
    <div id="preamble">
<div class="sectionbody">
<div class="paragraph"><p>I just released 0.8.4. The happy thing about it is that basically the
only fix I added to this release is to make it work when python is
python3k (so we need to use python2.7 to get python2 support), but the
rest is just merge from:</p></div>
<div class="ulist"><ul>
<li>
<p>
email
</p>
</li>
<li>
<p>
github
</p>
</li>
<li>
<p>
Debian
</p>
</li>
</ul></div>
<div class="paragraph"><p>Now the total number of contributors increased to 7. :)</p></div>
</div>
</div>

  </div>
</article>
<hr />
<article>
  <div class="article_title">
    <h1><a href="https://vmiklos.hu/blog/libwpd-bindings.html">libwpd-bindings-0.1.0</a></h1>
  </div>
  <div class="article_text">
    <div id="preamble">
<div class="sectionbody">
<div class="paragraph"><p>I tried to search back when did I create Java bindings for libwpd - it
seems
<a href="http://vmiklos.hu/gitweb/?p=libwpd-old.git;a=commit;h=2ee19c1e5e3b5cc28db8c9dc9aa7e6116e62b730">this</a>
was the first commit.</p></div>
<div class="paragraph"><p>First I kept back the source code to get some money for it (there were a
customer who seemed to be willing to pay, but then disappeared), then I
just abandoned the idea and pushed it to
<a href="http://libwpd.sourceforge.net/">SourceForge.net</a> to some
<a href="http://libwpd.cvs.sourceforge.net/viewvc/libwpd/libwpd2-bindings/">CVS
repo</a>, (I even mentioned it in a
<a href="/blog/preparing-frugalware-1-0pre2">blog post</a>), which is finally
now converted to
<a href="http://libwpd.git.sourceforge.net/git/gitweb.cgi?p=libwpd/libwpd-bindings;a=summary">git</a>.</p></div>
<div class="paragraph"><p>Long story short, a week ago finally Fridrich
<a href="http://sourceforge.net/projects/libwpd/files/libwpd-bindings/download">released</a>
the first version of the code, after about 2.75 years. :)</p></div>
</div>
</div>

  </div>
</article>
<hr />
<article>
  <div class="article_title">
    <h1><a href="https://vmiklos.hu/blog/osl-trace.html">OSL_TRACE()</a></h1>
  </div>
  <div class="article_text">
    <div id="preamble">
<div class="sectionbody">
<div class="paragraph"><p>Background: <code>OSL_TRACE()</code> is an internal LibreOffice macro that is like
<code>printf()</code>, but it&#8217;s only enabled in debug mode. Without it, you would
add a debug printf during development:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #000000">printf</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"debug, foo</span><span style="color: #CC33CC">\n</span><span style="color: #FF0000">"</span><span style="color: #990000">);</span></tt></pre></div></div>
<div class="paragraph"><p>then you would comment it out when the code started working,:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900">//printf("debug, foo\n");</span></span></tt></pre></div></div>
<div class="paragraph"><p>then remove the comment when it breaks again, etc.</p></div>
<div class="paragraph"><p>In the past, if you built a LibreOffice module, then you executed:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>build</code></pre>
</div></div>
<div class="paragraph"><p>inside a module, and in case you wanted debug symbols and such messages you built using:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>build debug=t</code></pre>
</div></div>
<div class="paragraph"><p>which increased the debug level to 2 (from 0), where 1 is required for
debug symbols, 2 for debug messages. (See the OOo
<a href="http://wiki.services.openoffice.org/wiki/Debug_Levels">wiki page</a>.)</p></div>
<div class="paragraph"><p>The recent update, why I&#8217;m writing this post: Now this has been
<a href="http://cgit.freedesktop.org/libreoffice/bootstrap/commit/?id=47d09469e96485f93623a6fbeb42f709c2ce49bb">changed</a>,
and <code>debug=t</code> gives you debug symbols only, but no extra debug output.
While this is
<a href="http://lists.freedesktop.org/archives/libreoffice/2010-November/002894.html">great
in most cases</a>, sometimes you still want the old behaviour to get the
debug messages. In that case the solution (as pointed out in the mailing
list post) is to use:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>build debug=t dbglevel=2</code></pre>
</div></div>
<div class="paragraph"><p>(Hopefully this post will be handy for who missed that post, like I did
the first time.)</p></div>
</div>
</div>

  </div>
</article>
<hr />
<article>
  <div class="article_title">
    <h1><a href="https://vmiklos.hu/blog/ooo-vmiklos01-merged.html">OpenOffice.org: vmiklos01 CWS integrated</a></h1>
  </div>
  <div class="article_text">
    <div id="preamble">
<div class="sectionbody">
<div class="paragraph"><p>Once I was ready with this year&#8217;s GSoC work I started to submit it back
to OpenOffice.org. Before that was completed, LibreOffice was launched,
though I thought if I started working on submitting it to OpenOffice.org
as well, I&#8217;ll finish it. About 6 weeks later they now
<a href="http://hg.services.openoffice.org/DEV300/rev/5a2d87e7a414">integrated</a>
(merged) the <code>vmiklos01</code> CWS (the branch containing my GSoC work) to
DEV300, what will became OpenOffice.org 3.4 later.</p></div>
</div>
</div>

  </div>
</article>
<hr />
<article>
  <div class="article_title">
    <h1><a href="https://vmiklos.hu/blog/iscsi-target.html">tgt is now available as a package</a></h1>
  </div>
  <div class="article_text">
    <div id="preamble">
<div class="sectionbody">
<div class="paragraph"><p>Today I packaged <a href="http://frugalware.org/packages/103291">tgt</a> an iSCSI
target (server). The upstream package provides a large number of
examples, though I thought it&#8217;s a good idea to note what I used for
testing:</p></div>
<div class="listingblock">
<div class="content">
<pre><code># egrep -v '#|^$' /etc/tgt/targets.conf
default-driver iscsi
&lt;target iqn.2010-11.local.test:storage&gt;
    backing-store /dev/sdb
&lt;/target&gt;</code></pre>
</div></div>
<div class="paragraph"><p>Something offtopic: a
<a href="https://github.com/artagnon/rejourn/commit/3b87aab385647ea8e5dd8844aec913ab3c02252f">rejourn</a>
patch accepted and a
<a href="https://bugs.freedesktop.org/show_bug.cgi?id=31362">LibreOffice</a> bug
fixed today.</p></div>
</div>
</div>

  </div>
</article>
<hr />
<article>
  <div class="article_title">
    <h1><a href="https://vmiklos.hu/blog/slides-of-my-gsoc-2010-presentation.html">Slides of my GSoC 2010 Presentation</a></h1>
  </div>
  <div class="article_text">
    <div id="preamble">
<div class="sectionbody">
As requested, the slides of my presentation, titled "GSoC project: Improving RTF Export - Presentation of a Go-OO student" are available <a href="http://people.freedesktop.org/~vmiklos/lo-opensuse-nurnberg-2010.pdf">here</a>.
</div>
</div>

  </div>
</article>
<hr />
<article>
  <div class="article_title">
    <h1><a href="https://vmiklos.hu/blog/opensuse-conference-2010.html">openSUSE Conference 2010</a></h1>
  </div>
  <div class="article_text">
    <div id="preamble">
<div class="sectionbody">
<p>So I have been invited to this year's openSUSE conference in Nurnberg to give a short presentation about my GSoC work (the RTF export rewrite in LibreOffice).</p><p>As I expected, the really interesting part was to meet people I never had the ability to meet in person previously - and of course to learn other new stuff. :)</p><p>So some of the items I really liked:</p><p><ul>
  <li>We actually did some hacking, see <a href="http://cgit.freedesktop.org/libreoffice/writer/commit/?id=a8e76355d980ee015162023150ae48d68fbb4124">here</a> (thanks Cedric for pointing out the issue for me).</li>
  <li>I learned about <a href="http://en.wikipedia.org/wiki/Digraphs_and_trigraphs#C">trigraphs</a> - thanks Fridrich!</li>
  <li>I now heard about flat ODF from Muthusuba.</li>
  <li>Nice jokes by Tor about old UNIX systems where the default installation added a login for Kernighan and Ritchie by default. :)</li>
  <li>Met great people from the LibreOffice team (Kohei, Noel, Muthu, Cedric, Tor, Fridrich, Petr, Lubos), and outside: Stephan Kulow (coolo, the ex-kde-master) and others.</li>
</ul></p><p>To sum up: thank you for the invitation, I enjoyed it! :)</p>
</div>
</div>

  </div>
</article>
<hr />
<article>
  <div class="article_title">
    <h1><a href="https://vmiklos.hu/blog/libreoffice-even-on-ppc.html">LibreOffice: even on ppc</a></h1>
  </div>
  <div class="article_text">
    <div id="preamble">
<div class="sectionbody">
<p>You probably have read that ooo-build has been <a href="http://www.documentfoundation.org/contact/tdf_release.xml">renamed</a> to LibreOffice (technically it's just a rename).</p><p>Test packages for i686 available <a href="http://ftp.frugalware.org/pub/other/people/vmiklos/ooo33/frugalware-i686/">here</a> if you want to test it on Frugalware.</p><p>Aaand this time, as a very special gift, ppc packages are <a href="http://ftp.frugalware.org/pub/other/people/vmiklos/ooo33/frugalware-ppc/">available</a> as well! :)</p><p>I just built it, but Bouleetbil was kind enough to provide a <a href="http://dors.frugalware.org/libreofficeppc.png">screenshot</a> when he tested it.</p>
</div>
</div>

  </div>
</article>
<hr />
<article>
  <div class="article_title">
    <h1><a href="https://vmiklos.hu/blog/gammu-1-28-issue.html">gammu-1.28 issue</a></h1>
  </div>
  <div class="article_text">
    <div id="preamble">
<div class="sectionbody">
<p>I recently upgraded gammu from 1.27 to 1.28 in -current and I noticed that the backup of my phone is now way slower than before. The <a href="http://gitorious.org/gammu/mainline/commit/9e7b902b8b80dd953bf491e494e42865b0f232d5.patch">fix</a> was trivial (already backported to the Frugalware package as well) for the maintainer so it's now fine again.</p><p>Well done, mcihar! :)</p>
</div>
</div>

  </div>
</article>
<hr />
<article>
  <div class="article_title">
    <h1><a href="https://vmiklos.hu/blog/playing-with-libvirt.html">Playing with libvirt</a></h1>
  </div>
  <div class="article_text">
    <div id="preamble">
<div class="sectionbody">
<p>I've been playing with <a href="http://frugalware.org/packages/14204">libvirt</a> in the last two days. My motivation was that I saw:<ol>
  <li>plain kvm is not that fast</li>
  <li>there is this virtio framework which aims to make it faster</li>
  <li>using virtio directly is hard, better not reinventing the wheel and just try libvirt</li>
</ol></p><p>So if you want to try it yourself, you need to pacman -S libvirt, service libvirtd start. Check /var/log/syslog for error messages, in case it can't find some commands (bridge-utils, dnsmasq, etc.), install them.</p><p>If you want to create a new virtual machine, you need pacman -S virtinst. Then you can use something like:</p><p><code>virt-install --name=syncpkgcd-helicon --arch=x86_64 --vcpus=1 --ram=1024 --os-type=linux --os-variant=virtio26 --connect=qemu:///system --network network=default --cdrom=/virt/iso/frugalware-1.3-i686-net.iso --disk path=/virt/syncpkgcd/syncpkgcd.img,size=40 --accelerate --vnc --noautoconsole --keymap=us</code></p><p>See man virt-isntall for more info about the meaning of the switches. One trick: kvm can't handle the gfxmenu in our grub on the install cd, so you need to disable that. One way to do it is to use <code>vim -b frugalware-1.3-i686-net.iso</code>, search for "menu /boot", and change "gfx" to "#fx". Then you can run virt-install. It'll start the install in the background. The easiest way (for me) to connect to the console is to create an ssh tunnel to the server running the kvm machine (for example ssh -L 5900:localhost:5900 server), then run <code>krdc localhost:0</code> on my own machine.</p><p>Next trick is that you need kernel support to boot from virtio disks (/dev/vda), that's enabled in frugalware-current.git but there were no rebuild yet, so you need to build it yourself for now.</p><p>Once the installation finished, the machine will be shut down. You can use <code>virsh</code> to start it. <a href="http://acidborg.wordpress.com/2010/02/19/how-to-manage-kvm-virtual-machines-using-virsh/">Here</a> is a great summary about virsh subcommands. Something not to forget: if you want to automatically start the machine after the host booted, use <code>virsh autostart $name</code>.</p><p>(You can also do a service libvirt-guests add, that way all guests will be automatically suspended/resumed on shutdown/boot. Just to be clear: if you want the "resume if it was a proper shutdown, start if there was a power cut" feature: you need both init scripts because libvirtd will always start/resume autostart guests, but it will never suspend them on shutdown.)</p><p>If grub hangs after reboot, try creating a small (I used 32MB) separate /boot partition first, that should fix the issue.</p><p><code>virsh shutdown $machine</code> won't work if you don't install acpid and enable it as well, so it's a good idea to do so.</p><p>The last trick: if you want to use the virt-manager gui from your local machine to manage a remote host, it isn't trivial to do so. First, it would try to login via ssh as root, and that's disabled by default. (And why would you enable it?). Also, even if you allow that, it would try to use <code>nc -U</code> which is supported by the openbsd nc only, the gnu nc does not have such a switch. Instead, we can use socat to connect to unix sockets. So I created a wrapper script under ~/bin with the following contents:</p><p><pre>
#!/bin/sh
if [ "$1" == "-U" ]; then
        sudo socat - unix-client:$2
else
        /usr/bin/netcat $@
fi
</pre></p><p>Don't forget to add PATH=what_you_want line to ~/.ssh/environment, and include the full path of ~/bin there. This way you can keep using gnu nc and you can also login as a user to manage your machines, as long as you set up nopasswd sudo for your user for socat.</p><p>Finally a mini-benchmark:</p><p>The SBU of yugo (i686 buildserver, a bit old HW) is 645 seconds, SBU of an i686 guest on helicon (c2q machine with 8g ram) is 264, SBU of the host build on helicon is 76.</p><p>I would call this usable (not right now, but once we sort out the kernel part). Finally something that is free software and is comparable to VMware ESX. :)</p><p>Update: I recently did the same install with 1.4pre1 (which installs -current, so the kernel is 2.6.36), the list of tricks you still need:</p><p><ul>
  <li>separate /boot (haven't tried without)</li>
  <li>edit iso image to get rid of gfxboot (tried, still fails without)</li>
  <li>some problem with grub, you need to manually add "(hd0) /dev/vda" to /boot/grub/device.map, then run grub-install /dev/vda</li>
</ul></p><p>So no more custom kernel, boot from virtio works by default! :)</p>
</div>
</div>

  </div>
</article>

<footer>
<div id="paginator">
<a href="https://vmiklos.hu/blog/tag/hacking2.html" class="button_accent">&larr; Older Posts</a>

</div>
</footer>

    <div id="ending_message">
      <p>&copy; Miklos Vajna. Built using <a href="http://getpelican.com" target="_blank">Pelican</a>. Theme by Giulio Fidente on <a href="https://github.com/gfidente/pelican-svbhack" target="_blank">github</a>. </p>
    </div>
  </main>
</body>
</html>