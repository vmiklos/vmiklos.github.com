<!DOCTYPE html>
<html lang="en">

<head>
  <!-- ## for client-side less
  <link rel="stylesheet/less" type="text/css" href="https://vmiklos.hu/blog/theme/css/style.less">
  <script src="http://cdnjs.cloudflare.com/ajax/libs/less.js/1.7.3/less.min.js" type="text/javascript"></script>
  -->
  <link rel="stylesheet" type="text/css" href="https://vmiklos.hu/blog/theme/css/style.css">
  <link rel="stylesheet" type="text/css" href="https://vmiklos.hu/blog/theme/css/pygments.css">

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="author" content="Miklos Vajna">
  <meta name="description" content="Posts and writings by Miklos Vajna">

  <link href="https://vmiklos.hu/blog/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="What is Miklos hacking RSS" />


  <title>
    What is Miklos hacking
&ndash; Tag: en  </title>

<script type="text/javascript">
  var _paq = window._paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="//analytics.vmiklos.hu/";
    _paq.push(['setTrackerUrl', u+'matomo.php']);
    _paq.push(['setSiteId', '1']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
</head>

<body>
  <aside>
    <div id="user_meta">
      <h2><a href="https://vmiklos.hu/blog">What is Miklos hacking</a></h2>
      <p></p>
      <ul>
        <li><a href="/" target="_blank">Root</a></li>
        <li><a href="https://planet.documentfoundation.org/" target="_blank">LibreOffice Blogs</a></li>
      </ul>
    </div>
  </aside>

  <main>
    <header>
      <p>
      <a href="https://vmiklos.hu/blog">Index</a> &brvbar; <a href="https://vmiklos.hu/blog/archives.html">Archives</a>
      &brvbar; <a href="https://vmiklos.hu/blog/feeds/all.rss.xml">RSS</a>
&gt; Tag: en
      </p>
    </header>

<article>
  <div class="article_title">
    <h1><a href="https://vmiklos.hu/blog/sw-smallcaps-toolbar-button.html">Small capitals toolbar button in LibreOffice Writer</a></h1>
  </div>
  <div class="article_meta">
    <p>Posted on: Mon 03 October 2016</p>
  </div>
  <div class="article_readtime">
    <p>Estimated read time: 1 minutes</p>
  </div>
  <div class="article_text">
    <div id="preamble">
<div class="sectionbody">
<div class="imageblock" style="text-align:center;">
<div class="content">
<a class="image" href="https://farm6.staticflickr.com/5235/29982452081_a9ca103f2f_o.png">
<img src="https://farm6.staticflickr.com/5235/29982452081_187d99dece_z.jpg" alt="https://farm6.staticflickr.com/5235/29982452081_187d99dece_z.jpg" />
</a>
</div>
</div>
<div class="paragraph"><p>It was <a href="https://bugs.documentfoundation.org/show_bug.cgi?id=87914">requested</a> to
be able to set the small capitals character property via a toolbar button in
Writer, which was indeed not possible. Not only the toolbar button wasn&#8217;t
there, but the underlying UNO command was also missing (which you can use e.g.
from a macro to format the current selection).</p></div>
<div class="paragraph"><p>So my
<a href="https://gerrit.libreoffice.org/gitweb?p=core.git;a=commit;h=d378cd2f766eeb1fd1c98f62c9ae6b5b59fd00f1">commit</a>
added a simple set of icons to the galaxy theme for the new toolbar button,
defined the new UNO command for Writer text and added it to Writer&#8217;s text
object bar, next to the upper case and lower case buttons (hidden by default).
One difference from those buttons is that those buttons perform a
transliteration, while this one really just sets a character property, you can
easily undo the property later if needed.</p></div>
<div class="paragraph"><p>Wrt. other icon themes, see
<a href="http://listarchives.libreoffice.org/global/design/msg07922.html">this mail</a>,
hopefully the design team can help there.</p></div>
<div class="paragraph"><p>As usual, you can try this right now with a 5.3
<a href="http://dev-builds.libreoffice.org/daily/master/">daily build</a>. :-)</p></div>
</div>
</div>

  </div>
</article>
<hr />
<article>
  <div class="article_title">
    <h1><a href="https://vmiklos.hu/blog/clang-locon-brno-2k16.html">Using clang-based tools beyond loplugin LOCon lightning talk</a></h1>
  </div>
  <div class="article_meta">
    <p>Posted on: Tue 13 September 2016</p>
  </div>
  <div class="article_readtime">
    <p>Estimated read time: 1 minutes</p>
  </div>
  <div class="article_text">
    <div id="preamble">
<div class="sectionbody">
<div class="imageblock" style="text-align:center;">
<div class="content">
<a class="image" href="https://speakerd.s3.amazonaws.com/presentations/731c4bb5277c48d8acbba1c867ece856/clang-locon-brno-2k16.pdf">
<img src="https://farm9.staticflickr.com/8074/29618061316_308e7e9b30_z.jpg" alt="https://farm9.staticflickr.com/8074/29618061316_308e7e9b30_z.jpg" />
</a>
</div>
</div>
<div class="paragraph"><p>The last week I gave a
<a href="http://conference.libreoffice.org/2016/the-program/sept-9th-friday/">Using
clang-based tools beyond loplugin</a> lightning talk at LibreOffice conference
2016, on the last day. Click on the image to see all the slides.</p></div>
<div class="paragraph"><p>If you&#8217;re a vim or emacs user and you work with C++11 code, you probably
want to have a look at
<a href="http://clang.llvm.org/extra/clang-rename.html">clang-rename</a>,
<a href="http://clang.llvm.org/extra/include-fixer.html">include-fixer</a> and some editor
plugin exposing the power of libclang (like
<a href="https://valloric.github.io/YouCompleteMe/">YouCompleteMe</a> or
<a href="https://github.com/libclang-vim/libclang-vim">libclang-vim</a>), sometimes these
are really helpful.</p></div>
</div>
</div>

  </div>
</article>
<hr />
<article>
  <div class="article_title">
    <h1><a href="https://vmiklos.hu/blog/rtf-locon-brno-2k16.html">A year in LibreOffice's RTF support LOCon talk</a></h1>
  </div>
  <div class="article_meta">
    <p>Posted on: Mon 12 September 2016</p>
  </div>
  <div class="article_readtime">
    <p>Estimated read time: 1 minutes</p>
  </div>
  <div class="article_text">
    <div id="preamble">
<div class="sectionbody">
<div class="imageblock" style="text-align:center;">
<div class="content">
<a class="image" href="https://speakerd.s3.amazonaws.com/presentations/65dac04a99f146649b08cf66211469fd/rtf-locon-brno-2k16.pdf">
<img src="https://farm9.staticflickr.com/8004/29626765785_7f35c9bfd6_z.jpg" alt="https://farm9.staticflickr.com/8004/29626765785_7f35c9bfd6_z.jpg" />
</a>
</div>
</div>
<div class="paragraph"><p>Last week I gave a
<a href="http://conference.libreoffice.org/2016/the-program/sept-8th-thursday/"> year in
LibreOffice&#8217;s RTF support</a> talk at LibreOffice conference 2016, in the
development track. Click on the image to see all the slides.</p></div>
<div class="paragraph"><p>I&#8217;ve also published a number of (mostly)
<a href="https://www.flickr.com/photos/vmiklos/albums/72157673517450165">sightseeing
pictures</a> based on wondering around in Brno before and after the conference.</p></div>
</div>
</div>

  </div>
</article>
<hr />
<article>
  <div class="article_title">
    <h1><a href="https://vmiklos.hu/blog/collaborative-locon-brno-2k16.html">Collaborative editing using LibreOfficeKit LOCon talk</a></h1>
  </div>
  <div class="article_meta">
    <p>Posted on: Fri 09 September 2016</p>
  </div>
  <div class="article_readtime">
    <p>Estimated read time: 1 minutes</p>
  </div>
  <div class="article_text">
    <div id="preamble">
<div class="sectionbody">
<div class="imageblock" style="text-align:center;">
<div class="content">
<a class="image" href="https://speakerd.s3.amazonaws.com/presentations/035a8c526e5b4748a062a266cd4ffd94/collaborative-locon-brno-2k16.pdf">
<img src="https://farm9.staticflickr.com/8830/29558170685_8aa768ec84_z.jpg" alt="https://farm9.staticflickr.com/8830/29558170685_8aa768ec84_z.jpg" />
</a>
</div>
</div>
<div class="paragraph"><p>Yesterday I gave a
<a href="http://conference.libreoffice.org/2016/the-program/sept-8th-thursday/">Collaborative
editing using LibreOfficeKit</a> talk at LibreOffice conference 2016, in the
development track. There were many interested parties&#8201;&#8212;&#8201;not a surprise, as
this is the power horse behind LibreOffice Online. :-)</p></div>
</div>
</div>

  </div>
</article>
<hr />
<article>
  <div class="article_title">
    <h1><a href="https://vmiklos.hu/blog/locon2016.html">Improved digital signature handling in LibreOffice LOCon talk</a></h1>
  </div>
  <div class="article_meta">
    <p>Posted on: Thu 08 September 2016</p>
  </div>
  <div class="article_readtime">
    <p>Estimated read time: 1 minutes</p>
  </div>
  <div class="article_text">
    <div id="preamble">
<div class="sectionbody">
<div class="imageblock" style="text-align:center;">
<div class="content">
<a class="image" href="https://speakerd.s3.amazonaws.com/presentations/d7946ac560054fcb9f9a3953f079d9a7/xmlsec-locon-brno-2k16.pdf">
<img src="https://farm9.staticflickr.com/8646/29432546522_585a16f89a_z.jpg" alt="https://farm9.staticflickr.com/8646/29432546522_585a16f89a_z.jpg" />
</a>
</div>
</div>
<div class="paragraph"><p>Earlier today I gave a
<a href="http://conference.libreoffice.org/2016/the-program/sept-8th-thursday/">Improved
digital signature handling in LibreOffice</a> talk at LibreOffice conference
2016, in the development track. The room was well-crowded&#8201;&#8212;&#8201;seems this year
classification was a hot topic. ;-)</p></div>
<div class="paragraph"><p>Quite some pictures are now available <a href="https://twitter.com/libreoffice">on</a>
<a href="https://twitter.com/CollaboraOffice">Twitter</a>, don&#8217;t miss them.</p></div>
</div>
</div>

  </div>
</article>
<hr />
<article>
  <div class="article_title">
    <h1><a href="https://vmiklos.hu/blog/libreoffice-xmlsec.html">LibreOffice now bundles the latest libxmlsec version</a></h1>
  </div>
  <div class="article_meta">
    <p>Posted on: Fri 05 August 2016</p>
  </div>
  <div class="article_readtime">
    <p>Estimated read time: 1 minutes</p>
  </div>
  <div class="article_text">
    <div id="preamble">
<div class="sectionbody">
<div class="paragraph"><p>I wrote about how LibreOffice uses the <a href="https://www.aleksey.com/xmlsec/">XMLSec
Library</a> in an
<a href="https://vmiklos.hu/blog/libreoffice-sha256-signatures.html">earlier post</a> from
March. There are two long-term goals regarding xmlsec in LibreOffice:</p></div>
<div class="ulist"><ul>
<li>
<p>
bundle the latest xmlsec version, instead the one from 2009
</p>
</li>
<li>
<p>
upstream enough of the patches, so building &amp; running against xmlsec as
  provided by a Linux distro also works
</p>
</li>
</ul></div>
<div class="paragraph"><p>I&#8217;m happy to say that the first goal is now reached:</p></div>
<div class="ulist"><ul>
<li>
<p>
libreoffice-5-1 bundled xmlsec 1.2.14 from 2009
</p>
</li>
<li>
<p>
libreoffice-5-2 bundles xmlsec 1.2.20 from 2014
</p>
</li>
<li>
<p>
master bundles the latest xmlsec 1.2.22, released earlier this year :-)
</p>
</li>
</ul></div>
<div class="paragraph"><p>This is good, as this way it&#8217;s easier to integrate xmlsec upstream
improvements into LibreOffice in the future.</p></div>
<div class="paragraph"><p>Regarding the other goal, shrinking the patch list is still to be done. ;-)</p></div>
</div>
</div>

  </div>
</article>
<hr />
<article>
  <div class="article_title">
    <h1><a href="https://vmiklos.hu/blog/libreoffice-asan-setup.html">A LibreOffice / AddressSanitizer setup</a></h1>
  </div>
  <div class="article_meta">
    <p>Posted on: Mon 25 July 2016</p>
  </div>
  <div class="article_readtime">
    <p>Estimated read time: 4 minutes</p>
  </div>
  <div class="article_text">
    <div id="preamble">
<div class="sectionbody">
<div class="paragraph"><p><a href="https://github.com/google/sanitizers">sanitizers</a> (ASAN, UBSAN, etc.) is a
collection of tools to detect memory corruption bugs, undefined behavior and
more by instrumenting the code generated by the compiler. (That&#8217;s the main
difference from valgrind.) From LibreOffice&#8217;s perspective one more important
difference is that there is a
<a href="http://ci.libreoffice.org/job/lo_ubsan/">Jenkins_Linux_Ubsan</a> tinderbox that
makes sure that the master branch is kept clean from errors detected by a
given configuration.</p></div>
<div class="paragraph"><p>So when the tinderbox failed after a commit of mine, I wanted to set up a
similar environment locally, reproduce and fix the bug, and push the fix once
I saw that the fix indeed solves the problem. You can set many options both at
build and runtime, so while we have some
<a href="https://wiki.documentfoundation.org/Development/-fsanitize">documentation</a> on
the TDF wiki (and also Stephan was kind enough to share
<a href="https://people.freedesktop.org/~vmiklos/2016/sanitizers-config-sberg">his
config</a>) on how to use these sanitizers, it wasn&#8217;t clear to me what to do step
by step. So here is one possible setup that worked for me&#8201;&#8212;&#8201;in my case I
wanted to reproduce a stack-use-after-return problem. If you haven&#8217;t ever built
LibreOffice before, then go to
<a href="https://wiki.documentfoundation.org/Development">the Development wiki page</a>,
first do a normal build, and if everything went fine, came back here.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_build_options">Build options</h2>
<div class="sectionbody">
<div class="paragraph"><p>My <code>autogen.input</code> looks like this:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>CC=clang -fsanitize=address
CXX=clang++ -fsanitize=address
--enable-dbgutil
--disable-firebird-sdbc</code></pre>
</div></div>
<div class="paragraph"><p>Which is a normal clang debug build, except:</p></div>
<div class="ulist"><ul>
<li>
<p>
you need to add <code>-fsanitize=...</code> to <code>CXX</code> (not to <code>CXXFLAGS</code>), as explained
  on the wiki
</p>
</li>
<li>
<p>
you need to explicitly disable Firebird integration for now
</p>
</li>
</ul></div>
</div>
</div>
<div class="sect1">
<h2 id="_building">Building</h2>
<div class="sectionbody">
<div class="paragraph"><p>My first attempt failed at build time, as even the tools used only during the
build are instrumented, and some memory leak was detected there, which means
the build aborted before reaching the problem I was interested in. To disable
leak detection during build, and disable parallelism (I needed this, as I did
the build in the background while using the machine for something else):</p></div>
<div class="listingblock">
<div class="content">
<pre><code>make build-nocheck ASAN_OPTIONS=detect_leaks=0 PARALLELISM=1</code></pre>
</div></div>
<div class="paragraph"><p>This also means that I explicitly disabled running any tests, as I knew which
is the single unit test I want to run for the purposes of reproducing and
fixing the problem.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_testing">Testing</h2>
<div class="sectionbody">
<div class="paragraph"><p>Once the build completed, it turns out that the stack-use-after-return detection is disabled at runtime by default, which means I could not see any problem locally. Here is the commandline to run one specific CppunitTest with this detection on:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>cd sw; make -sr CppunitTest_sw_tiledrendering ASAN_OPTIONS=detect_leaks=0:detect_stack_use_after_return=1</code></pre>
</div></div>
<div class="paragraph"><p>Again, this is just one possible setup, you can use other <code>-fsanitize=...</code>
options, other environment variables during build and during testing&#8201;&#8212;&#8201;but
hopefully it helps in the future to avoid pushing fixes for such problems
detected by sanitizers just blindly.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_update_2019_01_25">Update, 2019-01-25</h2>
<div class="sectionbody">
<div class="paragraph"><p>The above described "do it yourself" way doesn&#8217;t work with LibreOffice master
(towards 6.3) and openSUSE Leap 15.0 anymore. I tried to debug what is the
exact problem, but there are many moving parts here:</p></div>
<div class="ulist"><ul>
<li>
<p>
gcc version (providing libstdc++)
</p>
</li>
<li>
<p>
clang version (5.0.2 is too old; 7 failed to build the plugins, trunk
  towards 9 also generated false positives for me)
</p>
</li>
<li>
<p>
various sanitizer-related environment variables
</p>
</li>
<li>
<p>
various sanitizer-related compiler options
</p>
</li>
</ul></div>
<div class="paragraph"><p>So it&#8217;s much easier to just use the combination used by the
<code>Jenkins_Linux_Ubsan</code> tinderbox than something custom. Doing that is
reasonably straightforward, but still there are a couple of non-trivial steps.
What worked for me is:</p></div>
<div class="ulist"><ul>
<li>
<p>
Set up LODE according to its
  <a href="https://wiki.documentfoundation.org/Development/lode">wiki page</a>.
</p>
</li>
<li>
<p>
Instead of plain <code>./setup --dev</code>, do:
</p>
</li>
</ul></div>
<div class="listingblock">
<div class="content">
<pre><code>./setup --jenkins
./setup --jenkins-san
./setup --dev
cd $LODE_HOME/dev/core</code></pre>
</div></div>
<div class="paragraph"><p>This will build a working version of both gcc and clang for you.</p></div>
<div class="ulist"><ul>
<li>
<p>
Instead of manually setting up the environment variables, do:
</p>
</li>
</ul></div>
<div class="listingblock">
<div class="content">
<pre><code>. $LODE_HOME/bin/lode_ubsan_env</code></pre>
</div></div>
<div class="ulist"><ul>
<li>
<p>
Instead of manually setting autogen options, use this autogen.input:
</p>
</li>
</ul></div>
<div class="listingblock">
<div class="content">
<pre><code>--with-distro=Jenkins/Linux_ubsan_master</code></pre>
</div></div>
<div class="ulist"><ul>
<li>
<p>
Finally to build the code and run a specific test based on tinderbox mail:
</p>
</li>
</ul></div>
<div class="listingblock">
<div class="content">
<pre><code>make build-nocheck
cd sw; make -sr CppunitTest_sw_unowriter CPPUNIT_TEST_NAME="testPasteListener"</code></pre>
</div></div>
</div>
</div>
<div class="sect1">
<h2 id="_update_2019_11_14">Update, 2019-11-14</h2>
<div class="sectionbody">
<div class="paragraph"><p>The 2019-01-25 setup can be fine-tuned further. Sadly LODE mixes two goals: setting up dependencies
/ environment and cloning repos. I recently added support for bypassing any cloning, so you can use
LODE even if you already built the code and want to keep using your own way. The tricks are:</p></div>
<div class="ulist"><ul>
<li>
<p>
Use <a href="https://github.com/vmiklos/vmexam/blob/master/libreoffice/autogen.env-san">autogen.env-san</a> in
  two ways: first comment out the second half to run the above <code>./setup --jenkins &amp;&amp; ./setup
  --jenkins-san</code>, then to source the full environment. This means you get all the up to date
  environment variables from LODE, but you don&#8217;t need a chroot to avoid LODE messing up your
  environment.
</p>
</li>
<li>
<p>
Use <a href="https://github.com/vmiklos/vmexam/blob/master/libreoffice/autogen.input-san">autogen.input-san</a>
  to again inherit all up to date autogen switches from LODE, but avoid the submodule pain that
  would be the default. Now you can do a <code>make check gb_SUPPRESS_TESTS=y</code> to build (but not run) all
  the code &amp; tests.
</p>
</li>
<li>
<p>
Use <a href="https://github.com/vmiklos/vmexam/blob/master/collaboraonline/up.sh">up.sh</a> to
  build and run all Online code &amp; tests&#8201;&#8212;&#8201;with new enough
  <a href="https://git.libreoffice.org/core/commit/1ad3f6b8d9e0ef1e921c3ed5526ea352d67265cf">core.git master</a>
  and <a href="https://git.libreoffice.org/online/commit/2bba146b28599481dd81fb0d1f57c0a856827107">online.git
  master</a> the online.git <code>make check</code> passes for me in this environment.
</p>
</li>
</ul></div>
<div class="paragraph"><p>I believe this setup mostly delegates (envrionment, config switches and toolchain) maintenance to
LODE, still allows not running in a chroot and managing your git clones without LODE.</p></div>
</div>
</div>

  </div>
</article>
<hr />
<article>
  <div class="article_title">
    <h1><a href="https://vmiklos.hu/blog/vc-voc-oc.html">On LibreOffice's ViewContact/ViewObjectContact/ObjectContact</a></h1>
  </div>
  <div class="article_meta">
    <p>Posted on: Mon 18 July 2016</p>
  </div>
  <div class="article_readtime">
    <p>Estimated read time: 1 minutes</p>
  </div>
  <div class="article_text">
    <div id="preamble">
<div class="sectionbody">
<div class="imageblock" style="text-align:center;">
<div class="content">
<a class="image" href="https://farm9.staticflickr.com/8833/28305552801_1d518e31ae_o.png">
<img src="https://farm9.staticflickr.com/8833/28305552801_21343667ff_z.jpg" alt="https://farm9.staticflickr.com/8833/28305552801_21343667ff_z.jpg" />
</a>
</div>
</div>
<div class="paragraph"><p>I&#8217;ve recently
<a href="https://gerrit.libreoffice.org/gitweb?p=core.git;a=commit;h=ac0b3b05ab52d0ac06137cf93d71187c7957ec99">fixed</a>
a missing-repaint problem in LibreOffice&#8217;s headless backend, but the root
cause wasn&#8217;t close to the symptom I saw first. Part of the debugging process
was to understand what&#8217;s the relation between <code>sdr::contact::ViewContact</code>,
<code>sdr::contact::ViewObjectContact</code> and <code>sdr::contact::ObjectContact</code>.</p></div>
<div class="paragraph"><p>See
<a href="http://www.openoffice.org/marketing/ooocon2006/presentations/wednesday_g11.odp">this
old presentation</a> and the <a href="https://gerrit.libreoffice.org/27190">review of my
documentation update</a> for the details, but the short version is that:</p></div>
<div class="ulist"><ul>
<li>
<p>
somewhat confusingly, <code>sdr::contact::ViewContact</code> is part of the <strong>model</strong>, and
  there is one <code>sdr::contact::ViewContact</code> object per shape
</p>
</li>
<li>
<p>
<code>sdr::contact::ViewObjectContact</code> is part of a view, and there is one
  <code>sdr::contact::ViewObjectContact</code> per shape, per view
</p>
</li>
<li>
<p>
finally <code>sdr::contact::ObjectContact</code> is part of a <strong>view</strong>, and there is one
  <code>sdr::contact::ObjectContact</code> per view
</p>
</li>
</ul></div>
<div class="paragraph"><p>So the answer to my original <em>Is it normal that I have two object contacts and
a single view contact for a shape and two views?</em> question is: yes, that&#8217;s
expected. ;-) Hopefully the updated documentation is now more clear, the
incorrect 1:N relation in the original class diagram first confused me.</p></div>
</div>
</div>

  </div>
</article>
<hr />
<article>
  <div class="article_title">
    <h1><a href="https://vmiklos.hu/blog/rtf-share-import-scale-flip.html">RTF shape import: group scaling and flip in LibreOffice Writer</a></h1>
  </div>
  <div class="article_meta">
    <p>Posted on: Mon 27 June 2016</p>
  </div>
  <div class="article_readtime">
    <p>Estimated read time: 1 minutes</p>
  </div>
  <div class="article_text">
    <div id="preamble">
<div class="sectionbody">
<div class="paragraph"><p>Some kind of simple logo was
<a href="https://bugs.documentfoundation.org/show_bug.cgi?id=91684">reported</a> to be
mis-imported in the RTF filter, it looked like this:</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="https://farm8.staticflickr.com/7451/27320164444_f437d0418e_o.png" alt="https://farm8.staticflickr.com/7451/27320164444_f437d0418e_o.png" />
</div>
</div>
<div class="paragraph"><p>which is interesting, but the reference output is different:</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="https://farm8.staticflickr.com/7317/27898228066_f5918e59bf_o.png" alt="https://farm8.staticflickr.com/7317/27898228066_f5918e59bf_o.png" />
</div>
</div>
<div class="paragraph"><p>With a bit of investigation, it turns out this was a flipped group shape with
a few rectangles, so the mis-rendering of the logo was due to two independent
problems. The first is that the child shapes inside a group shape were scaled
incorrectly. See the
<a href="https://cgit.freedesktop.org/libreoffice/core/commit/?id=c3acc06230169f141930945ebbff43b1a88dfdee">commit</a>
for the exact details, after fixing scaling, it looked closer to the original:</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="https://farm8.staticflickr.com/7301/27320164424_4ce2ced16c_o.png" alt="https://farm8.staticflickr.com/7301/27320164424_4ce2ced16c_o.png" />
</div>
</div>
<div class="paragraph"><p>The second problem was that the group itself was flipped, and this was again
ignored on import. After
<a href="https://cgit.freedesktop.org/libreoffice/core/commit/?id=63965d7dc571c7dce999980737f9d57a7c5151da">fixing</a>
that problem:</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="https://farm8.staticflickr.com/7228/27898228076_f89fabeb00_o.png" alt="https://farm8.staticflickr.com/7228/27898228076_f89fabeb00_o.png" />
</div>
</div>
<div class="paragraph"><p>the result is basically the same as the reference. Both fixes are not only on
master (towards LibreOffice 5.3) but also backported to LibreOffice 5.2. :-)</p></div>
</div>
</div>

  </div>
</article>
<hr />
<article>
  <div class="article_title">
    <h1><a href="https://vmiklos.hu/blog/classification-toolbar-multicat.html">Classification toolbar in LibreOffice: Multiple Categories</a></h1>
  </div>
  <div class="article_meta">
    <p>Posted on: Thu 02 June 2016</p>
  </div>
  <div class="article_readtime">
    <p>Estimated read time: 2 minutes</p>
  </div>
  <div class="article_text">
    <div id="preamble">
<div class="sectionbody">
<div class="imageblock" style="text-align:center;">
<div class="content">
<a class="image" href="https://farm8.staticflickr.com/7073/26791252053_5cd37892f2_o.png">
<img src="https://farm8.staticflickr.com/7073/26791252053_46f2c7d4ae_z.jpg" alt="https://farm8.staticflickr.com/7073/26791252053_46f2c7d4ae_z.jpg" />
</a>
</div>
</div>
<div class="paragraph"><p>I explained the concept of the classification toolbar appearing in LibreOffice
5.2 in a <a href="https://vmiklos.hu/blog/classification-toolbar.html">previous post</a>.
One incremental update on top of that is support for multiple categories,
which I&#8217;m describing here.</p></div>
<div class="paragraph"><p><a href="https://www.tscp.org/">TSCP</a> in its
<a href="http://www.tscp.org/wp-content/uploads/2013/08/TSCP_BAILSv1.pdf">BAILSv1</a> spec
defines 3 different policy types (IntellectualProperty, NationalSecurity and
ExportControl), and you can set different classification categories for
different policy types. Giving a practical example, if you&#8217;re communicating
with someone, then you can declare what policy type will you be using for that
communication, and tag a single document multiple times, once for all used
policy types.</p></div>
<div class="paragraph"><p>This multiple-categories feature wasn&#8217;t supported by LibreOffice previously,
we simply read the IntellectualProperty type from the document, and also only
wrote that. Now the user interface still reacts to the IntellectualProperty
policy type (since in case there are multiple policies and each of them wants
a different e.g. watermark, the UI has to pick one in some way), but other
than that we read all types from the document, all values are shown on the
toolbar and of course you can also set all of them.</p></div>
<div class="paragraph"><p>All internal APIs and the <code>.uno</code> command that can be used from macros take a
type parameter to get/set a given type of category, if wanted.  As usual, you
can try this right now with a 5.2 or
<a href="http://dev-builds.libreoffice.org/daily/master/">5.3 daily build</a>. :-)</p></div>
</div>
</div>

  </div>
</article>

<footer>
<div id="paginator">
<a href="https://vmiklos.hu/blog/tag/en12.html" class="button_accent">&larr; Older Posts</a>

<a href="https://vmiklos.hu/blog/tag/en10.html" class="button_accent">Newer Posts &rarr;</a>
</div>
</footer>

    <div id="ending_message">
      <p>&copy; Miklos Vajna. Built using <a href="http://getpelican.com" target="_blank">Pelican</a>. Theme by Giulio Fidente on <a href="https://github.com/gfidente/pelican-svbhack" target="_blank">github</a>. </p>
    </div>
  </main>
</body>
</html>