<!DOCTYPE html>
<html lang="en">

<head>
  <!-- ## for client-side less
  <link rel="stylesheet/less" type="text/css" href="https://vmiklos.hu/blog/theme/css/style.less">
  <script src="http://cdnjs.cloudflare.com/ajax/libs/less.js/1.7.3/less.min.js" type="text/javascript"></script>
  -->
  <link rel="stylesheet" type="text/css" href="https://vmiklos.hu/blog/theme/css/style.css">
  <link rel="stylesheet" type="text/css" href="https://vmiklos.hu/blog/theme/css/pygments.css">

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="author" content="Miklos Vajna">
  <meta name="description" content="Posts and writings by Miklos Vajna">

  <link href="https://vmiklos.hu/blog/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="What is Miklos hacking RSS" />


  <title>
    What is Miklos hacking
&ndash; Tag: en  </title>

<script type="text/javascript">
  var _paq = window._paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="//analytics.vmiklos.hu/";
    _paq.push(['setTrackerUrl', u+'matomo.php']);
    _paq.push(['setSiteId', '1']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
</head>

<body>
  <aside>
    <div id="user_meta">
      <h2><a href="https://vmiklos.hu/blog">What is Miklos hacking</a></h2>
      <p></p>
      <ul>
        <li><a href="/" target="_blank">Root</a></li>
        <li><a href="https://planet.documentfoundation.org/" target="_blank">LibreOffice Blogs</a></li>
      </ul>
    </div>
  </aside>

  <main>
    <header>
      <p>
      <a href="https://vmiklos.hu/blog">Index</a> &brvbar; <a href="https://vmiklos.hu/blog/archives.html">Archives</a>
      &brvbar; <a href="https://vmiklos.hu/blog/feeds/all.rss.xml">RSS</a>
&gt; Tag: en
      </p>
    </header>

<article>
  <div class="article_title">
    <h1><a href="https://vmiklos.hu/blog/sw-semi-transparent-text.html">Semi-transparent text in Writer</a></h1>
  </div>
  <div class="article_meta">
    <p>Posted on: Wed 26 February 2020</p>
  </div>
  <div class="article_readtime">
    <p>Estimated read time: 1 minutes</p>
  </div>
  <div class="article_text">
    <div class="sect1">
<h2 id="_the_problem">The problem</h2>
<div class="sectionbody">
<div class="paragraph"><p>Last year I <a href="https://vmiklos.hu/blog/sd-semi-transparent-text.html">posted</a> about work to have
semi-transparent rendering of not only shape fill and shape borders, but also shape text in Draw.
Now the same semi-transparent text feature is available in Writer as well. This improves
compatibility with Word, which supports the same feature in its DOCX format. You can access the new
option in the Format &#8594; Character dialog.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_result">Result</h2>
<div class="sectionbody">
<div class="paragraph"><p>Here is how the new, old and reference rendering looks like:</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="https://lh3.googleusercontent.com/oifzSVcdmKhomkQQKy4CNnPmamHtoo9CwRsbg9_ekbeK9Ov_4dFrzrJrYmDLHZNm-IvsoYNy8YfSs5kp4yEA42jybRO-8P-YKI8fYRu5ColRbzFHQBotP4MvkjanZG7JX9vP8Mcnnw=w640" alt="https://lh3.googleusercontent.com/oifzSVcdmKhomkQQKy4CNnPmamHtoo9CwRsbg9_ekbeK9Ov_4dFrzrJrYmDLHZNm-IvsoYNy8YfSs5kp4yEA42jybRO-8P-YKI8fYRu5ColRbzFHQBotP4MvkjanZG7JX9vP8Mcnnw=w640" />
</div>
<div class="title">Figure 1. Semi-transparent text in Writer, new rendering</div>
</div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="https://lh3.googleusercontent.com/RxtyxxIdrW14TtN30cf37e7RNHwnQpxlX-zhjhpWrggjStEERXvUnH7eDv8acM_8DcySNpnvpz5yWdwO12_cmQ6ZyCo4-fpIOdd3x9Q8SAXxAwuyMhfmjzhvS9VDBps8tQX-xB70RA=w640" alt="https://lh3.googleusercontent.com/RxtyxxIdrW14TtN30cf37e7RNHwnQpxlX-zhjhpWrggjStEERXvUnH7eDv8acM_8DcySNpnvpz5yWdwO12_cmQ6ZyCo4-fpIOdd3x9Q8SAXxAwuyMhfmjzhvS9VDBps8tQX-xB70RA=w640" />
</div>
<div class="title">Figure 2. Semi-transparent text in Writer, old rendering</div>
</div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="https://lh3.googleusercontent.com/6rkCyXnzfiVN96D1h8PiKSIva1ydRFQXzUbXbbLC-9plXOUJnMRHZT2ba4eKt7W1wqfL3vscVgE1-QB5ztbp2uqSmguOALV8wyZDnCF4LPlyHSbVEm5atwZvf29w3PzRmjy11aQahA=w640" alt="https://lh3.googleusercontent.com/6rkCyXnzfiVN96D1h8PiKSIva1ydRFQXzUbXbbLC-9plXOUJnMRHZT2ba4eKt7W1wqfL3vscVgE1-QB5ztbp2uqSmguOALV8wyZDnCF4LPlyHSbVEm5atwZvf29w3PzRmjy11aQahA=w640" />
</div>
<div class="title">Figure 3. Semi-transparent text in Writer, reference rendering</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_want_to_start_using_this">Want to start using this?</h2>
<div class="sectionbody">
<div class="paragraph"><p>You can get a snapshot / demo of Collabora Office and try it out yourself right now:
<a href="https://www.collaboraoffice.com/collabora-office-latest-snapshot/">try unstable snapshot</a>.  Collabora
is a major contributor to LibreOffice and all of this work will be available in TDF&#8217;s next release
too (7.0).</p></div>
</div>
</div>

  </div>
</article>
<hr />
<article>
  <div class="article_title">
    <h1><a href="https://vmiklos.hu/blog/sw-autorowheight-rotatedtext.html">Improved rotated text handling in Writer's table rows with automatic height</a></h1>
  </div>
  <div class="article_meta">
    <p>Posted on: Fri 24 January 2020</p>
  </div>
  <div class="article_readtime">
    <p>Estimated read time: 2 minutes</p>
  </div>
  <div class="article_text">
    <div id="preamble">
<div class="sectionbody">
<div class="paragraph"><p>Writer now has better support for rotated text in tables containing rows with automatic height. This
post also presents two related fixes.</p></div>
<div class="paragraph"><p>First, thanks <a href="https://www.otevrenamesta.cz/">Otevřená města</a> who made this work by
<a href="https://www.collaboraoffice.com/">Collabora</a> possible.</p></div>
<div class="paragraph"><p>Before diving into improved rotated text handling, first a continuous section break import problem
(<a href="https://bugs.documentfoundation.org/show_bug.cgi?id=128605">tdf#128605</a>) was fixed: this was a case
when we created a new page style, but only a new section was intended. Here is how the fix looks:</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="https://lh3.googleusercontent.com/ycsIqjpdm5t2n9FQQhKBbWobpsX2cQ0s-ugLn970XwuGafzL79HzNVly6dYUpLMhTQmZq8Aa36kaGIfWfk-MzYmuSr92zhRUxFk1aNqwDOnTy1cyyrRzCguuvp-Wd3LD8XXzo_Aurg=w640" alt="https://lh3.googleusercontent.com/ycsIqjpdm5t2n9FQQhKBbWobpsX2cQ0s-ugLn970XwuGafzL79HzNVly6dYUpLMhTQmZq8Aa36kaGIfWfk-MzYmuSr92zhRUxFk1aNqwDOnTy1cyyrRzCguuvp-Wd3LD8XXzo_Aurg=w640" />
</div>
<div class="title">Figure 1. Importing continuous section break, fixed</div>
</div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="https://lh3.googleusercontent.com/jLUVDTY3Z6-IWVCmSfia7ue_aSpXSG7YJK2WqhRCfJkdTgA3cVFRh8TiYZwKRut7vvC0yFkdGBzl9Wpv2auZpg6d84nmDI1gVHBZPmWsf_YA-5qD-SF8Uf2lBG7NOu9RcidR1bQ0ng=w640" alt="https://lh3.googleusercontent.com/jLUVDTY3Z6-IWVCmSfia7ue_aSpXSG7YJK2WqhRCfJkdTgA3cVFRh8TiYZwKRut7vvC0yFkdGBzl9Wpv2auZpg6d84nmDI1gVHBZPmWsf_YA-5qD-SF8Uf2lBG7NOu9RcidR1bQ0ng=w640" />
</div>
<div class="title">Figure 2. Importing continuous section break, original</div>
</div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="https://lh3.googleusercontent.com/izfhxSHtYg_QmeJdIY_NnX5uiaRsmDHQoPlAsofQSaLJERNzVq_gkOMShR-fzckvAd6E5D-ZEMbr41Db2PEMeUZA8gL-oqJsvf_3PytuxJhL95wz4Fsh-2JakWefx4Tes2MoHlFWWw=w640" alt="https://lh3.googleusercontent.com/izfhxSHtYg_QmeJdIY_NnX5uiaRsmDHQoPlAsofQSaLJERNzVq_gkOMShR-fzckvAd6E5D-ZEMbr41Db2PEMeUZA8gL-oqJsvf_3PytuxJhL95wz4Fsh-2JakWefx4Tes2MoHlFWWw=w640" />
</div>
<div class="title">Figure 3. Importing continuous section break, reference</div>
</div>
<div class="paragraph"><p>What you can see is that the continuous section break used to result in an unwanted page break, and
this is gone now.</p></div>
<div class="paragraph"><p>Regarding the actual rotated text handling
(<a href="https://bugs.documentfoundation.org/show_bug.cgi?id=128611">tdf#128611</a>), there were two problems
there:</p></div>
<div class="ulist"><ul>
<li>
<p>
There was a missing flip handling for line shapes
</p>
</li>
<li>
<p>
Poor layout of rotated text in table cells with automatic height
</p>
</li>
</ul></div>
<div class="paragraph"><p>Here is how the fix looks like:</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="https://lh3.googleusercontent.com/GFCNQDcvXsN2w1ADVo10H16FUOYB8i6jBTrPad0r6qa8nt8PmDBDD1oiDfG9Zs9_3eVqdyB-O-u6oWIBAujcyso2utvnDpdE4Bs2PykeJkbh0vSYMZDSIKsjv7vI06j9HUCru2Z19w=w640" alt="https://lh3.googleusercontent.com/GFCNQDcvXsN2w1ADVo10H16FUOYB8i6jBTrPad0r6qa8nt8PmDBDD1oiDfG9Zs9_3eVqdyB-O-u6oWIBAujcyso2utvnDpdE4Bs2PykeJkbh0vSYMZDSIKsjv7vI06j9HUCru2Z19w=w640" />
</div>
<div class="title">Figure 4. Rotated text in table cells with auto height, fixed (both flip of line and text layout)</div>
</div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="https://lh3.googleusercontent.com/IqsWjKbTD03_wnvUMUe_QK1pqdTfZKizoNEHRQDQuvpw_O8mrEQ8AgNk_2qbP49QUpezknqHDxnhn0eYDpfZL833dXaClRPD1e4_wxuTj5mTRTeEgioBCX0djcWa5vNSRdPmnalphA=w640" alt="https://lh3.googleusercontent.com/IqsWjKbTD03_wnvUMUe_QK1pqdTfZKizoNEHRQDQuvpw_O8mrEQ8AgNk_2qbP49QUpezknqHDxnhn0eYDpfZL833dXaClRPD1e4_wxuTj5mTRTeEgioBCX0djcWa5vNSRdPmnalphA=w640" />
</div>
<div class="title">Figure 5. Rotated text in table cells with auto height, fixed (only flip of line so far)</div>
</div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="https://lh3.googleusercontent.com/2Tkkj7oz9Bm9ckPs5lTGwAGBRokEJ0MWxfqrbqu6afp6Xm1I77zft8riW-kTxKo4kJsO6bwMtaZb0XNToFssEc1kkZuzm0qk0H4eLU-xk8DOd-e5eVMtNR6cYD_1FRDWbCIYok1oJg=w640" alt="https://lh3.googleusercontent.com/2Tkkj7oz9Bm9ckPs5lTGwAGBRokEJ0MWxfqrbqu6afp6Xm1I77zft8riW-kTxKo4kJsO6bwMtaZb0XNToFssEc1kkZuzm0qk0H4eLU-xk8DOd-e5eVMtNR6cYD_1FRDWbCIYok1oJg=w640" />
</div>
<div class="title">Figure 6. Rotated text in table cells with auto height, original</div>
</div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="https://lh3.googleusercontent.com/m3X4dGiUTsFBnVwQhiEpcAQYGAJ_8vbKN93jivrcsKcCvjaornrk0upCvsTmck1e39XISyuYNc47BF1tuyrskoWLuMhpegtbyPh1KjBD7_wD-oLueaaLbjYnrgReSRkS5krvK1y4LQ=w640" alt="https://lh3.googleusercontent.com/m3X4dGiUTsFBnVwQhiEpcAQYGAJ_8vbKN93jivrcsKcCvjaornrk0upCvsTmck1e39XISyuYNc47BF1tuyrskoWLuMhpegtbyPh1KjBD7_wD-oLueaaLbjYnrgReSRkS5krvK1y4LQ=w640" />
</div>
<div class="title">Figure 7. Rotated text in table cells with auto height, reference</div>
</div>
<div class="paragraph"><p>What you can see is that the line clearing the table cell had a vertical flip, which was lost on
import. Also, the rotated text in the "row heading" cells was broken into multiple columns. Both are
fixed now.</p></div>
<div class="paragraph"><p>All this is available in LibreOffice master (towards 6.4), so you can try it out
<a href="http://dev-builds.libreoffice.org/daily/master/">right now</a>, if interested.</p></div>
</div>
</div>

  </div>
</article>
<hr />
<article>
  <div class="article_title">
    <h1><a href="https://vmiklos.hu/blog/sd-semi-transparent-text.html">Semi-transparent text in Draw/Impress</a></h1>
  </div>
  <div class="article_meta">
    <p>Posted on: Fri 20 December 2019</p>
  </div>
  <div class="article_readtime">
    <p>Estimated read time: 1 minutes</p>
  </div>
  <div class="article_text">
    <div id="preamble">
<div class="sectionbody">
<div class="paragraph"><p>Draw/Impress now has
<a href="https://git.libreoffice.org/core/commits/3e5bedbb6910053c0cee4112cd382fbd035c9832..6dbb317ebec681d236c6ce354f581108fd814f7b">support</a>
for semi-transparent shape text, next to the existing transparency support in the context of shape
fill colors and shape border colors.</p></div>
<div class="paragraph"><p>First, thanks <a href="https://vector.com/">Vector</a> who made this work by
<a href="https://www.collaboraoffice.com/">Collabora</a> possible.</p></div>
<div class="paragraph"><p>Here is how it looks:</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="https://lh3.googleusercontent.com/FJ55-BJ_Mc75TiyrPYuvtOscHOqFp81sEI4SfJvybPzaXG5Y2n4mIoLRzkXydEEmtEf--l9s_h-L4CyYjuGpTyOngOTi8YAzIFp8bQBEn0k2DWsRzJHLdfttf74wTbdPgZUzgSnOYQ=w640" alt="https://lh3.googleusercontent.com/FJ55-BJ_Mc75TiyrPYuvtOscHOqFp81sEI4SfJvybPzaXG5Y2n4mIoLRzkXydEEmtEf--l9s_h-L4CyYjuGpTyOngOTi8YAzIFp8bQBEn0k2DWsRzJHLdfttf74wTbdPgZUzgSnOYQ=w640" />
</div>
<div class="title">Figure 1. Semi-transparent text in Draw</div>
</div>
<div class="paragraph"><p>What you can see is that next to the existing character color, now you can also set a transparency
percentage to decide if the text should be entirely transparent, entirely opaque or something
between the two.</p></div>
<div class="paragraph"><p>The primary focus was Draw in this case, but this also helps PPTX support, as the importer/exporter
now handles this for Impress documents as well.</p></div>
<div class="paragraph"><p>All this is available in LibreOffice master (towards 6.5), so you can try it out
<a href="http://dev-builds.libreoffice.org/daily/master/">right now</a>, if interested.</p></div>
</div>
</div>

  </div>
</article>
<hr />
<article>
  <div class="article_title">
    <h1><a href="https://vmiklos.hu/blog/sd-pptx-better-math.html">Better math import from PPTX into Impress</a></h1>
  </div>
  <div class="article_meta">
    <p>Posted on: Thu 21 November 2019</p>
  </div>
  <div class="article_readtime">
    <p>Estimated read time: 1 minutes</p>
  </div>
  <div class="article_text">
    <div id="preamble">
<div class="sectionbody">
<div class="paragraph"><p>Impress now has a much
<a href="https://gerrit.libreoffice.org/plugins/gitiles/core/+/4038d6c393c3cf6330671124ba69cdba98b24960%5E%21/">improved
math handling</a> in its importer from PPTX, eliminating annoying duplicated objects you had to delete
after import, manually.</p></div>
<div class="paragraph"><p>First, thanks <a href="https://tu-dresden.de/">TU Dresden</a> who made this work by
<a href="https://www.collaboraoffice.com/">Collabora</a> possible.</p></div>
<div class="paragraph"><p>Here is how it looks:</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="https://lh3.googleusercontent.com/zI1fDb7tfl0a-6e1JljnBuCz67cGBSpx3s_tMViW_xWpTjy0FrsLGws-VAXWcdQhmSwXddr9wjADs5UvhNu_sNjETT7VfMJB8pdQ4PxPpHliCVbuMOx67Wwrd6brfE-eJtWIb2K36A=w640" alt="https://lh3.googleusercontent.com/zI1fDb7tfl0a-6e1JljnBuCz67cGBSpx3s_tMViW_xWpTjy0FrsLGws-VAXWcdQhmSwXddr9wjADs5UvhNu_sNjETT7VfMJB8pdQ4PxPpHliCVbuMOx67Wwrd6brfE-eJtWIb2K36A=w640" />
</div>
<div class="title">Figure 1. Impress, new math import from PPTX</div>
</div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="https://lh3.googleusercontent.com/rpC9KOUaadEoYKekczLTZakB98SBwqbKGqmwf_VLY6D-8OpBLh9Lpxi_RDl6CMQHJKqsz0NnxgTN8kn63CB9fGmP6AWUKIqK0huvjoRCxvoh6dtd0BMRXclsWlaKr3jbdzb1TOJ1LQ=w640" alt="https://lh3.googleusercontent.com/rpC9KOUaadEoYKekczLTZakB98SBwqbKGqmwf_VLY6D-8OpBLh9Lpxi_RDl6CMQHJKqsz0NnxgTN8kn63CB9fGmP6AWUKIqK0huvjoRCxvoh6dtd0BMRXclsWlaKr3jbdzb1TOJ1LQ=w640" />
</div>
<div class="title">Figure 2. Reference rendering</div>
</div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="https://lh3.googleusercontent.com/hUBhfLLFPZFDa50EMPEQxl2kih91oKIfQFBxNK7F9uWGexGbUKnV1FMQZgvmj4EctmCwlxlYK56hPSX0RZS_MpOAKZZagmfOALZ3LRrvBgoOGAx9dsM1N3dp9bGvPU7c0WVvROu8iQ=w640" alt="https://lh3.googleusercontent.com/hUBhfLLFPZFDa50EMPEQxl2kih91oKIfQFBxNK7F9uWGexGbUKnV1FMQZgvmj4EctmCwlxlYK56hPSX0RZS_MpOAKZZagmfOALZ3LRrvBgoOGAx9dsM1N3dp9bGvPU7c0WVvROu8iQ=w640" />
</div>
<div class="title">Figure 3. Impress, old math import from PPTX</div>
</div>
<div class="paragraph"><p>What you can see is that the in the old case we managed to read both the actual math object and its
replacement image from PPTX, which caused visible duplication due to working transparency handling.
The new way just imports the math objects, and ignores the replacement graphic.</p></div>
<div class="paragraph"><p>This new way (handling of the OOXML <code>a14</code> feature flag) is enabled by default, except for Calc
documents, where more works is needed before it can be enabled.</p></div>
<div class="paragraph"><p>All this is available in LibreOffice master (towards 6.4), so you can try it out
<a href="http://dev-builds.libreoffice.org/daily/master/">right now</a>, if interested.</p></div>
</div>
</div>

  </div>
</article>
<hr />
<article>
  <div class="article_title">
    <h1><a href="https://vmiklos.hu/blog/sw-continuous-endnotes.html">Continuous endnotes in Writer</a></h1>
  </div>
  <div class="article_meta">
    <p>Posted on: Mon 21 October 2019</p>
  </div>
  <div class="article_readtime">
    <p>Estimated read time: 1 minutes</p>
  </div>
  <div class="article_text">
    <div id="preamble">
<div class="sectionbody">
<div class="paragraph"><p>Writer now has a new "continuous endnotes" compatibility setting in its layout, allowing rendering
endnotes in a way which is closer to what Word users expect.</p></div>
<div class="paragraph"><p>First, thanks <a href="https://tu-dresden.de/">TU Dresden</a> who made this work by
<a href="https://www.collaboraoffice.com/">Collabora</a> possible.</p></div>
<div class="paragraph"><p>Here is how it looks:</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="https://lh3.googleusercontent.com/g4kmuKduOm-Xc5sHH5oBx9y-U8S6hK5pgamrLxG-5fM9XCRJwMJFEPKxWXrG6IzEQLVpHdxCHI0c45EjDax02SpDbIzyQjZvUd-gsvpTWlkgZ0p3Y5-FDXARIPggF0KyIwG1AFwoiQ=w640" alt="https://lh3.googleusercontent.com/g4kmuKduOm-Xc5sHH5oBx9y-U8S6hK5pgamrLxG-5fM9XCRJwMJFEPKxWXrG6IzEQLVpHdxCHI0c45EjDax02SpDbIzyQjZvUd-gsvpTWlkgZ0p3Y5-FDXARIPggF0KyIwG1AFwoiQ=w640" />
</div>
<div class="title">Figure 1. Writer, new ContinuousEndnodes layout flag enabled</div>
</div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="https://lh3.googleusercontent.com/dlUGc11qUKVvvkKXh5mhj9BlEw4bLxgKxW_t3pNAAu2rnuWuIrFtWdlKk-8nadbSur8CaDe-CIUNJiSJlQSTvA22Q89TkY-uRsdJH3EKX6RcyUJsr-W5YqJrVqaM4KgXAIDPxPXPvg=w640" alt="https://lh3.googleusercontent.com/dlUGc11qUKVvvkKXh5mhj9BlEw4bLxgKxW_t3pNAAu2rnuWuIrFtWdlKk-8nadbSur8CaDe-CIUNJiSJlQSTvA22Q89TkY-uRsdJH3EKX6RcyUJsr-W5YqJrVqaM4KgXAIDPxPXPvg=w640" />
</div>
<div class="title">Figure 2. Reference rendering</div>
</div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="https://lh3.googleusercontent.com/odkN2eqFxYthY7qhxHwStIlodTZJmcUa5wzh6p74PWPT6jKtsAmAvZyNzTjwff_CrDm5AtTcdAq_Rw2QyMNQN1Xr_ypIYL_cEZ3g1DRJof9em6acQ1fxrNQWsx_LxUmBhmu4TkTmPw=w640" alt="https://lh3.googleusercontent.com/odkN2eqFxYthY7qhxHwStIlodTZJmcUa5wzh6p74PWPT6jKtsAmAvZyNzTjwff_CrDm5AtTcdAq_Rw2QyMNQN1Xr_ypIYL_cEZ3g1DRJof9em6acQ1fxrNQWsx_LxUmBhmu4TkTmPw=w640" />
</div>
<div class="title">Figure 3. Writer, old separate endnote page layout</div>
</div>
<div class="paragraph"><p>What you can see is that endnotes unconditionally start after the end of the document content in
Word, while endnotes are unconditionally on separate endnote pages in Writer. The new
<code>ContinuousEndnotes</code> layout compatibility flag in Writer allows rendering endnotes the Word way.</p></div>
<div class="paragraph"><p>This new flag is enabled by default for DOC files, disabled otherwise.</p></div>
<div class="paragraph"><p>All this is available in LibreOffice master (towards 6.4), so you can try it out
<a href="http://dev-builds.libreoffice.org/daily/master/">right now</a>, if interested.</p></div>
</div>
</div>

  </div>
</article>
<hr />
<article>
  <div class="article_title">
    <h1><a href="https://vmiklos.hu/blog/sw-shape-allow-overlap.html">Allow-overlap shape property in Writer</a></h1>
  </div>
  <div class="article_meta">
    <p>Posted on: Fri 04 October 2019</p>
  </div>
  <div class="article_readtime">
    <p>Estimated read time: 1 minutes</p>
  </div>
  <div class="article_text">
    <div id="preamble">
<div class="sectionbody">
<div class="paragraph"><p>Writer now has a new "allow overlap" shape property for anchored objects, which can ensure that
objects with overlapping positioning properties don&#8217;t actually overlap.</p></div>
<div class="paragraph"><p>First, thanks <a href="https://tu-dresden.de/">TU Dresden</a> who made this work by
<a href="https://www.collaboraoffice.com/">Collabora</a> possible.</p></div>
<div class="paragraph"><p>Here is a video showing how it works:</p></div>
<div class="imageblock" style="text-align:enter;">
<div class="content">
<a class="image" href="https://youtu.be/DzanTIo941g">
<img src="https://lh3.googleusercontent.com/fdBYhwk3jykbX7drs6Q3ehQsQyAOBk_GWukw3KzcJBlaMsmgVg0C7KHM1uyODgqIro7HSjOnHzV6zfy9RgdMjY1KJW5K_EmfhyB4d-HyadZszIDAhVGbxUe4DMQbemSiZJA2k0h7vw=w640" alt="https://lh3.googleusercontent.com/fdBYhwk3jykbX7drs6Q3ehQsQyAOBk_GWukw3KzcJBlaMsmgVg0C7KHM1uyODgqIro7HSjOnHzV6zfy9RgdMjY1KJW5K_EmfhyB4d-HyadZszIDAhVGbxUe4DMQbemSiZJA2k0h7vw=w640" />
</a>
</div>
<div class="title">Figure 1. Allow-overlap shape property in Writer</div>
</div>
<div class="paragraph"><p>Under the hood, this is a full new Writer feature, since previously shapes were always allowed to
overlap with each other:</p></div>
<div class="ulist"><ul>
<li>
<p>
macros get a new <code>AllowOverlap</code> shape property (true by default)
</p>
</li>
<li>
<p>
layout takes this into account if you set the property on the UI
</p>
</li>
<li>
<p>
both DOCX and ODT filters serialize and load this property
  (<a href="https://issues.oasis-open.org/browse/OFFICE-4047">ODT proposal</a>)
</p>
</li>
</ul></div>
<div class="paragraph"><p>All this is available in LibreOffice master (towards 6.4), so you can try it out
<a href="http://dev-builds.libreoffice.org/daily/master/">right now</a>, if interested.</p></div>
</div>
</div>

  </div>
</article>
<hr />
<article>
  <div class="article_title">
    <h1><a href="https://vmiklos.hu/blog/libocon2019.html">Bottom to top, left to right writing direction in Writer conference talk</a></h1>
  </div>
  <div class="article_meta">
    <p>Posted on: Thu 12 September 2019</p>
  </div>
  <div class="article_readtime">
    <p>Estimated read time: 1 minutes</p>
  </div>
  <div class="article_text">
    <div id="preamble">
<div class="sectionbody">
<div class="imageblock" style="text-align:center;">
<div class="content">
<a class="image" href="https://speakerd.s3.amazonaws.com/presentations/d34ea52e0ebc4d2f898b246ef786f741/btlr-locon-almeria-2k19.pdf">
<img src="https://lh3.googleusercontent.com/7A-ATV-MLBkNG6T7cX7kmq2bd7cgsmUs81plgl1ZXlbQIhonNNWZDFMHB5iMPr3NhtT5S_-TO3HTPLh8mqKfUduGDGEZg0LRwRMZO5POBbqn5133-TDo0FipATD9_hlfFe7J19g9Mw=w640" alt="https://lh3.googleusercontent.com/7A-ATV-MLBkNG6T7cX7kmq2bd7cgsmUs81plgl1ZXlbQIhonNNWZDFMHB5iMPr3NhtT5S_-TO3HTPLh8mqKfUduGDGEZg0LRwRMZO5POBbqn5133-TDo0FipATD9_hlfFe7J19g9Mw=w640" />
</a>
</div>
</div>
<div class="paragraph"><p>Yesterday I gave a
<a href="https://conference.libreoffice.org/2019/program/schedule/sept-11th-wednesday/">Bottom to top, left to
right writing direction in Writer</a> talk at the LibreOffice Conference 2019. The room was
well-crowded&#8201;&#8212;&#8201;perhaps because it was on the first day and in the largest room. ;-)</p></div>
<div class="paragraph"><p>It contains some details which are not available in previous btLr blog posts, like what natural
languages use this direction, how to replace real-world clocks without breaking compatibility and
more!</p></div>
<div class="paragraph"><p>I expect quite some other slides from other Collaborans and the wider community will be available on
<a href="http://planet.documentfoundation.org/">Planet</a>, don&#8217;t miss them.</p></div>
<div class="paragraph"><p>You can get a snapshot / demo of Collabora Office 6.2 and try the presented feature out yourself
right now: <a href="https://www.collaboraoffice.com/collabora-office-latest-snapshot/">try unstable snapshot</a>.
Collabora is a major contributor to LibreOffice and all of this work will be available in TDF&#8217;s next
release, too (6.4).</p></div>
</div>
</div>

  </div>
</article>
<hr />
<article>
  <div class="article_title">
    <h1><a href="https://vmiklos.hu/blog/btlr-text-direction-in-writer-4.html">btLr text direction in Writer, part 4</a></h1>
  </div>
  <div class="article_meta">
    <p>Posted on: Fri 16 August 2019</p>
  </div>
  <div class="article_readtime">
    <p>Estimated read time: 2 minutes</p>
  </div>
  <div class="article_text">
    <div class="sect1">
<h2 id="_the_problem">The problem</h2>
<div class="sectionbody">
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="https://lh3.googleusercontent.com/meDrX3a3jwfCHpHSpQfS7Tqvy7Cxaumoo5RlnjJ7Qj0fhDgPXeOv7FgRn4Xqesv8IWW3feCV-_lhWOyzZo9ZD5yaxkBrYxd9doRm9x8BJAAdu3QQ1Jj6MIiy5q5FO_d2v5YSbsBUvg=w320" alt="https://lh3.googleusercontent.com/meDrX3a3jwfCHpHSpQfS7Tqvy7Cxaumoo5RlnjJ7Qj0fhDgPXeOv7FgRn4Xqesv8IWW3feCV-_lhWOyzZo9ZD5yaxkBrYxd9doRm9x8BJAAdu3QQ1Jj6MIiy5q5FO_d2v5YSbsBUvg=w320" />
</div>
</div>
<div class="paragraph"><p>I already wrote about the btLr text direction in the context of Writer table cells as a result of a
Collabora hack week (<a href="https://vmiklos.hu/blog/hackweek-2019.html">part 1</a>,
<a href="https://vmiklos.hu/blog/btlr-text-direction-in-writer-2.html">part 2</a>,
<a href="https://vmiklos.hu/blog/btlr-text-direction-in-writer-3.html">part 3</a>). This post is meant to be the
final one (for now), given that both table cells and shapes / text frames are now working nicely
with all major formats.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_the_result">The result</h2>
<div class="sectionbody">
<div class="paragraph"><p>The first topic is that whenever I looked at supporting the new bottom-to-top, left-to-right
direction, I always first checked if the more common top-to-bottom, right-to-left direction is
working or not (this is used for e.g. Japanese rotated text). Turns out that Writer text frames were
not exported to drawingML (part of DOCX), so I fixed that.</p></div>
<div class="paragraph"><p>Similarly, there is the older shape markup in DOCX: VML. The tbRl direction from that was broken,
too, now working nicely.</p></div>
<div class="paragraph"><p>Then I could actually look at the btLr import from VML, which is now correct.</p></div>
<div class="paragraph"><p>One of the motivations for this work was to get rid of the old, miserable hack where we did
character-level rotation during import (which falls apart for multi-paragraph text). If the import
mapping in itself is not painful enough, we had to undo the effect of this import hack at export
time. When I could remove the last usage of this dreaded <code>checkFrameBtlr()</code> function in the export
code, I mentally did a little dance. ;-)</p></div>
<div class="paragraph"><p>Back to btLR fixing, exporting Writer text frames to DOCX is not interesting when you do DOCX
editing, but it&#8217;s very much relevant when you do ODT &#8594; DOCX conversion. And the btLr case was of
course not handled, fixed now.</p></div>
<div class="paragraph"><p>RTF was broken in 4 different ways: import and export was broken for the btLr and the tbRl cases for
text frames.</p></div>
<div class="paragraph"><p>The last thing was the binary DOC export, where btLr text frames were not handled.</p></div>
<div class="paragraph"><p>With these sorted out, I think the topic of table cells and shapes / text frames are now supported
reasonably well. ODF could do the btLr writing direction for sections and pages as well, but I don&#8217;t
see that as a priority. And hey, Word doesn&#8217;t support them, either. :-)</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_want_to_start_using_this">Want to start using this?</h2>
<div class="sectionbody">
<div class="paragraph"><p>You can get a snapshot / demo of Collabora Office and try it out yourself right now:
<a href="https://www.collaboraoffice.com/collabora-office-latest-snapshot/">try unstable snapshot</a>.  Collabora
is a major contributor to LibreOffice and all of this work will be available in TDF&#8217;s next release,
too (6.4).</p></div>
</div>
</div>

  </div>
</article>
<hr />
<article>
  <div class="article_title">
    <h1><a href="https://vmiklos.hu/blog/writer-image-comments.html">Commenting on images and charts in Writer</a></h1>
  </div>
  <div class="article_meta">
    <p>Posted on: Tue 16 July 2019</p>
  </div>
  <div class="article_readtime">
    <p>Estimated read time: 1 minutes</p>
  </div>
  <div class="article_text">
    <div class="sect1">
<h2 id="_the_problem">The problem</h2>
<div class="sectionbody">
<div class="paragraph"><p>Years ago I <a href="https://vmiklos.hu/blog/lo-sw-comment-range.html">posted</a> about work to attach comments to
text ranges. This improved compatibility with Word greatly, but it was always a piece of text that
was commented, never frames. If you just selected a frame and tried to comment by selecting the menu
entry or the <code>Ctrl-Alt-C</code> shortcut, nothing happened, because frame selection did not interpret
comment insertion.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_result">Result</h2>
<div class="sectionbody">
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="https://lh3.googleusercontent.com/PvlDM6Ox1UBEXj57F4SyBN5hlv1sjJHjI4VjmwIoM-3btxSR1Uh5HAwch_tw95vDOhdSZnEbDPkuYYAU2iiHvSeHafFtToGQzntEqO8wGgkDgmIOxGBXWw6vdTPQlgPPF3lFd0ES8Q=w640" alt="https://lh3.googleusercontent.com/PvlDM6Ox1UBEXj57F4SyBN5hlv1sjJHjI4VjmwIoM-3btxSR1Uh5HAwch_tw95vDOhdSZnEbDPkuYYAU2iiHvSeHafFtToGQzntEqO8wGgkDgmIOxGBXWw6vdTPQlgPPF3lFd0ES8Q=w640" />
</div>
<div class="title">Figure 1. Comment on an at-char anchored image in Writer</div>
</div>
<div class="paragraph"><p>Examples for frames are images or charts. This needs explicit handling, so at the moment the at-char
and as-char anchor types are supported, and you can simply insert the comment to a frame once the
frame is selected. This works in both desktop Writer and Online.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_want_to_start_using_this">Want to start using this?</h2>
<div class="sectionbody">
<div class="paragraph"><p>You can get a snapshot / demo of Collabora Office and try it out yourself right now:
<a href="https://www.collaboraoffice.com/collabora-office-latest-snapshot/">try unstable snapshot</a>.  Collabora
is a major contributor to LibreOffice and all of this work will be available in TDF&#8217;s next release
too (6.4).</p></div>
</div>
</div>

  </div>
</article>
<hr />
<article>
  <div class="article_title">
    <h1><a href="https://vmiklos.hu/blog/btlr-text-direction-in-writer-3.html">btLr text direction in Writer, part 3</a></h1>
  </div>
  <div class="article_meta">
    <p>Posted on: Fri 14 June 2019</p>
  </div>
  <div class="article_readtime">
    <p>Estimated read time: 2 minutes</p>
  </div>
  <div class="article_text">
    <div id="preamble">
<div class="sectionbody">
<div class="paragraph"><p>I already wrote about the btLr text direction in the context of Writer table cells as a result of a
<a href="https://www.collaboraoffice.com/">Collabora</a> hack week (<a href="https://vmiklos.hu/blog/hackweek-2019.html">part
1</a>, <a href="https://vmiklos.hu/blog/btlr-text-direction-in-writer-2.html">part 2</a>). The next step in this
journey is btLr text direction of Writer Text Frames, and building on top of that: DOCX Text Boxes.
Here is a series of screenshots showing the result:</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="https://lh3.googleusercontent.com/mHrS3KHuLf4tnWOZTw83jJiF3bJ6Ti8fiHXSJlqBFwrdDEpCdS9m_mTfHQPhOXNbZ5atXkagrGO7fSAJPSUo9pEm73UMr_kT6oVwOLCjZwxR9NB_EsLxHUXmUtUiSq0Zr-C0_TNLMg=w640" alt="https://lh3.googleusercontent.com/mHrS3KHuLf4tnWOZTw83jJiF3bJ6Ti8fiHXSJlqBFwrdDEpCdS9m_mTfHQPhOXNbZ5atXkagrGO7fSAJPSUo9pEm73UMr_kT6oVwOLCjZwxR9NB_EsLxHUXmUtUiSq0Zr-C0_TNLMg=w640" />
</div>
<div class="title">Figure 1. tdf104353.docx, baseline</div>
</div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="https://lh3.googleusercontent.com/haH8Tu0CiUQ9OHWn3Pc9PJ8pP6fEwpGZtrtYUrtkYLYH_BLnLknIA5hBruslE2XIJnuoFjGxYhuFj3GqH4Peu2slIH83ss9vIPMXSn_E5q2Lr80cz2_h7rPuI1DRgJYou6AaOQzAaw=w640" alt="https://lh3.googleusercontent.com/haH8Tu0CiUQ9OHWn3Pc9PJ8pP6fEwpGZtrtYUrtkYLYH_BLnLknIA5hBruslE2XIJnuoFjGxYhuFj3GqH4Peu2slIH83ss9vIPMXSn_E5q2Lr80cz2_h7rPuI1DRgJYou6AaOQzAaw=w640" />
</div>
<div class="title">Figure 2. tdf104353.docx, current</div>
</div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="https://lh3.googleusercontent.com/ZZKDSlC3-VmuVbvvR7nlsNUi6A-mWAj6wJgg2TMzBMg0MQ01kN0iwnHvw_16GDopYT2hNuJwUKWZ5ugbg6TjkJWJ_V5rHwv2fpwumuGLLF29hYYtEPOb0v2en5UHY5p8kHyxTWtYZA=w640" alt="https://lh3.googleusercontent.com/ZZKDSlC3-VmuVbvvR7nlsNUi6A-mWAj6wJgg2TMzBMg0MQ01kN0iwnHvw_16GDopYT2hNuJwUKWZ5ugbg6TjkJWJ_V5rHwv2fpwumuGLLF29hYYtEPOb0v2en5UHY5p8kHyxTWtYZA=w640" />
</div>
<div class="title">Figure 3. tdf104353.docx, reference</div>
</div>
<div class="paragraph"><p>You can see that the bug document is some kind of card you can print and fold in the middle: no
matter if you are in front of the card or you are behind it, you always see the name and details of
the person. Sure, you can do the same with a table with no borders, but using a Text Frame for this
purpose is a sane use-case.</p></div>
<div class="paragraph"><p>The text from the 3 paragraphs used to have the same horizontal position, and now it&#8217;s laid out the
same way as Word does it.</p></div>
<div class="paragraph"><p>Technically, this result is just the last commit in a series. I fixed the following problems since
the last blog post on this topic:</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
<a href="http://cgit.freedesktop.org/libreoffice/core/commit/?id=0013f21ecd918e0541f165c3526a58f42dd75481">tdf#124344 sw btlr writing mode, DOCX import: fix vertical alignment</a>
</p>
</li>
<li>
<p>
<a href="http://cgit.freedesktop.org/libreoffice/core/commit/?id=8072a926da2a02dfaf3fa848a2976634641a594f">tdf#124521 sw btlr writing mode render: fix paint rectangle on scroll</a>
</p>
</li>
<li>
<p>
<a href="http://cgit.freedesktop.org/libreoffice/core/commit/?id=ff17478e069cc82681df62514876c06365dd5cd6">sw btlr writing mode: implement DOCX shape import for tbrl</a>
</p>
</li>
<li>
<p>
<a href="http://cgit.freedesktop.org/libreoffice/core/commit/?id=cd2a7acd789297e613424a59b2fe24cedd9a72b6">sw btlr writing mode: implement ODF filter for textframes</a>
</p>
</li>
<li>
<p>
<a href="http://cgit.freedesktop.org/libreoffice/core/commit/?id=8a26e4b26f0153fb8ca5da880ee4aa44748ee4df">sw btlr writing mode: implement layout for fly frames</a>
</p>
</li>
<li>
<p>
<a href="http://cgit.freedesktop.org/libreoffice/core/commit/?id=52e47276694575f119192f6ddafa69ec7a7eb6b4">sw btlr writing mode: implement UI for fly frames</a>
</p>
</li>
<li>
<p>
<a href="http://cgit.freedesktop.org/libreoffice/core/commit/?id=ad96f6f378a9fce11c2f7d9ad39a8203189444e3">sw btlr writing mode: fix btlr &lt;-&gt; tbrl switch for fly frames</a>
</p>
</li>
<li>
<p>
<a href="http://cgit.freedesktop.org/libreoffice/core/commit/?id=9c945cdbe170104cbacafa2c37babec5210b9ca2">sw btlr writing mode: DOCX drawingML import for fly frames</a>
</p>
</li>
</ol></div>
<div class="paragraph"><p>All this is available in LibreOffice master (towards 6.4), so you can try it out right now, if
interested.</p></div>
</div>
</div>

  </div>
</article>

<footer>
<div id="paginator">
<a href="https://vmiklos.hu/blog/tag/en9.html" class="button_accent">&larr; Older Posts</a>

<a href="https://vmiklos.hu/blog/tag/en7.html" class="button_accent">Newer Posts &rarr;</a>
</div>
</footer>

    <div id="ending_message">
      <p>&copy; Miklos Vajna. Built using <a href="http://getpelican.com" target="_blank">Pelican</a>. Theme by Giulio Fidente on <a href="https://github.com/gfidente/pelican-svbhack" target="_blank">github</a>. </p>
    </div>
  </main>
</body>
</html>